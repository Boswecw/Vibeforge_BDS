{"version":3,"file":"BarChart.js","sources":["../../../../src/lib/components/charts/BarChart.svelte"],"sourcesContent":["<script lang=\"ts\">\n\timport { onMount, onDestroy } from 'svelte';\n\timport {\n\t\tChart,\n\t\tBarController,\n\t\tBarElement,\n\t\tLinearScale,\n\t\tCategoryScale,\n\t\tTitle,\n\t\tTooltip,\n\t\tLegend\n\t} from 'chart.js';\n\n\t// Register Chart.js components\n\tChart.register(BarController, BarElement, LinearScale, CategoryScale, Title, Tooltip, Legend);\n\n\tinterface Props {\n\t\tlabels: string[];\n\t\tdatasets: {\n\t\t\tlabel: string;\n\t\t\tdata: number[];\n\t\t\tbackgroundColor?: string | string[];\n\t\t\tborderColor?: string | string[];\n\t\t\tborderWidth?: number;\n\t\t}[];\n\t\ttitle?: string;\n\t\theight?: number;\n\t\thorizontal?: boolean;\n\t}\n\n\tlet { labels, datasets, title, height = 300, horizontal = false }: Props = $props();\n\n\tlet canvasRef: HTMLCanvasElement;\n\tlet chart: Chart | null = $state(null);\n\n\tonMount(() => {\n\t\tif (canvasRef) {\n\t\t\tconst ctx = canvasRef.getContext('2d');\n\t\t\tif (ctx) {\n\t\t\t\tchart = new Chart(ctx, {\n\t\t\t\t\ttype: 'bar',\n\t\t\t\t\tdata: {\n\t\t\t\t\t\tlabels,\n\t\t\t\t\t\tdatasets: datasets.map((ds) => ({\n\t\t\t\t\t\t\t...ds,\n\t\t\t\t\t\t\tbackgroundColor:\n\t\t\t\t\t\t\t\tds.backgroundColor ??\n\t\t\t\t\t\t\t\t(Array.isArray(labels)\n\t\t\t\t\t\t\t\t\t? labels.map(() => 'rgba(197, 167, 123, 0.7)')\n\t\t\t\t\t\t\t\t\t: 'rgba(197, 167, 123, 0.7)'),\n\t\t\t\t\t\t\tborderColor:\n\t\t\t\t\t\t\t\tds.borderColor ??\n\t\t\t\t\t\t\t\t(Array.isArray(labels)\n\t\t\t\t\t\t\t\t\t? labels.map(() => 'rgb(197, 167, 123)')\n\t\t\t\t\t\t\t\t\t: 'rgb(197, 167, 123)'),\n\t\t\t\t\t\t\tborderWidth: ds.borderWidth ?? 1\n\t\t\t\t\t\t}))\n\t\t\t\t\t},\n\t\t\t\t\toptions: {\n\t\t\t\t\t\tresponsive: true,\n\t\t\t\t\t\tmaintainAspectRatio: false,\n\t\t\t\t\t\tindexAxis: horizontal ? 'y' : 'x',\n\t\t\t\t\t\tplugins: {\n\t\t\t\t\t\t\tlegend: {\n\t\t\t\t\t\t\t\tdisplay: datasets.length > 1,\n\t\t\t\t\t\t\t\tposition: 'top',\n\t\t\t\t\t\t\t\tlabels: {\n\t\t\t\t\t\t\t\t\tcolor: 'rgb(225, 219, 210)',\n\t\t\t\t\t\t\t\t\tfont: {\n\t\t\t\t\t\t\t\t\t\tfamily: \"'Geist', sans-serif\"\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttitle: {\n\t\t\t\t\t\t\t\tdisplay: !!title,\n\t\t\t\t\t\t\t\ttext: title,\n\t\t\t\t\t\t\t\tcolor: 'rgb(225, 219, 210)',\n\t\t\t\t\t\t\t\tfont: {\n\t\t\t\t\t\t\t\t\tfamily: \"'Geist', sans-serif\",\n\t\t\t\t\t\t\t\t\tsize: 16\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttooltip: {\n\t\t\t\t\t\t\t\tbackgroundColor: 'rgba(30, 28, 26, 0.95)',\n\t\t\t\t\t\t\t\ttitleColor: 'rgb(225, 219, 210)',\n\t\t\t\t\t\t\t\tbodyColor: 'rgb(225, 219, 210)',\n\t\t\t\t\t\t\t\tborderColor: 'rgb(197, 167, 123)',\n\t\t\t\t\t\t\t\tborderWidth: 1,\n\t\t\t\t\t\t\t\tpadding: 12,\n\t\t\t\t\t\t\t\tdisplayColors: true,\n\t\t\t\t\t\t\t\tcallbacks: {\n\t\t\t\t\t\t\t\t\tlabel: function (context) {\n\t\t\t\t\t\t\t\t\t\tlet label = context.dataset.label || '';\n\t\t\t\t\t\t\t\t\t\tif (label) {\n\t\t\t\t\t\t\t\t\t\t\tlabel += ': ';\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tif (context.parsed.y !== null && !horizontal) {\n\t\t\t\t\t\t\t\t\t\t\t// Vertical bar\n\t\t\t\t\t\t\t\t\t\t\tconst value = context.parsed.y;\n\t\t\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\t\t\tlabel.toLowerCase().includes('cost') ||\n\t\t\t\t\t\t\t\t\t\t\t\tlabel.toLowerCase().includes('$')\n\t\t\t\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\t\t\t\tlabel += '$' + value.toFixed(4);\n\t\t\t\t\t\t\t\t\t\t\t} else if (label.toLowerCase().includes('rate')) {\n\t\t\t\t\t\t\t\t\t\t\t\tlabel += value.toFixed(2) + '%';\n\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\tlabel += value.toLocaleString();\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t} else if (context.parsed.x !== null && horizontal) {\n\t\t\t\t\t\t\t\t\t\t\t// Horizontal bar\n\t\t\t\t\t\t\t\t\t\t\tconst value = context.parsed.x;\n\t\t\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\t\t\tlabel.toLowerCase().includes('cost') ||\n\t\t\t\t\t\t\t\t\t\t\t\tlabel.toLowerCase().includes('$')\n\t\t\t\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\t\t\t\tlabel += '$' + value.toFixed(4);\n\t\t\t\t\t\t\t\t\t\t\t} else if (label.toLowerCase().includes('rate')) {\n\t\t\t\t\t\t\t\t\t\t\t\tlabel += value.toFixed(2) + '%';\n\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\tlabel += value.toLocaleString();\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\treturn label;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tscales: {\n\t\t\t\t\t\t\tx: {\n\t\t\t\t\t\t\t\tgrid: {\n\t\t\t\t\t\t\t\t\tcolor: 'rgba(197, 167, 123, 0.1)'\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tticks: {\n\t\t\t\t\t\t\t\t\tcolor: 'rgb(154, 147, 140)',\n\t\t\t\t\t\t\t\t\tfont: {\n\t\t\t\t\t\t\t\t\t\tfamily: \"'Geist Mono', monospace\"\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tbeginAtZero: true\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ty: {\n\t\t\t\t\t\t\t\tgrid: {\n\t\t\t\t\t\t\t\t\tcolor: 'rgba(197, 167, 123, 0.1)'\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tticks: {\n\t\t\t\t\t\t\t\t\tcolor: 'rgb(154, 147, 140)',\n\t\t\t\t\t\t\t\t\tfont: {\n\t\t\t\t\t\t\t\t\t\tfamily: \"'Geist Mono', monospace\"\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tbeginAtZero: true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t});\n\n\t// Update chart when data changes\n\t$effect(() => {\n\t\tif (chart) {\n\t\t\tchart.data.labels = labels;\n\t\t\tchart.data.datasets = datasets.map((ds) => ({\n\t\t\t\t...ds,\n\t\t\t\tbackgroundColor:\n\t\t\t\t\tds.backgroundColor ??\n\t\t\t\t\t(Array.isArray(labels)\n\t\t\t\t\t\t? labels.map(() => 'rgba(197, 167, 123, 0.7)')\n\t\t\t\t\t\t: 'rgba(197, 167, 123, 0.7)'),\n\t\t\t\tborderColor:\n\t\t\t\t\tds.borderColor ??\n\t\t\t\t\t(Array.isArray(labels)\n\t\t\t\t\t\t? labels.map(() => 'rgb(197, 167, 123)')\n\t\t\t\t\t\t: 'rgb(197, 167, 123)'),\n\t\t\t\tborderWidth: ds.borderWidth ?? 1\n\t\t\t}));\n\t\t\tchart.update();\n\t\t}\n\t});\n\n\tonDestroy(() => {\n\t\tif (chart) {\n\t\t\tchart.destroy();\n\t\t}\n\t});\n</script>\n\n<div class=\"chart-container\" style=\"height: {height}px;\">\n\t<canvas bind:this={canvasRef}></canvas>\n</div>\n\n<style>\n\t.chart-container {\n\t\tposition: relative;\n\t\twidth: 100%;\n\t}\n</style>\n"],"names":["Chart","register","BarController","BarElement","LinearScale","CategoryScale","Title","Tooltip","Legend","height","$$props","onDestroy"],"mappings":"0NAcCA,EAAMC,SAASC,EAAeC,EAAYC,EAAaC,EAAeC,EAAOC,EAASC,cAgBvDC,EAAS,KAAuBC,EAwJ/DC,EAAS,4EAOmCF"}