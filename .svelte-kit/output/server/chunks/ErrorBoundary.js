import{p as r,i as s,f as e}from"./vendor-svelte.js";import{l as i,c as o}from"./errors.js";import{P as a}from"./Panel.js";import{A as t}from"./Alert.js";import{B as l}from"./Button.js";const d={errors:[],lastError:null,dismissedErrors:new Set},c={get errors(){return d.errors.filter(r=>!d.dismissedErrors.has(r.id))},get lastError(){return d.lastError},get hasErrors(){return d.errors.length>0},get criticalErrors(){return d.errors.filter(r=>"CRITICAL"===r.severity&&!d.dismissedErrors.has(r.id))},get highErrors(){return d.errors.filter(r=>"HIGH"===r.severity&&!d.dismissedErrors.has(r.id))},addError(r){d.errors=[...d.errors,r],d.lastError=r,i(r),"LOW"===r.severity&&setTimeout(()=>{this.dismissError(r.id)},5e3),d.errors.length>100&&(d.errors=d.errors.slice(-100))},dismissError(r){d.dismissedErrors.add(r)},clearError(r){d.errors=d.errors.filter(s=>s.id!==r),d.dismissedErrors.delete(r),d.lastError?.id===r&&(d.lastError=d.errors[d.errors.length-1]||null)},clearAll(){d.errors=[],d.lastError=null,d.dismissedErrors.clear()},clearDismissed(){d.errors=d.errors.filter(r=>!d.dismissedErrors.has(r.id)),d.dismissedErrors.clear()}};function n(i,d){i.component(i=>{let{fallback:n,onError:u,showDetails:h=!1,children:x}=d,p=null,m="",E=null!==p;r(()=>{}),E&&p?(i.push("\x3c!--[--\x3e"),n?(i.push("\x3c!--[--\x3e"),n(i,p),i.push("\x3c!----\x3e")):(i.push("\x3c!--[!--\x3e"),i.push('<div class="error-boundary svelte-1k3aqik">'),a(i,{variant:"elevated",padding:"lg",children:r=>{r.push('<div class="error-container svelte-1k3aqik"><div class="error-icon svelte-1k3aqik">⚠️</div> <h2 class="svelte-1k3aqik">Something went wrong</h2> '),t(r,{variant:"error",title:p.category,children:r=>{r.push(`\x3c!----\x3e${e(p.userMessage)}`)},$$slots:{default:!0}}),r.push("\x3c!----\x3e "),h&&m?(r.push("\x3c!--[--\x3e"),r.push(`<details class="error-details svelte-1k3aqik"><summary class="svelte-1k3aqik">Technical Details</summary> <pre class="error-stack svelte-1k3aqik">${e(m)}</pre></details>`)):r.push("\x3c!--[!--\x3e"),r.push('\x3c!--]--\x3e <div class="error-actions svelte-1k3aqik">'),l(r,{variant:"primary",children:r=>{r.push("\x3c!----\x3eTry Again")},$$slots:{default:!0}}),r.push("\x3c!----\x3e "),l(r,{variant:"secondary",children:r=>{r.push("\x3c!----\x3eReload Page")},$$slots:{default:!0}}),r.push(`\x3c!----\x3e</div> <p class="error-id svelte-1k3aqik">Error ID: ${e(p.id)}</p></div>`)},$$slots:{default:!0}}),i.push("\x3c!----\x3e</div>")),i.push("\x3c!--]--\x3e")):(i.push("\x3c!--[!--\x3e"),x?(i.push("\x3c!--[--\x3e"),x(i),i.push("\x3c!----\x3e")):i.push("\x3c!--[!--\x3e"),i.push("\x3c!--]--\x3e")),i.push("\x3c!--]--\x3e"),s(d,{catchError:function(r){!function(r,s=""){p=r,m=s,c.addError(r),u&&u(r)}(o(r),r instanceof Error&&r.stack||"")}})})}export{n as E,c as e};
