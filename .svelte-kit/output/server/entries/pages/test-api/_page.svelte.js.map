{"version":3,"file":"_page.svelte.js","sources":["../../../../../../src/lib/api/auth.ts","../../../../../../src/lib/utils/cache.ts","../../../../../../src/lib/api/forgeAgentsClient.ts","../../../../../../src/lib/api/skillRegistry.ts","../../../../../../src/routes/test-api/+page.svelte"],"sourcesContent":["const STORAGE_KEY = 'forge_auth_tokens';\n\n// Check if we're running in Tauri (desktop) or browser\nfunction isTauriEnvironment(): boolean {\n\treturn typeof window !== 'undefined' && '__TAURI__' in window;\n}\n\n// Lazy load Tauri invoke function\nasync function getTauriInvoke() {\n\tif (isTauriEnvironment()) {\n\t\ttry {\n\t\t\tconst tauriCore = await import('@tauri-apps/api/core');\n\t\t\treturn tauriCore.invoke;\n\t\t} catch {\n\t\t\treturn null;\n\t\t}\n\t}\n\treturn null;\n}\n\nexport class TokenManager {\n\tprivate accessToken: string | null = null;\n\tprivate refreshToken: string | null = null;\n\tprivate expiresAt: number | null = null;\n\n\tconstructor() {\n\t\t// Auto-initialize on construction\n\t\tthis.initialize().catch((err) => console.warn('TokenManager init failed:', err));\n\t}\n\n\tasync initialize(): Promise<void> {\n\t\ttry {\n\t\t\t// Only run in browser environment\n\t\t\tif (typeof window === 'undefined') return;\n\n\t\t\tconst invoke = await getTauriInvoke();\n\t\t\tif (invoke) {\n\t\t\t\t// Tauri desktop app - use secure storage\n\t\t\t\tconst stored = await invoke<{\n\t\t\t\t\taccessToken: string;\n\t\t\t\t\trefreshToken: string;\n\t\t\t\t\texpiresAt: string;\n\t\t\t\t} | null>('load_tokens');\n\t\t\t\tif (stored) {\n\t\t\t\t\tthis.accessToken = stored.accessToken;\n\t\t\t\t\tthis.refreshToken = stored.refreshToken;\n\t\t\t\t\tthis.expiresAt = new Date(stored.expiresAt).getTime();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Browser - use localStorage\n\t\t\t\tconst stored = localStorage.getItem(STORAGE_KEY);\n\t\t\t\tif (stored) {\n\t\t\t\t\tconst data = JSON.parse(stored);\n\t\t\t\t\tthis.accessToken = data.accessToken;\n\t\t\t\t\tthis.refreshToken = data.refreshToken;\n\t\t\t\t\tthis.expiresAt = new Date(data.expiresAt).getTime();\n\t\t\t\t}\n\t\t\t}\n\t\t} catch (err) {\n\t\t\tconsole.warn('Token load failed:', err);\n\t\t}\n\t}\n\n\tasync setTokens(\n\t\taccessToken: string,\n\t\trefreshToken: string,\n\t\texpiresAt: string\n\t): Promise<void> {\n\t\tthis.accessToken = accessToken;\n\t\tthis.refreshToken = refreshToken;\n\t\tthis.expiresAt = new Date(expiresAt).getTime();\n\n\t\t// Only persist in browser environment\n\t\tif (typeof window === 'undefined') return;\n\n\t\ttry {\n\t\t\tconst invoke = await getTauriInvoke();\n\t\t\tif (invoke) {\n\t\t\t\t// Tauri desktop app - use secure storage\n\t\t\t\tawait invoke('save_tokens', { accessToken, refreshToken, expiresAt });\n\t\t\t} else {\n\t\t\t\t// Browser - use localStorage\n\t\t\t\tlocalStorage.setItem(\n\t\t\t\t\tSTORAGE_KEY,\n\t\t\t\t\tJSON.stringify({ accessToken, refreshToken, expiresAt })\n\t\t\t\t);\n\t\t\t}\n\t\t} catch (err) {\n\t\t\tconsole.error('Token save failed:', err);\n\t\t\tthrow err;\n\t\t}\n\t}\n\n\tasync clearTokens(): Promise<void> {\n\t\tthis.accessToken = null;\n\t\tthis.refreshToken = null;\n\t\tthis.expiresAt = null;\n\n\t\t// Only persist in browser environment\n\t\tif (typeof window === 'undefined') return;\n\n\t\ttry {\n\t\t\tconst invoke = await getTauriInvoke();\n\t\t\tif (invoke) {\n\t\t\t\t// Tauri desktop app\n\t\t\t\tawait invoke('clear_tokens');\n\t\t\t} else {\n\t\t\t\t// Browser\n\t\t\t\tlocalStorage.removeItem(STORAGE_KEY);\n\t\t\t}\n\t\t} catch (err) {\n\t\t\tconsole.warn('Token clear failed:', err);\n\t\t}\n\t}\n\n\tgetAccessToken(): string | null {\n\t\tif (this.expiresAt && Date.now() >= this.expiresAt - 60000) return null;\n\t\treturn this.accessToken;\n\t}\n\n\tgetRefreshToken(): string | null {\n\t\treturn this.refreshToken;\n\t}\n\n\tisAuthenticated(): boolean {\n\t\treturn !!this.getAccessToken();\n\t}\n\n\tisExpiringSoon(): boolean {\n\t\tif (!this.expiresAt) return true;\n\t\treturn Date.now() >= this.expiresAt - 300000;\n\t}\n}\n\nexport const tokenManager = new TokenManager();\n","/**\n * LRU Cache Implementation\n *\n * Least Recently Used (LRU) cache for in-memory caching of API responses.\n * Automatically evicts least recently used entries when max size is reached.\n *\n * Features:\n * - Generic type support for any cached value\n * - TTL (time-to-live) per entry\n * - Automatic eviction of expired entries\n * - Size-based eviction (LRU algorithm)\n * - Cache statistics (hits, misses, size)\n *\n * Usage:\n * ```typescript\n * const cache = new LRUCache<User>({ maxSize: 100, ttl: 5 * 60 * 1000 });\n * cache.set('user:123', userData);\n * const user = cache.get('user:123'); // Returns userData or null if expired/missing\n * ```\n */\n\nexport interface CacheEntry<T> {\n\tvalue: T;\n\texpiresAt: number;\n}\n\nexport interface CacheOptions {\n\tmaxSize?: number; // Maximum number of entries (default: 100)\n\tttl?: number; // Time to live in milliseconds (default: 5 minutes)\n}\n\nexport interface CacheStats {\n\thits: number;\n\tmisses: number;\n\tsize: number;\n\tmaxSize: number;\n}\n\nexport class LRUCache<T> {\n\tprivate cache: Map<string, CacheEntry<T>>;\n\tprivate maxSize: number;\n\tprivate ttl: number;\n\tprivate hits: number = 0;\n\tprivate misses: number = 0;\n\n\tconstructor(options: CacheOptions = {}) {\n\t\tthis.cache = new Map();\n\t\tthis.maxSize = options.maxSize ?? 100;\n\t\tthis.ttl = options.ttl ?? 5 * 60 * 1000; // Default 5 minutes\n\t}\n\n\t/**\n\t * Get a value from the cache\n\t * Returns null if key doesn't exist or entry has expired\n\t */\n\tget(key: string): T | null {\n\t\tconst entry = this.cache.get(key);\n\n\t\tif (!entry) {\n\t\t\tthis.misses++;\n\t\t\treturn null;\n\t\t}\n\n\t\t// Check if expired\n\t\tif (Date.now() > entry.expiresAt) {\n\t\t\tthis.cache.delete(key);\n\t\t\tthis.misses++;\n\t\t\treturn null;\n\t\t}\n\n\t\t// Move to end (most recently used)\n\t\tthis.cache.delete(key);\n\t\tthis.cache.set(key, entry);\n\n\t\tthis.hits++;\n\t\treturn entry.value;\n\t}\n\n\t/**\n\t * Set a value in the cache\n\t * If cache is full, removes the least recently used entry\n\t */\n\tset(key: string, value: T, customTtl?: number): void {\n\t\t// If key already exists, delete it first to update position\n\t\tif (this.cache.has(key)) {\n\t\t\tthis.cache.delete(key);\n\t\t}\n\n\t\t// Evict LRU entry if at max size\n\t\tif (this.cache.size >= this.maxSize) {\n\t\t\tconst firstKey = this.cache.keys().next().value;\n\t\t\tif (firstKey !== undefined) {\n\t\t\t\tthis.cache.delete(firstKey);\n\t\t\t}\n\t\t}\n\n\t\t// Add new entry\n\t\tconst ttl = customTtl ?? this.ttl;\n\t\tconst entry: CacheEntry<T> = {\n\t\t\tvalue,\n\t\t\texpiresAt: Date.now() + ttl\n\t\t};\n\n\t\tthis.cache.set(key, entry);\n\t}\n\n\t/**\n\t * Check if a key exists and is not expired\n\t */\n\thas(key: string): boolean {\n\t\tconst entry = this.cache.get(key);\n\t\tif (!entry) return false;\n\n\t\tif (Date.now() > entry.expiresAt) {\n\t\t\tthis.cache.delete(key);\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\t/**\n\t * Delete a specific key from the cache\n\t */\n\tdelete(key: string): boolean {\n\t\treturn this.cache.delete(key);\n\t}\n\n\t/**\n\t * Clear all entries from the cache\n\t */\n\tclear(): void {\n\t\tthis.cache.clear();\n\t\tthis.hits = 0;\n\t\tthis.misses = 0;\n\t}\n\n\t/**\n\t * Remove all expired entries\n\t */\n\tprune(): number {\n\t\tconst now = Date.now();\n\t\tlet pruned = 0;\n\n\t\tfor (const [key, entry] of this.cache.entries()) {\n\t\t\tif (now > entry.expiresAt) {\n\t\t\t\tthis.cache.delete(key);\n\t\t\t\tpruned++;\n\t\t\t}\n\t\t}\n\n\t\treturn pruned;\n\t}\n\n\t/**\n\t * Get cache statistics\n\t */\n\tgetStats(): CacheStats {\n\t\treturn {\n\t\t\thits: this.hits,\n\t\t\tmisses: this.misses,\n\t\t\tsize: this.cache.size,\n\t\t\tmaxSize: this.maxSize\n\t\t};\n\t}\n\n\t/**\n\t * Get hit rate percentage\n\t */\n\tgetHitRate(): number {\n\t\tconst total = this.hits + this.misses;\n\t\treturn total === 0 ? 0 : (this.hits / total) * 100;\n\t}\n\n\t/**\n\t * Get all keys in the cache (for debugging)\n\t */\n\tkeys(): string[] {\n\t\treturn Array.from(this.cache.keys());\n\t}\n\n\t/**\n\t * Get cache size\n\t */\n\tsize(): number {\n\t\treturn this.cache.size;\n\t}\n}\n\n/**\n * Cache key generator utility\n * Generates consistent cache keys from request parameters\n */\nexport function generateCacheKey(\n\tendpoint: string,\n\tparams?: Record<string, any>,\n\tuserId?: string\n): string {\n\tconst parts = [endpoint];\n\n\tif (userId) {\n\t\tparts.push(`user:${userId}`);\n\t}\n\n\tif (params) {\n\t\tconst sortedParams = Object.keys(params)\n\t\t\t.sort()\n\t\t\t.map((key) => `${key}=${JSON.stringify(params[key])}`)\n\t\t\t.join('&');\n\t\tparts.push(sortedParams);\n\t}\n\n\treturn parts.join('|');\n}\n\n/**\n * Stale-While-Revalidate Cache Wrapper\n *\n * Returns cached data immediately (if available) while fetching fresh data in the background.\n * Updates cache with fresh data when available.\n *\n * Usage:\n * ```typescript\n * const data = await staleWhileRevalidate(\n *   'skills-list',\n *   () => fetchSkills(),\n *   cache\n * );\n * ```\n */\nexport async function staleWhileRevalidate<T>(\n\tkey: string,\n\tfetchFn: () => Promise<T>,\n\tcache: LRUCache<T>,\n\tonRevalidate?: (data: T) => void\n): Promise<T> {\n\t// Try to get cached value\n\tconst cached = cache.get(key);\n\n\tif (cached !== null) {\n\t\t// Return cached value immediately\n\t\t// Revalidate in background\n\t\tfetchFn()\n\t\t\t.then((fresh) => {\n\t\t\t\tcache.set(key, fresh);\n\t\t\t\tif (onRevalidate) {\n\t\t\t\t\tonRevalidate(fresh);\n\t\t\t\t}\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\tconsole.warn(`Failed to revalidate cache for key: ${key}`, error);\n\t\t\t});\n\n\t\treturn cached;\n\t}\n\n\t// No cached value, fetch fresh data\n\tconst fresh = await fetchFn();\n\tcache.set(key, fresh);\n\treturn fresh;\n}\n\n/**\n * Cache invalidation utilities\n */\nexport class CacheInvalidator {\n\tprivate cache: LRUCache<any>;\n\n\tconstructor(cache: LRUCache<any>) {\n\t\tthis.cache = cache;\n\t}\n\n\t/**\n\t * Invalidate all keys matching a pattern (glob-style)\n\t * Example: invalidatePattern('skills/*') invalidates all skill-related cache entries\n\t */\n\tinvalidatePattern(pattern: string): number {\n\t\tconst regex = new RegExp('^' + pattern.replace('*', '.*') + '$');\n\t\tlet invalidated = 0;\n\n\t\tfor (const key of this.cache.keys()) {\n\t\t\tif (regex.test(key)) {\n\t\t\t\tthis.cache.delete(key);\n\t\t\t\tinvalidated++;\n\t\t\t}\n\t\t}\n\n\t\treturn invalidated;\n\t}\n\n\t/**\n\t * Invalidate all keys containing a substring\n\t */\n\tinvalidateContaining(substring: string): number {\n\t\tlet invalidated = 0;\n\n\t\tfor (const key of this.cache.keys()) {\n\t\t\tif (key.includes(substring)) {\n\t\t\t\tthis.cache.delete(key);\n\t\t\t\tinvalidated++;\n\t\t\t}\n\t\t}\n\n\t\treturn invalidated;\n\t}\n\n\t/**\n\t * Invalidate all cache entries\n\t */\n\tinvalidateAll(): void {\n\t\tthis.cache.clear();\n\t}\n}\n\n/**\n * Global cache instance for API responses\n * Can be imported and used across the application\n */\nexport const apiCache = new LRUCache<any>({\n\tmaxSize: 100,\n\tttl: 5 * 60 * 1000 // 5 minutes\n});\n\n/**\n * Cache for skills list (longer TTL)\n */\nexport const skillsCache = new LRUCache<any>({\n\tmaxSize: 50,\n\tttl: 10 * 60 * 1000 // 10 minutes\n});\n\n/**\n * Cache for user-specific data (shorter TTL)\n */\nexport const userCache = new LRUCache<any>({\n\tmaxSize: 50,\n\tttl: 2 * 60 * 1000 // 2 minutes\n});\n","import { tokenManager } from './auth';\nimport {\n\tclassifyError,\n\tcreateAuthenticationError,\n\tcreateNetworkError,\n\tshouldRetry,\n\tgetRetryDelay,\n\ttype AppError\n} from '$lib/utils/errors';\nimport {\n\tskillsCache,\n\tuserCache,\n\tgenerateCacheKey,\n\tstaleWhileRevalidate\n} from '$lib/utils/cache';\nimport type {\n\tAuthResponse,\n\tListSkillsResponse,\n\tSkillInvocationRequest,\n\tSkillInvocationResponse\n} from './types';\n\nexport class ForgeAgentsClient {\n\tprivate baseUrl: string;\n\tprivate refreshPromise: Promise<void> | null = null;\n\tprivate maxRetries: number = 3;\n\tprivate timeout: number = 30000; // 30 seconds\n\n\tconstructor(baseUrl: string = 'http://localhost:8787') {\n\t\tthis.baseUrl = baseUrl;\n\t}\n\n\t/**\n\t * Retry wrapper for fetch operations\n\t */\n\tprivate async retryFetch<T>(\n\t\toperation: () => Promise<T>,\n\t\tcontext: string\n\t): Promise<T> {\n\t\tlet lastError: AppError | null = null;\n\n\t\tfor (let attempt = 0; attempt < this.maxRetries; attempt++) {\n\t\t\ttry {\n\t\t\t\treturn await operation();\n\t\t\t} catch (error) {\n\t\t\t\tconst appError = classifyError(error);\n\t\t\t\tlastError = appError;\n\n\t\t\t\t// Check if we should retry\n\t\t\t\tif (!shouldRetry(appError, attempt, this.maxRetries)) {\n\t\t\t\t\tthrow appError;\n\t\t\t\t}\n\n\t\t\t\t// Wait before retrying\n\t\t\t\tconst delay = getRetryDelay(appError, attempt);\n\t\t\t\tawait new Promise(resolve => setTimeout(resolve, delay));\n\t\t\t}\n\t\t}\n\n\t\t// All retries exhausted\n\t\tthrow lastError || createNetworkError(`${context} failed after ${this.maxRetries} attempts`);\n\t}\n\n\t/**\n\t * Fetch with timeout support\n\t */\n\tprivate async fetchWithTimeout(\n\t\turl: string,\n\t\toptions: RequestInit = {}\n\t): Promise<Response> {\n\t\tconst controller = new AbortController();\n\t\tconst timeoutId = setTimeout(() => controller.abort(), this.timeout);\n\n\t\t// Log request\n\t\tconsole.log('[ForgeAgents API] Request:', {\n\t\t\tmethod: options.method || 'GET',\n\t\t\turl,\n\t\t\theaders: options.headers,\n\t\t\thasBody: !!options.body\n\t\t});\n\n\t\ttry {\n\t\t\tconst startTime = Date.now();\n\t\t\tconst response = await fetch(url, {\n\t\t\t\t...options,\n\t\t\t\tsignal: controller.signal\n\t\t\t});\n\n\t\t\tconst duration = Date.now() - startTime;\n\n\t\t\t// Log response\n\t\t\tconsole.log('[ForgeAgents API] Response:', {\n\t\t\t\tmethod: options.method || 'GET',\n\t\t\t\turl,\n\t\t\t\tstatus: response.status,\n\t\t\t\tstatusText: response.statusText,\n\t\t\t\tduration: `${duration}ms`,\n\t\t\t\tok: response.ok\n\t\t\t});\n\n\t\t\treturn response;\n\t\t} catch (error: any) {\n\t\t\tconsole.error('[ForgeAgents API] Error:', {\n\t\t\t\tmethod: options.method || 'GET',\n\t\t\t\turl,\n\t\t\t\terror: error.message || error\n\t\t\t});\n\n\t\t\tif (error.name === 'AbortError') {\n\t\t\t\tthrow createNetworkError('Request timeout', `Request to ${url} timed out after ${this.timeout}ms`);\n\t\t\t}\n\t\t\tthrow error;\n\t\t} finally {\n\t\t\tclearTimeout(timeoutId);\n\t\t}\n\t}\n\n\tasync login(email: string, password: string): Promise<AuthResponse> {\n\t\treturn this.retryFetch(async () => {\n\t\t\ttry {\n\t\t\t\tconst response = await this.fetchWithTimeout(`${this.baseUrl}/api/v1/auth/login`, {\n\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\theaders: { 'Content-Type': 'application/json' },\n\t\t\t\t\tbody: JSON.stringify({ email, password })\n\t\t\t\t});\n\n\t\t\t\tif (!response.ok) {\n\t\t\t\t\tconst appError = classifyError(response);\n\t\t\t\t\tawait tokenManager.clearTokens();\n\t\t\t\t\tthrow appError;\n\t\t\t\t}\n\n\t\t\t\tconst data = await response.json();\n\t\t\t\tawait tokenManager.setTokens(data.access_token, data.refresh_token, data.expires_at);\n\t\t\t\treturn data;\n\t\t\t} catch (err) {\n\t\t\t\tawait tokenManager.clearTokens();\n\t\t\t\tthrow classifyError(err);\n\t\t\t}\n\t\t}, 'Login');\n\t}\n\n\tasync logout(): Promise<void> {\n\t\ttry {\n\t\t\tconst token = tokenManager.getAccessToken();\n\t\t\tif (token) {\n\t\t\t\tawait fetch(`${this.baseUrl}/api/v1/auth/logout`, {\n\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\theaders: this.getAuthHeaders()\n\t\t\t\t});\n\t\t\t}\n\t\t} catch (err) {\n\t\t\tconsole.warn('Logout failed:', err);\n\t\t} finally {\n\t\t\tawait tokenManager.clearTokens();\n\t\t}\n\t}\n\n\tasync refreshAccessToken(): Promise<void> {\n\t\tif (this.refreshPromise) return this.refreshPromise;\n\t\tthis.refreshPromise = this._performRefresh();\n\t\ttry {\n\t\t\tawait this.refreshPromise;\n\t\t} finally {\n\t\t\tthis.refreshPromise = null;\n\t\t}\n\t}\n\n\tprivate async _performRefresh(): Promise<void> {\n\t\tconst refreshToken = tokenManager.getRefreshToken();\n\t\tif (!refreshToken) throw new Error('No refresh token available');\n\t\ttry {\n\t\t\tconst response = await fetch(`${this.baseUrl}/api/v1/auth/refresh`, {\n\t\t\t\tmethod: 'POST',\n\t\t\t\theaders: { 'Content-Type': 'application/json' },\n\t\t\t\tbody: JSON.stringify({ refresh_token: refreshToken })\n\t\t\t});\n\t\t\tif (!response.ok) {\n\t\t\t\tawait tokenManager.clearTokens();\n\t\t\t\tthrow new Error('Token refresh failed');\n\t\t\t}\n\t\t\tconst data = await response.json();\n\t\t\tawait tokenManager.setTokens(data.access_token, data.refresh_token, data.expires_at);\n\t\t} catch (err) {\n\t\t\tawait tokenManager.clearTokens();\n\t\t\tthrow err;\n\t\t}\n\t}\n\n\tasync listSkills(options?: { skipCache?: boolean }): Promise<ListSkillsResponse> {\n\t\tconst cacheKey = generateCacheKey('/api/v1/bds/skills');\n\n\t\t// Skip cache if requested\n\t\tif (options?.skipCache) {\n\t\t\tconst response = await this.authenticatedFetch<ListSkillsResponse>('/api/v1/bds/skills');\n\t\t\tskillsCache.set(cacheKey, response);\n\t\t\treturn response;\n\t\t}\n\n\t\t// Use stale-while-revalidate strategy\n\t\treturn staleWhileRevalidate(\n\t\t\tcacheKey,\n\t\t\t() => this.authenticatedFetch<ListSkillsResponse>('/api/v1/bds/skills'),\n\t\t\tskillsCache\n\t\t);\n\t}\n\n\tasync getSkill(skillId: string, options?: { skipCache?: boolean }): Promise<any> {\n\t\tconst cacheKey = generateCacheKey(`/api/v1/bds/skills/${skillId}`);\n\n\t\t// Skip cache if requested\n\t\tif (options?.skipCache) {\n\t\t\tconst response = await this.authenticatedFetch<any>(`/api/v1/bds/skills/${skillId}`);\n\t\t\tskillsCache.set(cacheKey, response);\n\t\t\treturn response;\n\t\t}\n\n\t\t// Use stale-while-revalidate strategy\n\t\treturn staleWhileRevalidate(\n\t\t\tcacheKey,\n\t\t\t() => this.authenticatedFetch<any>(`/api/v1/bds/skills/${skillId}`),\n\t\t\tskillsCache\n\t\t);\n\t}\n\n\tasync searchSkills(query: string, options?: { skipCache?: boolean }): Promise<ListSkillsResponse> {\n\t\tconst cacheKey = generateCacheKey('/api/v1/bds/skills/search', { query });\n\n\t\t// Skip cache if requested\n\t\tif (options?.skipCache) {\n\t\t\tconst response = await this.authenticatedFetch<ListSkillsResponse>(\n\t\t\t\t`/api/v1/bds/skills/search?query=${encodeURIComponent(query)}`\n\t\t\t);\n\t\t\tuserCache.set(cacheKey, response);\n\t\t\treturn response;\n\t\t}\n\n\t\t// Use stale-while-revalidate strategy (shorter TTL for search)\n\t\treturn staleWhileRevalidate(\n\t\t\tcacheKey,\n\t\t\t() =>\n\t\t\t\tthis.authenticatedFetch<ListSkillsResponse>(\n\t\t\t\t\t`/api/v1/bds/skills/search?query=${encodeURIComponent(query)}`\n\t\t\t\t),\n\t\t\tuserCache\n\t\t);\n\t}\n\n\tasync invokeSkill(\n\t\tskillId: string,\n\t\trequest: SkillInvocationRequest\n\t): Promise<SkillInvocationResponse> {\n\t\treturn this.authenticatedFetch<SkillInvocationResponse>(\n\t\t\t`/api/v1/bds/skills/${skillId}/invoke`,\n\t\t\t{\n\t\t\t\tmethod: 'POST',\n\t\t\t\tbody: JSON.stringify(request)\n\t\t\t}\n\t\t);\n\t}\n\n\tasync *invokeSkillStreaming(\n\t\tskillId: string,\n\t\trequest: SkillInvocationRequest\n\t): AsyncGenerator<{type: 'token' | 'metadata' | 'error', data: any}> {\n\t\tlet reader: ReadableStreamDefaultReader<Uint8Array> | null = null;\n\n\t\ttry {\n\t\t\tconst response = await this.fetchWithTimeout(\n\t\t\t\t`${this.baseUrl}/api/v1/bds/skills/${skillId}/invoke?stream=true`,\n\t\t\t\t{\n\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\theaders: this.getAuthHeaders(),\n\t\t\t\t\tbody: JSON.stringify(request)\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tif (!response.ok) {\n\t\t\t\tthrow classifyError(response);\n\t\t\t}\n\n\t\t\tif (!response.body) {\n\t\t\t\tthrow createNetworkError('No response body', 'Streaming response has no body');\n\t\t\t}\n\n\t\t\treader = response.body.getReader();\n\t\t\tconst decoder = new TextDecoder();\n\t\t\tlet buffer = '';\n\n\t\t\twhile (true) {\n\t\t\t\tconst { done, value } = await reader.read();\n\n\t\t\t\tif (done) {\n\t\t\t\t\t// Process any remaining data in buffer\n\t\t\t\t\tif (buffer.trim()) {\n\t\t\t\t\t\tconst lines = buffer.split('\\n');\n\t\t\t\t\t\tfor (const line of lines) {\n\t\t\t\t\t\t\tconst trimmed = line.trim();\n\t\t\t\t\t\t\tif (trimmed.startsWith('data: ')) {\n\t\t\t\t\t\t\t\tconst jsonStr = trimmed.substring(6);\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\tconst parsed = JSON.parse(jsonStr);\n\t\t\t\t\t\t\t\t\tif (parsed.token) {\n\t\t\t\t\t\t\t\t\t\tyield { type: 'token', data: parsed };\n\t\t\t\t\t\t\t\t\t} else if (parsed.metadata) {\n\t\t\t\t\t\t\t\t\t\tyield { type: 'metadata', data: parsed.metadata };\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\t\t\tconsole.warn('Failed to parse SSE data:', jsonStr);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\t// Add to buffer\n\t\t\t\tbuffer += decoder.decode(value, { stream: true });\n\n\t\t\t\t// Process complete lines\n\t\t\t\tconst lines = buffer.split('\\n');\n\t\t\t\tbuffer = lines.pop() || ''; // Keep incomplete line in buffer\n\n\t\t\t\tfor (const line of lines) {\n\t\t\t\t\tconst trimmed = line.trim();\n\t\t\t\t\tif (trimmed.startsWith('data: ')) {\n\t\t\t\t\t\tconst jsonStr = trimmed.substring(6); // Remove \"data: \" prefix\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tconst parsed = JSON.parse(jsonStr);\n\n\t\t\t\t\t\t\t// Check what type of message this is\n\t\t\t\t\t\t\tif (parsed.token !== undefined) {\n\t\t\t\t\t\t\t\t// Token message\n\t\t\t\t\t\t\t\tyield { type: 'token', data: parsed };\n\t\t\t\t\t\t\t} else if (parsed.metadata) {\n\t\t\t\t\t\t\t\t// Metadata message (final)\n\t\t\t\t\t\t\t\tyield { type: 'metadata', data: parsed.metadata };\n\t\t\t\t\t\t\t} else if (parsed.error) {\n\t\t\t\t\t\t\t\t// Error message\n\t\t\t\t\t\t\t\tyield { type: 'error', data: parsed.error };\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\tconsole.warn('Failed to parse SSE data:', jsonStr, e);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tthrow classifyError(error);\n\t\t} finally {\n\t\t\tif (reader) {\n\t\t\t\ttry {\n\t\t\t\t\treader.releaseLock();\n\t\t\t\t} catch (e) {\n\t\t\t\t\t// Reader already released\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate async getAuthToken(): Promise<string> {\n\t\tlet token = tokenManager.getAccessToken();\n\t\tif (!token) {\n\t\t\tif (tokenManager.isExpiringSoon()) {\n\t\t\t\tawait this.refreshAccessToken();\n\t\t\t\ttoken = tokenManager.getAccessToken();\n\t\t\t}\n\t\t\tif (!token) throw new Error('Not authenticated');\n\t\t}\n\t\treturn token;\n\t}\n\n\tprivate getAuthHeaders(): Record<string, string> {\n\t\tconst token = tokenManager.getAccessToken();\n\t\treturn {\n\t\t\t'Content-Type': 'application/json',\n\t\t\t...(token ? { Authorization: `Bearer ${token}` } : {})\n\t\t};\n\t}\n\n\tprivate async authenticatedFetch<T>(path: string, options: RequestInit = {}): Promise<T> {\n\t\treturn this.retryFetch(async () => {\n\t\t\ttry {\n\t\t\t\tconst token = await this.getAuthToken();\n\t\t\t\tconst response = await this.fetchWithTimeout(`${this.baseUrl}${path}`, {\n\t\t\t\t\t...options,\n\t\t\t\t\theaders: { ...this.getAuthHeaders(), ...(options.headers || {}) }\n\t\t\t\t});\n\n\t\t\t\t// Handle 401 - Try to refresh token once\n\t\t\t\tif (response.status === 401) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tawait this.refreshAccessToken();\n\t\t\t\t\t\t// Retry with new token (no retry wrapper to avoid double retry)\n\t\t\t\t\t\tconst retryResponse = await this.fetchWithTimeout(`${this.baseUrl}${path}`, {\n\t\t\t\t\t\t\t...options,\n\t\t\t\t\t\t\theaders: { ...this.getAuthHeaders(), ...(options.headers || {}) }\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tif (!retryResponse.ok) {\n\t\t\t\t\t\t\tthrow classifyError(retryResponse);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn retryResponse.json();\n\t\t\t\t\t} catch (err) {\n\t\t\t\t\t\tthrow createAuthenticationError('Authentication failed after token refresh');\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (!response.ok) {\n\t\t\t\t\tthrow classifyError(response);\n\t\t\t\t}\n\n\t\t\t\treturn response.json();\n\t\t\t} catch (error) {\n\t\t\t\tthrow classifyError(error);\n\t\t\t}\n\t\t}, `API request to ${path}`);\n\t}\n}\n\nexport const forgeAgentsClient = new ForgeAgentsClient();\n","import { forgeAgentsClient } from './forgeAgentsClient';\nimport type { Skill } from './types';\n\nexport class SkillRegistry {\n\tprivate allSkills: Skill[] = [];\n\tprivate skillsLoaded = false;\n\tprivate loadingPromise: Promise<Skill[]> | null = null;\n\n\tasync loadSkills(): Promise<Skill[]> {\n\t\tif (this.skillsLoaded) return this.allSkills;\n\t\tif (this.loadingPromise) return this.loadingPromise;\n\n\t\tthis.loadingPromise = forgeAgentsClient.listSkills().then((response) => {\n\t\t\tthis.allSkills = response.skills;\n\t\t\tthis.skillsLoaded = true;\n\t\t\treturn this.allSkills;\n\t\t});\n\t\treturn this.loadingPromise;\n\t}\n\n\tasync getAllSkills(): Promise<Skill[]> {\n\t\treturn this.loadSkills();\n\t}\n\n\tasync getSkill(skillId: string): Promise<Skill | undefined> {\n\t\tconst skills = await this.getAllSkills();\n\t\treturn skills.find((s) => s.id === skillId);\n\t}\n\n\tasync getSkillsBySection(): Promise<Record<string, Skill[]>> {\n\t\tconst skills = await this.getAllSkills();\n\t\treturn skills.reduce(\n\t\t\t(acc, skill) => {\n\t\t\t\tif (!acc[skill.section]) acc[skill.section] = [];\n\t\t\t\tacc[skill.section].push(skill);\n\t\t\t\treturn acc;\n\t\t\t},\n\t\t\t{} as Record<string, Skill[]>\n\t\t);\n\t}\n\n\tasync getSkillsByCategory(): Promise<Record<string, Skill[]>> {\n\t\tconst skills = await this.getAllSkills();\n\t\treturn skills.reduce(\n\t\t\t(acc, skill) => {\n\t\t\t\tif (!acc[skill.category]) acc[skill.category] = [];\n\t\t\t\tacc[skill.category].push(skill);\n\t\t\t\treturn acc;\n\t\t\t},\n\t\t\t{} as Record<string, Skill[]>\n\t\t);\n\t}\n\n\tasync search(query: string): Promise<Skill[]> {\n\t\tconst skills = await this.getAllSkills();\n\t\tconst q = query.toLowerCase();\n\t\treturn skills.filter(\n\t\t\t(s) =>\n\t\t\t\ts.name.toLowerCase().includes(q) ||\n\t\t\t\ts.description.toLowerCase().includes(q) ||\n\t\t\t\ts.tags.some((tag) => tag.toLowerCase().includes(q))\n\t\t);\n\t}\n\n\tasync getPublicSkills(): Promise<Skill[]> {\n\t\tconst skills = await this.getAllSkills();\n\t\treturn skills.filter((s) => s.access === 'PUBLIC');\n\t}\n\n\tasync getBDSOnlySkills(): Promise<Skill[]> {\n\t\tconst skills = await this.getAllSkills();\n\t\treturn skills.filter((s) => s.access === 'BDS_ONLY');\n\t}\n\n\tclearCache(): void {\n\t\tthis.allSkills = [];\n\t\tthis.skillsLoaded = false;\n\t\tthis.loadingPromise = null;\n\t}\n}\n\nexport const skillRegistry = new SkillRegistry();\n","<script lang=\"ts\">\n\timport { onMount } from 'svelte';\n\timport { forgeAgentsClient } from '$lib/api/forgeAgentsClient';\n\timport { skillRegistry } from '$lib/api/skillRegistry';\n\timport { Panel, Button, Badge, Alert } from '$lib/components';\n\n\tlet testResults = $state<any[]>([]);\n\tlet loading = $state(false);\n\tlet currentTest = $state('');\n\n\tfunction addResult(test: string, status: 'success' | 'error', message: string, data?: any) {\n\t\ttestResults = [\n\t\t\t...testResults,\n\t\t\t{\n\t\t\t\ttest,\n\t\t\t\tstatus,\n\t\t\t\tmessage,\n\t\t\t\tdata,\n\t\t\t\ttimestamp: new Date().toISOString()\n\t\t\t}\n\t\t];\n\t}\n\n\tasync function runTests() {\n\t\ttestResults = [];\n\t\tloading = true;\n\n\t\ttry {\n\t\t\t// Test 1: List skills without auth (should get PUBLIC skills only)\n\t\t\tcurrentTest = 'Loading PUBLIC skills without authentication...';\n\t\t\ttry {\n\t\t\t\tconst skills = await skillRegistry.getAllSkills();\n\t\t\t\taddResult(\n\t\t\t\t\t'Public Skills (No Auth)',\n\t\t\t\t\t'success',\n\t\t\t\t\t`Loaded ${skills.length} skills`,\n\t\t\t\t\tskills.slice(0, 3)\n\t\t\t\t);\n\t\t\t} catch (err: any) {\n\t\t\t\taddResult('Public Skills (No Auth)', 'error', err.message, err);\n\t\t\t}\n\n\t\t\t// Test 2: Login as admin\n\t\t\tcurrentTest = 'Authenticating as admin@bds.com...';\n\t\t\ttry {\n\t\t\t\tconst authResponse = await forgeAgentsClient.login('admin@bds.com', 'password123');\n\t\t\t\taddResult(\n\t\t\t\t\t'Authentication',\n\t\t\t\t\t'success',\n\t\t\t\t\t`Logged in successfully (expires: ${authResponse.expires_at})`,\n\t\t\t\t\t{\n\t\t\t\t\t\ttoken_type: authResponse.token_type,\n\t\t\t\t\t\texpires_in: authResponse.expires_in,\n\t\t\t\t\t\taccess_token: authResponse.access_token.slice(0, 50) + '...'\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t} catch (err: any) {\n\t\t\t\taddResult('Authentication', 'error', err.message, err);\n\t\t\t}\n\n\t\t\t// Test 3: List skills with auth (should get ALL skills including BDS_ONLY)\n\t\t\tcurrentTest = 'Loading ALL skills with authentication...';\n\t\t\ttry {\n\t\t\t\t// Force reload after auth\n\t\t\t\tconst skills = await forgeAgentsClient.listSkills();\n\t\t\t\taddResult(\n\t\t\t\t\t'All Skills (With Auth)',\n\t\t\t\t\t'success',\n\t\t\t\t\t`Loaded ${skills.skills.length} skills`,\n\t\t\t\t\tskills.skills.slice(0, 3)\n\t\t\t\t);\n\t\t\t} catch (err: any) {\n\t\t\t\taddResult('All Skills (With Auth)', 'error', err.message, err);\n\t\t\t}\n\n\t\t\t// Test 4: Get specific skill\n\t\t\tcurrentTest = 'Fetching specific skill...';\n\t\t\ttry {\n\t\t\t\tconst skill = await forgeAgentsClient.getSkill('A1');\n\t\t\t\taddResult('Get Skill (A1)', 'success', `Retrieved skill: ${skill.name}`, skill);\n\t\t\t} catch (err: any) {\n\t\t\t\taddResult('Get Skill (A1)', 'error', err.message, err);\n\t\t\t}\n\n\t\t\t// Test 5: Invoke a skill (non-streaming)\n\t\t\tcurrentTest = 'Invoking skill...';\n\t\t\ttry {\n\t\t\t\tconst result = await forgeAgentsClient.invokeSkill('A1', {\n\t\t\t\t\tprompt: 'Test prompt for API integration',\n\t\t\t\t\tcontext: {},\n\t\t\t\t\ttemperature: 0.7,\n\t\t\t\t\tstream: false\n\t\t\t\t});\n\t\t\t\taddResult('Invoke Skill (A1)', 'success', `Invocation completed`, result);\n\t\t\t} catch (err: any) {\n\t\t\t\taddResult('Invoke Skill (A1)', 'error', err.message, err);\n\t\t\t}\n\t\t} finally {\n\t\t\tloading = false;\n\t\t\tcurrentTest = '';\n\t\t}\n\t}\n\n\tfunction clearResults() {\n\t\ttestResults = [];\n\t}\n</script>\n\n<div class=\"test-page\">\n\t<div class=\"test-header\">\n\t\t<h1 class=\"test-title\">ForgeAgents API Integration Test</h1>\n\t\t<p class=\"test-description\">\n\t\t\tThis page tests the connection between VibeForge_BDS frontend and the ForgeAgents BDS API.\n\t\t</p>\n\n\t\t<div class=\"test-actions\">\n\t\t\t<Button variant=\"primary\" onclick={runTests} disabled={loading}>\n\t\t\t\t{loading ? 'Running Tests...' : 'Run All Tests'}\n\t\t\t</Button>\n\t\t\t<Button variant=\"secondary\" onclick={clearResults} disabled={loading}>Clear Results</Button>\n\t\t</div>\n\n\t\t{#if loading}\n\t\t\t<Alert variant=\"info\" title=\"Testing in progress\">\n\t\t\t\t{currentTest}\n\t\t\t</Alert>\n\t\t{/if}\n\t</div>\n\n\t<div class=\"test-results\">\n\t\t{#if testResults.length === 0}\n\t\t\t<Panel variant=\"bordered\" padding=\"lg\">\n\t\t\t\t<div class=\"empty-state\">\n\t\t\t\t\t<p>No test results yet. Click \"Run All Tests\" to begin.</p>\n\t\t\t\t</div>\n\t\t\t</Panel>\n\t\t{:else}\n\t\t\t{#each testResults as result}\n\t\t\t\t<Panel variant=\"bordered\" padding=\"lg\">\n\t\t\t\t\t<div class=\"result-header\">\n\t\t\t\t\t\t<div class=\"result-info\">\n\t\t\t\t\t\t\t<h3 class=\"result-test\">{result.test}</h3>\n\t\t\t\t\t\t\t<span class=\"result-time\">{new Date(result.timestamp).toLocaleTimeString()}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<Badge variant={result.status === 'success' ? 'success' : 'error'}>\n\t\t\t\t\t\t\t{result.status.toUpperCase()}\n\t\t\t\t\t\t</Badge>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<p class=\"result-message\">{result.message}</p>\n\n\t\t\t\t\t{#if result.data}\n\t\t\t\t\t\t<details class=\"result-details\">\n\t\t\t\t\t\t\t<summary>View Data</summary>\n\t\t\t\t\t\t\t<pre class=\"result-data\">{JSON.stringify(result.data, null, 2)}</pre>\n\t\t\t\t\t\t</details>\n\t\t\t\t\t{/if}\n\t\t\t\t</Panel>\n\t\t\t{/each}\n\t\t{/if}\n\t</div>\n\n\t<div class=\"test-info\">\n\t\t<Panel variant=\"bordered\" padding=\"lg\">\n\t\t\t<h3 class=\"info-title\">Test Information</h3>\n\t\t\t<dl class=\"info-list\">\n\t\t\t\t<dt>API Base URL:</dt>\n\t\t\t\t<dd>\n\t\t\t\t\t<code>http://localhost:3000</code>\n\t\t\t\t</dd>\n\t\t\t\t<dt>Test Credentials:</dt>\n\t\t\t\t<dd>\n\t\t\t\t\t<code>admin@bds.com</code> / <code>password123</code>\n\t\t\t\t</dd>\n\t\t\t\t<dt>Expected Results:</dt>\n\t\t\t\t<dd>\n\t\t\t\t\t<ul>\n\t\t\t\t\t\t<li>Test 1: Should load ~67 PUBLIC skills</li>\n\t\t\t\t\t\t<li>Test 2: Should authenticate successfully</li>\n\t\t\t\t\t\t<li>Test 3: Should load all 120 skills (67 PUBLIC + 53 BDS_ONLY)</li>\n\t\t\t\t\t\t<li>Test 4: Should retrieve specific skill details</li>\n\t\t\t\t\t\t<li>Test 5: Should invoke skill and get response</li>\n\t\t\t\t\t</ul>\n\t\t\t\t</dd>\n\t\t\t\t<dt>Console Logging:</dt>\n\t\t\t\t<dd>Open browser DevTools Console to see detailed request/response logs</dd>\n\t\t\t</dl>\n\t\t</Panel>\n\t</div>\n</div>\n\n<style>\n\t.test-page {\n\t\tmax-width: 1200px;\n\t\tmargin: 0 auto;\n\t\tpadding: var(--spacing-xl);\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: var(--spacing-xl);\n\t}\n\n\t.test-header {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: var(--spacing-lg);\n\t}\n\n\t.test-title {\n\t\tfont-family: var(--font-family-heading);\n\t\tfont-size: 2rem;\n\t\tfont-weight: 300;\n\t\tcolor: var(--color-text-primary);\n\t\tmargin: 0;\n\t\tletter-spacing: 0.02em;\n\t}\n\n\t.test-description {\n\t\tfont-size: 1rem;\n\t\tcolor: var(--color-text-secondary);\n\t\tmargin: 0;\n\t}\n\n\t.test-actions {\n\t\tdisplay: flex;\n\t\tgap: var(--spacing-md);\n\t}\n\n\t.test-results {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: var(--spacing-md);\n\t}\n\n\t.empty-state {\n\t\ttext-align: center;\n\t\tpadding: var(--spacing-3xl) var(--spacing-xl);\n\t\tcolor: var(--color-text-secondary);\n\t}\n\n\t.result-header {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: flex-start;\n\t\tgap: var(--spacing-md);\n\t\tmargin-bottom: var(--spacing-md);\n\t}\n\n\t.result-info {\n\t\tflex: 1;\n\t}\n\n\t.result-test {\n\t\tfont-family: var(--font-family-heading);\n\t\tfont-size: 1.125rem;\n\t\tfont-weight: 400;\n\t\tcolor: var(--color-text-primary);\n\t\tmargin: 0 0 var(--spacing-xs) 0;\n\t}\n\n\t.result-time {\n\t\tfont-size: 0.75rem;\n\t\tcolor: var(--color-text-tertiary);\n\t\tfont-family: var(--font-family-mono);\n\t}\n\n\t.result-message {\n\t\tfont-size: 0.9375rem;\n\t\tcolor: var(--color-text-secondary);\n\t\tmargin: 0 0 var(--spacing-md) 0;\n\t}\n\n\t.result-details {\n\t\tmargin-top: var(--spacing-md);\n\t}\n\n\t.result-details summary {\n\t\tcursor: pointer;\n\t\tfont-size: 0.875rem;\n\t\tfont-weight: 500;\n\t\tcolor: var(--color-brass);\n\t\tuser-select: none;\n\t}\n\n\t.result-details summary:hover {\n\t\ttext-decoration: underline;\n\t}\n\n\t.result-data {\n\t\tmargin-top: var(--spacing-sm);\n\t\tpadding: var(--spacing-md);\n\t\tbackground-color: var(--color-surface-2);\n\t\tborder: 1px solid var(--color-border-subtle);\n\t\tborder-radius: var(--radius-md);\n\t\tfont-family: var(--font-family-mono);\n\t\tfont-size: 0.8125rem;\n\t\tcolor: var(--color-text-secondary);\n\t\toverflow-x: auto;\n\t\twhite-space: pre-wrap;\n\t\tword-break: break-all;\n\t}\n\n\t.test-info {\n\t\tmargin-top: var(--spacing-xl);\n\t}\n\n\t.info-title {\n\t\tfont-family: var(--font-family-heading);\n\t\tfont-size: 1.25rem;\n\t\tfont-weight: 300;\n\t\tcolor: var(--color-text-primary);\n\t\tmargin: 0 0 var(--spacing-lg) 0;\n\t}\n\n\t.info-list {\n\t\tdisplay: grid;\n\t\tgap: var(--spacing-md);\n\t\tmargin: 0;\n\t}\n\n\t.info-list dt {\n\t\tfont-weight: 600;\n\t\tcolor: var(--color-text-primary);\n\t\tmargin: 0;\n\t}\n\n\t.info-list dd {\n\t\tmargin: var(--spacing-xs) 0 0 0;\n\t\tcolor: var(--color-text-secondary);\n\t}\n\n\t.info-list code {\n\t\tbackground-color: var(--color-surface-2);\n\t\tpadding: 0.125rem 0.375rem;\n\t\tborder-radius: var(--radius-sm);\n\t\tfont-family: var(--font-family-mono);\n\t\tfont-size: 0.875rem;\n\t\tcolor: var(--color-brass);\n\t}\n\n\t.info-list ul {\n\t\tmargin: var(--spacing-xs) 0 0 0;\n\t\tpadding-left: var(--spacing-lg);\n\t}\n\n\t.info-list li {\n\t\tmargin-bottom: var(--spacing-xs);\n\t\tfont-size: 0.875rem;\n\t\tline-height: 1.5;\n\t}\n</style>\n"],"names":["STORAGE_KEY","async","getTauriInvoke","window","import","invoke","tokenManager","accessToken","refreshToken","expiresAt","constructor","this","initialize","catch","err","stored","Date","getTime","localStorage","getItem","data","JSON","parse","setTokens","setItem","stringify","clearTokens","removeItem","getAccessToken","now","getRefreshToken","isAuthenticated","isExpiringSoon","LRUCache","cache","maxSize","ttl","hits","misses","options","Map","get","key","entry","delete","set","value","customTtl","has","size","firstKey","keys","next","clear","prune","pruned","entries","getStats","getHitRate","total","Array","from","generateCacheKey","endpoint","params","userId","parts","sortedParams","Object","sort","map","join","push","staleWhileRevalidate","fetchFn","onRevalidate","cached","then","fresh","error","skillsCache","userCache","forgeAgentsClient","baseUrl","refreshPromise","maxRetries","timeout","retryFetch","operation","context","lastError","attempt","appError","classifyError","shouldRetry","delay","getRetryDelay","Promise","resolve","setTimeout","createNetworkError","fetchWithTimeout","url","controller","AbortController","timeoutId","abort","startTime","response","fetch","signal","name","clearTimeout","login","email","password","method","headers","body","ok","json","access_token","refresh_token","expires_at","logout","getAuthHeaders","refreshAccessToken","_performRefresh","Error","listSkills","cacheKey","skipCache","authenticatedFetch","getSkill","skillId","searchSkills","query","encodeURIComponent","invokeSkill","request","invokeSkillStreaming","reader","getReader","decoder","TextDecoder","buffer","done","read","trim","lines","split","line","trimmed","startsWith","jsonStr","substring","parsed","token","type","metadata","e","decode","stream","pop","releaseLock","getAuthToken","Authorization","path","status","retryResponse","createAuthenticationError","skillRegistry","allSkills","skillsLoaded","loadingPromise","loadSkills","skills","getAllSkills","find","s","id","getSkillsBySection","reduce","acc","skill","section","getSkillsByCategory","category","search","q","toLowerCase","filter","includes","description","tags","some","tag","getPublicSkills","access","getBDSOnlySkills","clearCache","testResults","loading","currentTest","addResult","test","message","timestamp","toISOString","length","slice","authResponse","token_type","expires_in","prompt","temperature","result","each_array","$$index","$.escape","toLocaleTimeString","variant","toUpperCase","$$renderer"],"mappings":"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"}