{"version":3,"file":"_page.svelte.js","sources":["../../../../../../src/routes/workflows/+page.svelte"],"sourcesContent":["<script lang=\"ts\">\n\timport { Panel, Badge, Button, Input, Select, Alert, DragDropWorkflow } from '$lib/components';\n\timport { skillRegistry } from '$lib/api/skillRegistry';\n\timport { onMount } from 'svelte';\n\timport type { Skill } from '$lib/api/types';\n\n\tinterface WorkflowStep {\n\t\tid: string;\n\t\tskillId: string;\n\t\tskillName: string;\n\t\torder: number;\n\t\tinputs: Record<string, any>;\n\t\tuseOutputFrom?: string; // Previous step ID\n\t}\n\n\tinterface Workflow {\n\t\tid: string;\n\t\tname: string;\n\t\tdescription: string;\n\t\tsteps: WorkflowStep[];\n\t\tcreatedAt: Date;\n\t\tlastRun?: Date;\n\t\tstatus: 'draft' | 'active' | 'archived';\n\t}\n\n\t// State\n\tlet workflows = $state<Workflow[]>([]);\n\tlet skills = $state<Skill[]>([]);\n\tlet loading = $state(true);\n\tlet selectedWorkflow = $state<Workflow | null>(null);\n\tlet isCreatingWorkflow = $state(false);\n\tlet newWorkflowName = $state('');\n\tlet newWorkflowDescription = $state('');\n\n\t// Load data\n\tonMount(async () => {\n\t\ttry {\n\t\t\tskills = await skillRegistry.getAllSkills();\n\t\t\tloadWorkflows();\n\t\t\tloading = false;\n\t\t} catch (err) {\n\t\t\tconsole.error('Failed to load data:', err);\n\t\t\tloading = false;\n\t\t}\n\t});\n\n\tfunction loadWorkflows() {\n\t\tconst stored = localStorage.getItem('workflows');\n\t\tif (stored) {\n\t\t\ttry {\n\t\t\t\tconst parsed = JSON.parse(stored);\n\t\t\t\tworkflows = parsed.map((w: any) => ({\n\t\t\t\t\t...w,\n\t\t\t\t\tcreatedAt: new Date(w.createdAt),\n\t\t\t\t\tlastRun: w.lastRun ? new Date(w.lastRun) : undefined\n\t\t\t\t}));\n\t\t\t} catch (err) {\n\t\t\t\tconsole.error('Failed to parse workflows:', err);\n\t\t\t\tworkflows = [];\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction saveWorkflows() {\n\t\tlocalStorage.setItem('workflows', JSON.stringify(workflows));\n\t}\n\n\tfunction createWorkflow() {\n\t\tif (!newWorkflowName.trim()) return;\n\n\t\tconst newWorkflow: Workflow = {\n\t\t\tid: `wf-${Date.now()}`,\n\t\t\tname: newWorkflowName,\n\t\t\tdescription: newWorkflowDescription,\n\t\t\tsteps: [],\n\t\t\tcreatedAt: new Date(),\n\t\t\tstatus: 'draft'\n\t\t};\n\n\t\tworkflows = [...workflows, newWorkflow];\n\t\tsaveWorkflows();\n\n\t\tselectedWorkflow = newWorkflow;\n\t\tisCreatingWorkflow = false;\n\t\tnewWorkflowName = '';\n\t\tnewWorkflowDescription = '';\n\t}\n\n\tfunction deleteWorkflow(workflowId: string) {\n\t\tworkflows = workflows.filter((w) => w.id !== workflowId);\n\t\tsaveWorkflows();\n\t\tif (selectedWorkflow?.id === workflowId) {\n\t\t\tselectedWorkflow = null;\n\t\t}\n\t}\n\n\tfunction addStep(workflowId: string, skillId: string) {\n\t\tconst skill = skills.find((s) => s.id === skillId);\n\t\tif (!skill) return;\n\n\t\tworkflows = workflows.map((w) => {\n\t\t\tif (w.id === workflowId) {\n\t\t\t\tconst newStep: WorkflowStep = {\n\t\t\t\t\tid: `step-${Date.now()}`,\n\t\t\t\t\tskillId: skill.id,\n\t\t\t\t\tskillName: skill.name,\n\t\t\t\t\torder: w.steps.length + 1,\n\t\t\t\t\tinputs: {}\n\t\t\t\t};\n\t\t\t\treturn {\n\t\t\t\t\t...w,\n\t\t\t\t\tsteps: [...w.steps, newStep]\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn w;\n\t\t});\n\n\t\tsaveWorkflows();\n\t\tselectedWorkflow = workflows.find((w) => w.id === workflowId) || null;\n\t}\n\n\tfunction removeStep(workflowId: string, stepId: string) {\n\t\tworkflows = workflows.map((w) => {\n\t\t\tif (w.id === workflowId) {\n\t\t\t\treturn {\n\t\t\t\t\t...w,\n\t\t\t\t\tsteps: w.steps.filter((s) => s.id !== stepId).map((s, i) => ({ ...s, order: i + 1 }))\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn w;\n\t\t});\n\n\t\tsaveWorkflows();\n\t\tselectedWorkflow = workflows.find((w) => w.id === workflowId) || null;\n\t}\n\n\tfunction getStatusVariant(status: Workflow['status']) {\n\t\tconst variants = {\n\t\t\tdraft: 'default' as const,\n\t\t\tactive: 'success' as const,\n\t\t\tarchived: 'warning' as const\n\t\t};\n\t\treturn variants[status];\n\t}\n\n\tlet stats = $derived.by(() => ({\n\t\ttotal: workflows.length,\n\t\tdraft: workflows.filter((w) => w.status === 'draft').length,\n\t\tactive: workflows.filter((w) => w.status === 'active').length,\n\t\tarchived: workflows.filter((w) => w.status === 'archived').length\n\t}));\n</script>\n\n<div class=\"workflows-container\">\n\t<!-- Page Header -->\n\t<div class=\"page-header\">\n\t\t<div class=\"header-content\">\n\t\t\t<h1 class=\"page-title\">Skill Workflows</h1>\n\t\t\t<p class=\"page-description\">\n\t\t\t\tBuild multi-step workflows by chaining skills together for complex automation\n\t\t\t</p>\n\t\t</div>\n\n\t\t<div class=\"stats-row\">\n\t\t\t<div class=\"stat-item\">\n\t\t\t\t<span class=\"stat-value\">{stats.total}</span>\n\t\t\t\t<span class=\"stat-label\">Total</span>\n\t\t\t</div>\n\t\t\t<div class=\"stat-item\">\n\t\t\t\t<span class=\"stat-value default\">{stats.draft}</span>\n\t\t\t\t<span class=\"stat-label\">Draft</span>\n\t\t\t</div>\n\t\t\t<div class=\"stat-item\">\n\t\t\t\t<span class=\"stat-value success\">{stats.active}</span>\n\t\t\t\t<span class=\"stat-label\">Active</span>\n\t\t\t</div>\n\t\t\t<div class=\"stat-item\">\n\t\t\t\t<span class=\"stat-value warning\">{stats.archived}</span>\n\t\t\t\t<span class=\"stat-label\">Archived</span>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\n\t<!-- Main Content -->\n\t<div class=\"content-grid\">\n\t\t<!-- Workflows List -->\n\t\t<Panel variant=\"bordered\" padding=\"lg\">\n\t\t\t<div class=\"section-header\">\n\t\t\t\t<h2>My Workflows</h2>\n\t\t\t\t<Button\n\t\t\t\t\tvariant=\"primary\"\n\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\ton:click={() => (isCreatingWorkflow = true)}\n\t\t\t\t\tdisabled={isCreatingWorkflow}\n\t\t\t\t>\n\t\t\t\t\t+ New Workflow\n\t\t\t\t</Button>\n\t\t\t</div>\n\n\t\t\t{#if isCreatingWorkflow}\n\t\t\t\t<Panel variant=\"elevated\" padding=\"md\">\n\t\t\t\t\t<div class=\"create-workflow-form\">\n\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\tlabel=\"Workflow Name\"\n\t\t\t\t\t\t\tbind:value={newWorkflowName}\n\t\t\t\t\t\t\tplaceholder=\"e.g., Code Review & Test\"\n\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t\tfullWidth\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\tlabel=\"Description\"\n\t\t\t\t\t\t\tbind:value={newWorkflowDescription}\n\t\t\t\t\t\t\tplaceholder=\"Describe what this workflow does...\"\n\t\t\t\t\t\t\tfullWidth\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<div class=\"form-actions\">\n\t\t\t\t\t\t\t<Button variant=\"primary\" on:click={createWorkflow} disabled={!newWorkflowName.trim()}>\n\t\t\t\t\t\t\t\tCreate\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t<Button variant=\"ghost\" on:click={() => (isCreatingWorkflow = false)}>\n\t\t\t\t\t\t\t\tCancel\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</Panel>\n\t\t\t{/if}\n\n\t\t\t{#if workflows.length === 0}\n\t\t\t\t<div class=\"empty-state\">\n\t\t\t\t\t<p>No workflows yet. Create your first workflow to get started.</p>\n\t\t\t\t</div>\n\t\t\t{:else}\n\t\t\t\t<div class=\"workflows-list\">\n\t\t\t\t\t{#each workflows as workflow (workflow.id)}\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclass=\"workflow-item\"\n\t\t\t\t\t\t\tclass:selected={selectedWorkflow?.id === workflow.id}\n\t\t\t\t\t\t\tonclick={() => (selectedWorkflow = workflow)}\n\t\t\t\t\t\t\tonkeydown={(e) => {\n\t\t\t\t\t\t\t\tif (e.key === 'Enter' || e.key === ' ') {\n\t\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\t\tselectedWorkflow = workflow;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\trole=\"button\"\n\t\t\t\t\t\t\ttabindex=\"0\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div class=\"workflow-info\">\n\t\t\t\t\t\t\t\t<div class=\"workflow-name\">{workflow.name}</div>\n\t\t\t\t\t\t\t\t<div class=\"workflow-description\">{workflow.description || 'No description'}</div>\n\t\t\t\t\t\t\t\t<div class=\"workflow-meta\">\n\t\t\t\t\t\t\t\t\t<Badge variant={getStatusVariant(workflow.status)} size=\"sm\">\n\t\t\t\t\t\t\t\t\t\t{workflow.status}\n\t\t\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t\t\t\t<span class=\"workflow-steps\">{workflow.steps.length} steps</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\tvariant=\"danger\"\n\t\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\t\ton:click={(e) => {\n\t\t\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t\t\tdeleteWorkflow(workflow.id);\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tDelete\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/each}\n\t\t\t\t</div>\n\t\t\t{/if}\n\t\t</Panel>\n\n\t\t<!-- Workflow Details/Builder -->\n\t\t{#if selectedWorkflow}\n\t\t\t<DragDropWorkflow\n\t\t\t\tskills={skills}\n\t\t\t\tinitialSteps={selectedWorkflow.steps}\n\t\t\t\tonSave={(steps) => {\n\t\t\t\t\tworkflows = workflows.map((w) => {\n\t\t\t\t\t\tif (w.id === selectedWorkflow.id) {\n\t\t\t\t\t\t\treturn { ...w, steps };\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn w;\n\t\t\t\t\t});\n\t\t\t\t\tsaveWorkflows();\n\t\t\t\t\tselectedWorkflow = workflows.find((w) => w.id === selectedWorkflow.id) || null;\n\t\t\t\t}}\n\t\t\t\tonCancel={() => (selectedWorkflow = null)}\n\t\t\t/>\n\t\t{:else}\n\t\t\t<Panel variant=\"bordered\" padding=\"lg\">\n\t\t\t\t<div class=\"no-selection\">\n\t\t\t\t\t<p>Select a workflow from the list to view and edit its steps.</p>\n\t\t\t\t</div>\n\t\t\t</Panel>\n\t\t{/if}\n\t</div>\n</div>\n\n<style>\n\t/* ═══════════════════════════════════════════════════════════════════════\n     Workflows Container\n     ═══════════════════════════════════════════════════════════════════════ */\n\n\t.workflows-container {\n\t\tmax-width: 1400px;\n\t\tmargin: 0 auto;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: var(--spacing-xl);\n\t}\n\n\t/* Page Header */\n\t.page-header {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: var(--spacing-lg);\n\t}\n\n\t.header-content {\n\t\tflex: 1;\n\t}\n\n\t.page-title {\n\t\tfont-family: var(--font-family-heading);\n\t\tfont-size: 2.5rem;\n\t\tfont-weight: 300;\n\t\tcolor: var(--color-text-primary);\n\t\tmargin: 0 0 var(--spacing-sm) 0;\n\t\tletter-spacing: 0.02em;\n\t}\n\n\t.page-description {\n\t\tfont-size: 1.125rem;\n\t\tcolor: var(--color-text-secondary);\n\t\tmargin: 0;\n\t}\n\n\t.stats-row {\n\t\tdisplay: flex;\n\t\tgap: var(--spacing-xl);\n\t\tflex-wrap: wrap;\n\t}\n\n\t.stat-item {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: var(--spacing-xs);\n\t}\n\n\t.stat-value {\n\t\tfont-size: 2rem;\n\t\tfont-weight: 600;\n\t\tcolor: var(--color-text-primary);\n\t\tfont-family: var(--font-family-mono);\n\t}\n\n\t.stat-value.default {\n\t\tcolor: var(--color-cool-gray);\n\t}\n\n\t.stat-value.success {\n\t\tcolor: var(--color-success);\n\t}\n\n\t.stat-value.warning {\n\t\tcolor: var(--color-warning);\n\t}\n\n\t.stat-label {\n\t\tfont-size: 0.75rem;\n\t\tcolor: var(--color-text-tertiary);\n\t\ttext-transform: uppercase;\n\t\tletter-spacing: 0.05em;\n\t}\n\n\t/* Content Grid */\n\t.content-grid {\n\t\tdisplay: grid;\n\t\tgrid-template-columns: 400px 1fr;\n\t\tgap: var(--spacing-xl);\n\t}\n\n\t.section-header {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tmargin-bottom: var(--spacing-lg);\n\t}\n\n\th2 {\n\t\tfont-family: var(--font-family-heading);\n\t\tfont-size: 1.5rem;\n\t\tfont-weight: 300;\n\t\tcolor: var(--color-text-primary);\n\t\tmargin: 0;\n\t\tletter-spacing: 0.02em;\n\t}\n\n\th3 {\n\t\tfont-family: var(--font-family-heading);\n\t\tfont-size: 1.125rem;\n\t\tfont-weight: 300;\n\t\tcolor: var(--color-text-primary);\n\t\tmargin: 0 0 var(--spacing-md) 0;\n\t\tletter-spacing: 0.02em;\n\t}\n\n\t/* Create Workflow Form */\n\t.create-workflow-form {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: var(--spacing-md);\n\t}\n\n\t.form-actions {\n\t\tdisplay: flex;\n\t\tgap: var(--spacing-md);\n\t}\n\n\t/* Empty State */\n\t.empty-state {\n\t\tpadding: var(--spacing-xl);\n\t\ttext-align: center;\n\t\tcolor: var(--color-text-secondary);\n\t}\n\n\t/* Workflows List */\n\t.workflows-list {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: var(--spacing-md);\n\t}\n\n\t.workflow-item {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tgap: var(--spacing-md);\n\t\tpadding: var(--spacing-md);\n\t\tbackground-color: var(--color-surface-3);\n\t\tborder: 2px solid transparent;\n\t\tborder-radius: var(--radius-md);\n\t\tcursor: pointer;\n\t\ttransition: all var(--transition-fast);\n\t}\n\n\t.workflow-item:hover {\n\t\tbackground-color: var(--color-surface-elevated);\n\t\tborder-color: var(--color-border-default);\n\t}\n\n\t.workflow-item.selected {\n\t\tborder-color: var(--color-brass);\n\t\tbackground-color: var(--color-surface-elevated);\n\t}\n\n\t.workflow-info {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: var(--spacing-xs);\n\t\tflex: 1;\n\t}\n\n\t.workflow-name {\n\t\tfont-weight: 500;\n\t\tcolor: var(--color-text-primary);\n\t}\n\n\t.workflow-description {\n\t\tfont-size: 0.875rem;\n\t\tcolor: var(--color-text-secondary);\n\t}\n\n\t.workflow-meta {\n\t\tdisplay: flex;\n\t\tgap: var(--spacing-sm);\n\t\talign-items: center;\n\t}\n\n\t.workflow-steps {\n\t\tfont-size: 0.75rem;\n\t\tcolor: var(--color-text-tertiary);\n\t}\n\n\t/* Workflow Builder */\n\t.workflow-builder {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: var(--spacing-xl);\n\t}\n\n\t.builder-header {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t}\n\n\t.builder-description {\n\t\tcolor: var(--color-text-secondary);\n\t\tmargin: 0;\n\t}\n\n\t.steps-section,\n\t.add-step-section {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: var(--spacing-md);\n\t}\n\n\t.steps-list {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: var(--spacing-sm);\n\t}\n\n\t.step-card {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: var(--spacing-md);\n\t\tpadding: var(--spacing-md);\n\t\tbackground-color: var(--color-surface-3);\n\t\tborder-radius: var(--radius-md);\n\t}\n\n\t.step-number {\n\t\twidth: 32px;\n\t\theight: 32px;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tbackground-color: var(--color-brass);\n\t\tcolor: var(--color-midnight);\n\t\tborder-radius: 50%;\n\t\tfont-weight: 600;\n\t\tfont-size: 0.875rem;\n\t}\n\n\t.step-content {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: var(--spacing-xs);\n\t\tflex: 1;\n\t}\n\n\t.step-name {\n\t\tfont-weight: 500;\n\t\tcolor: var(--color-text-primary);\n\t}\n\n\t.step-id {\n\t\tfont-family: var(--font-family-mono);\n\t\tfont-size: 0.75rem;\n\t\tcolor: var(--color-text-tertiary);\n\t}\n\n\t.step-connector {\n\t\ttext-align: center;\n\t\tcolor: var(--color-brass);\n\t\tfont-size: 1.5rem;\n\t\tpadding: var(--spacing-xs) 0;\n\t}\n\n\t.no-selection {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tmin-height: 400px;\n\t\tcolor: var(--color-text-secondary);\n\t}\n\n\t/* Responsive */\n\t@media (max-width: 768px) {\n\t\t.page-title {\n\t\t\tfont-size: 2rem;\n\t\t}\n\n\t\t.stats-row {\n\t\t\tflex-direction: column;\n\t\t\tgap: var(--spacing-md);\n\t\t}\n\n\t\t.content-grid {\n\t\t\tgrid-template-columns: 1fr;\n\t\t}\n\t}\n</style>\n"],"names":["workflows","getStatusVariant","status","draft","active","archived","stats","total","length","filter","w","$$renderer","push","$.escape","workflow","each_array","$$index","$.attr_class","selected","selectedWorkflow","id","name","description","steps"],"mappings":"0OA0BKA,EAAS,YA8GJC,EAAiBC,GAMlB,MALO,CACbC,MAAO,UACPC,OAAQ,UACRC,SAAU,WAEKH,EACjB,OAEII,EAAK,CACRC,MAAOP,EAAUQ,OACjBL,MAAOH,EAAUS,OAAQC,GAAmB,UAAbA,EAAER,QAAoBM,OACrDJ,OAAQJ,EAAUS,OAAQC,GAAmB,WAAbA,EAAER,QAAqBM,OACvDH,SAAUL,EAAUS,OAAQC,GAAmB,aAAbA,EAAER,QAAuBM,2BAgB/BG,EAAAC,KAAA,wbAAAC,EAAAP,EAAMC,kKAAKM,EAIHP,EAAMH,kKAAKU,EAIXP,EAAMF,oKAAMS,EAIZP,EAAMD,0UAnJX,oKAqMJ,IAArBL,EAAUQ,yQAMNR,uCAAac,EAAQC,EAAAC,GAGVL,EAAAC,KAAA,OAAAK,EAAA,oCAAA,EAAA,CAAAC,SAAAC,YAAyBL,EAASM,uHAAEP,EAYvBC,EAASO,gEAAIR,EACNC,EAASQ,aAAe,mFAE1CrB,EAAiBa,EAASZ,+BACxCS,EAAAC,KAAA,gBAAAC,EAAAC,EAASZ,yGAEmBY,EAASS,MAAMf"}