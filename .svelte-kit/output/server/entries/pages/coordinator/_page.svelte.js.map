{"version":3,"file":"_page.svelte.js","sources":["../../../../../../src/lib/stores/coordinator.svelte.ts","../../../../../../src/lib/services/coordinatorService.ts","../../../../../../src/lib/components/panels/coordinator/WorkflowRequest.svelte","../../../../../../src/lib/components/panels/coordinator/WorkflowVisualization.svelte","../../../../../../src/routes/coordinator/+page.svelte","../../../../../../src/lib/components/panels/coordinator/WorkflowHistory.svelte"],"sourcesContent":["/**\n * Coordinator Store\n *\n * Manages multi-agent workflow coordination using Svelte 5 runes.\n */\n\nimport type {\n\tCoordinationSession,\n\tWorkflowRequest,\n\tWorkflowExecution,\n\tWorkflowNodeExecution\n} from '$lib/types/agents';\nimport { SessionStatus, WorkflowStatus } from '$lib/types/agents';\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// Coordinator Store State\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\ninterface CoordinatorState {\n\tsessions: CoordinationSession[];\n\tcurrentSession: CoordinationSession | null;\n\tisCoordinating: boolean;\n}\n\nconst state = $state<CoordinatorState>({\n\tsessions: [],\n\tcurrentSession: null,\n\tisCoordinating: false\n});\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// Coordinator Store\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\nexport const coordinatorStore = {\n\t// Getters\n\tget sessions() {\n\t\treturn state.sessions;\n\t},\n\n\tget currentSession() {\n\t\treturn state.currentSession;\n\t},\n\n\tget isCoordinating() {\n\t\treturn state.isCoordinating;\n\t},\n\n\tget activeSessions() {\n\t\treturn state.sessions.filter(\n\t\t\t(s) => s.status === SessionStatus.RUNNING || s.status === SessionStatus.PENDING\n\t\t);\n\t},\n\n\tget completedSessions() {\n\t\treturn state.sessions.filter((s) => s.status === SessionStatus.COMPLETED);\n\t},\n\n\tget failedSessions() {\n\t\treturn state.sessions.filter((s) => s.status === SessionStatus.FAILED);\n\t},\n\n\t// Actions\n\tcreateSession(request: WorkflowRequest): CoordinationSession {\n\t\t// Initialize workflow node executions\n\t\tconst nodeExecutions: WorkflowNodeExecution[] = request.agents.map((agent) => ({\n\t\t\tnodeId: agent.id,\n\t\t\tstatus: 'pending',\n\t\t\tprogress: 0\n\t\t}));\n\n\t\tconst workflow: WorkflowExecution = {\n\t\t\tnodes: nodeExecutions,\n\t\t\tstatus: WorkflowStatus.PENDING\n\t\t};\n\n\t\tconst session: CoordinationSession = {\n\t\t\tid: generateSessionId(),\n\t\t\ttype: 'coordination',\n\t\t\tstatus: SessionStatus.PENDING,\n\t\t\tcreatedAt: new Date(),\n\t\t\trequest,\n\t\t\tworkflow\n\t\t};\n\n\t\tstate.sessions = [...state.sessions, session];\n\t\tstate.currentSession = session;\n\n\t\treturn session;\n\t},\n\n\tstartSession(sessionId: string): void {\n\t\tconst session = state.sessions.find((s) => s.id === sessionId);\n\t\tif (!session) return;\n\n\t\tsession.status = SessionStatus.RUNNING;\n\t\tsession.startedAt = new Date();\n\t\tsession.workflow.status = WorkflowStatus.RUNNING;\n\t\tsession.workflow.startedAt = new Date();\n\n\t\tstate.isCoordinating = true;\n\n\t\t// Trigger reactivity\n\t\tstate.sessions = [...state.sessions];\n\t},\n\n\tupdateNodeExecution(\n\t\tsessionId: string,\n\t\tnodeId: string,\n\t\tupdates: Partial<WorkflowNodeExecution>\n\t): void {\n\t\tconst session = state.sessions.find((s) => s.id === sessionId);\n\t\tif (!session) return;\n\n\t\tconst node = session.workflow.nodes.find((n) => n.nodeId === nodeId);\n\t\tif (!node) return;\n\n\t\t// Apply updates\n\t\tObject.assign(node, updates);\n\n\t\t// Trigger reactivity\n\t\tstate.sessions = [...state.sessions];\n\t},\n\n\tstartNode(sessionId: string, nodeId: string, agentSessionId: string): void {\n\t\tconst session = state.sessions.find((s) => s.id === sessionId);\n\t\tif (!session) return;\n\n\t\tconst node = session.workflow.nodes.find((n) => n.nodeId === nodeId);\n\t\tif (!node) return;\n\n\t\tnode.status = 'running';\n\t\tnode.sessionId = agentSessionId;\n\t\tnode.startedAt = new Date();\n\t\tnode.progress = 0;\n\n\t\t// Trigger reactivity\n\t\tstate.sessions = [...state.sessions];\n\t},\n\n\tupdateNodeProgress(sessionId: string, nodeId: string, progress: number): void {\n\t\tconst session = state.sessions.find((s) => s.id === sessionId);\n\t\tif (!session) return;\n\n\t\tconst node = session.workflow.nodes.find((n) => n.nodeId === nodeId);\n\t\tif (!node) return;\n\n\t\tnode.progress = Math.min(100, Math.max(0, progress));\n\n\t\t// Trigger reactivity\n\t\tstate.sessions = [...state.sessions];\n\t},\n\n\tcompleteNode(sessionId: string, nodeId: string): void {\n\t\tconst session = state.sessions.find((s) => s.id === sessionId);\n\t\tif (!session) return;\n\n\t\tconst node = session.workflow.nodes.find((n) => n.nodeId === nodeId);\n\t\tif (!node) return;\n\n\t\tnode.status = 'completed';\n\t\tnode.completedAt = new Date();\n\t\tnode.progress = 100;\n\n\t\t// Check if all nodes are completed\n\t\tconst allCompleted = session.workflow.nodes.every((n) => n.status === 'completed');\n\t\tif (allCompleted) {\n\t\t\tthis.completeSession(sessionId);\n\t\t}\n\n\t\t// Trigger reactivity\n\t\tstate.sessions = [...state.sessions];\n\t},\n\n\tfailNode(sessionId: string, nodeId: string, error: string): void {\n\t\tconst session = state.sessions.find((s) => s.id === sessionId);\n\t\tif (!session) return;\n\n\t\tconst node = session.workflow.nodes.find((n) => n.nodeId === nodeId);\n\t\tif (!node) return;\n\n\t\tnode.status = 'failed';\n\t\tnode.completedAt = new Date();\n\t\tnode.error = error;\n\n\t\t// Mark workflow as partial failure\n\t\tsession.workflow.status = WorkflowStatus.PARTIAL;\n\n\t\t// Trigger reactivity\n\t\tstate.sessions = [...state.sessions];\n\t},\n\n\tcompleteSession(sessionId: string): void {\n\t\tconst session = state.sessions.find((s) => s.id === sessionId);\n\t\tif (!session) return;\n\n\t\tsession.status = SessionStatus.COMPLETED;\n\t\tsession.completedAt = new Date();\n\t\tsession.workflow.status = WorkflowStatus.COMPLETED;\n\t\tsession.workflow.completedAt = new Date();\n\n\t\tstate.isCoordinating = false;\n\n\t\t// Trigger reactivity\n\t\tstate.sessions = [...state.sessions];\n\t},\n\n\tfailSession(sessionId: string, error: string): void {\n\t\tconst session = state.sessions.find((s) => s.id === sessionId);\n\t\tif (!session) return;\n\n\t\tsession.status = SessionStatus.FAILED;\n\t\tsession.completedAt = new Date();\n\t\tsession.error = error;\n\t\tsession.workflow.status = WorkflowStatus.FAILED;\n\t\tsession.workflow.error = error;\n\t\tsession.workflow.completedAt = new Date();\n\n\t\tstate.isCoordinating = false;\n\n\t\t// Trigger reactivity\n\t\tstate.sessions = [...state.sessions];\n\t},\n\n\tcancelSession(sessionId: string): void {\n\t\tconst session = state.sessions.find((s) => s.id === sessionId);\n\t\tif (!session) return;\n\n\t\tsession.status = SessionStatus.CANCELLED;\n\t\tsession.completedAt = new Date();\n\t\tsession.workflow.status = WorkflowStatus.FAILED;\n\t\tsession.workflow.error = 'Workflow cancelled by user';\n\t\tsession.workflow.completedAt = new Date();\n\n\t\tif (state.currentSession?.id === sessionId) {\n\t\t\tstate.isCoordinating = false;\n\t\t}\n\n\t\t// Trigger reactivity\n\t\tstate.sessions = [...state.sessions];\n\t},\n\n\tsetCurrentSession(sessionId: string | null): void {\n\t\tif (sessionId === null) {\n\t\t\tstate.currentSession = null;\n\t\t\treturn;\n\t\t}\n\n\t\tconst session = state.sessions.find((s) => s.id === sessionId);\n\t\tif (session) {\n\t\t\tstate.currentSession = session;\n\t\t}\n\t},\n\n\tdeleteSession(sessionId: string): void {\n\t\tstate.sessions = state.sessions.filter((s) => s.id !== sessionId);\n\n\t\tif (state.currentSession?.id === sessionId) {\n\t\t\tstate.currentSession = null;\n\t\t\tstate.isCoordinating = false;\n\t\t}\n\t},\n\n\tclearAll(): void {\n\t\tstate.sessions = [];\n\t\tstate.currentSession = null;\n\t\tstate.isCoordinating = false;\n\t}\n};\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// Helper Functions\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\nfunction generateSessionId(): string {\n\treturn `coordination_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n}\n","/**\n * Coordinator Service\n *\n * Business logic for coordinator agent operations\n */\n\nimport { coordinatorStore } from '$lib/stores/coordinator.svelte';\nimport { streamingService } from './streaming';\nimport type {\n\tWorkflowRequest,\n\tWorkflowExecution,\n\tAgentNode,\n\tDependencyEdge\n} from '$lib/types/agents';\nimport { createValidationError, classifyError, type AppError } from '$lib/utils/errors';\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// Configuration\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\nconst API_BASE_URL = import.meta.env.VITE_FORGE_AGENTS_URL || 'http://localhost:8787';\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// Validation Functions\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\nexport function validateWorkflowRequest(request: WorkflowRequest): AppError | null {\n\t// Validate task description\n\tif (!request.task || request.task.trim().length === 0) {\n\t\treturn createValidationError('Task description is required');\n\t}\n\n\t// Validate agent nodes\n\tif (!request.agents || request.agents.length === 0) {\n\t\treturn createValidationError('At least one agent node is required');\n\t}\n\n\t// Validate agent types\n\tconst validTypes = ['planning', 'execution', 'evaluation'];\n\tfor (const agent of request.agents) {\n\t\tif (!validTypes.includes(agent.type)) {\n\t\t\treturn createValidationError(`Invalid agent type: ${agent.type}`);\n\t\t}\n\t}\n\n\t// Validate dependencies don't create cycles\n\tconst hasCycle = detectCycle(request.agents, request.dependencies || []);\n\tif (hasCycle) {\n\t\treturn createValidationError('Workflow contains circular dependencies');\n\t}\n\n\treturn null;\n}\n\nfunction detectCycle(nodes: AgentNode[], edges: DependencyEdge[]): boolean {\n\tconst graph = new Map<string, Set<string>>();\n\n\t// Build adjacency list\n\tnodes.forEach(node => graph.set(node.id, new Set()));\n\tedges.forEach(edge => {\n\t\tconst deps = graph.get(edge.from);\n\t\tif (deps) deps.add(edge.to);\n\t});\n\n\tconst visited = new Set<string>();\n\tconst recStack = new Set<string>();\n\n\tfunction hasCycleUtil(nodeId: string): boolean {\n\t\tif (recStack.has(nodeId)) return true;\n\t\tif (visited.has(nodeId)) return false;\n\n\t\tvisited.add(nodeId);\n\t\trecStack.add(nodeId);\n\n\t\tconst neighbors = graph.get(nodeId);\n\t\tif (neighbors) {\n\t\t\tfor (const neighbor of neighbors) {\n\t\t\t\tif (hasCycleUtil(neighbor)) return true;\n\t\t\t}\n\t\t}\n\n\t\trecStack.delete(nodeId);\n\t\treturn false;\n\t}\n\n\tfor (const nodeId of graph.keys()) {\n\t\tif (hasCycleUtil(nodeId)) return true;\n\t}\n\n\treturn false;\n}\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// Workflow Session Management\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\nexport async function startWorkflowSession(\n\trequest: WorkflowRequest\n): Promise<{ success: boolean; sessionId?: string; error?: AppError }> {\n\t// Validate request\n\tconst validationError = validateWorkflowRequest(request);\n\tif (validationError) {\n\t\treturn { success: false, error: validationError };\n\t}\n\n\ttry {\n\t\t// Create new coordinator session\n\t\tconst session = coordinatorStore.createSession(request);\n\n\t\t// Start the session\n\t\tcoordinatorStore.startSession(session.id);\n\n\t\t// Subscribe to SSE stream\n\t\tconst streamUrl = `${API_BASE_URL}/api/v1/bds/workflow/${session.id}/stream`;\n\n\t\tstreamingService.subscribe(streamUrl, {\n\t\t\tonChunk: (content: string) => {\n\t\t\t\tcoordinatorStore.appendStreamingOutput(content);\n\t\t\t},\n\t\t\tonStageStart: (agentId: string) => {\n\t\t\t\tcoordinatorStore.updateAgentStatus(session.id, agentId, 'running');\n\t\t\t},\n\t\t\tonStageEnd: (agentId: string, output: unknown) => {\n\t\t\t\tcoordinatorStore.updateAgentStatus(session.id, agentId, 'completed');\n\t\t\t\tcoordinatorStore.updateAgentOutput(session.id, agentId, output as Record<string, unknown>);\n\t\t\t},\n\t\t\tonComplete: (result: unknown) => {\n\t\t\t\tconst workflow = result as WorkflowExecution;\n\t\t\t\tcoordinatorStore.completeSession(session.id, workflow);\n\t\t\t},\n\t\t\tonError: (error: AppError) => {\n\t\t\t\tcoordinatorStore.failSession(session.id, error.message);\n\t\t\t}\n\t\t});\n\n\t\treturn { success: true, sessionId: session.id };\n\t} catch (error) {\n\t\tconst appError = classifyError(error);\n\t\treturn { success: false, error: appError };\n\t}\n}\n\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n// Formatting Utilities\n// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\nexport function getAgentTypeIcon(type: string): string {\n\tswitch (type) {\n\t\tcase 'planning':\n\t\t\treturn 'ğŸ“';\n\t\tcase 'execution':\n\t\t\treturn 'âš¡';\n\t\tcase 'evaluation':\n\t\t\treturn 'âœ“';\n\t\tdefault:\n\t\t\treturn 'ğŸ¤–';\n\t}\n}\n\nexport function getAgentStatusColor(status: string): 'success' | 'warning' | 'danger' | 'neutral' {\n\tswitch (status) {\n\t\tcase 'completed':\n\t\t\treturn 'success';\n\t\tcase 'running':\n\t\t\treturn 'warning';\n\t\tcase 'failed':\n\t\t\treturn 'danger';\n\t\tdefault:\n\t\t\treturn 'neutral';\n\t}\n}\n\nexport function calculateWorkflowProgress(workflow: WorkflowExecution): number {\n\tconst total = workflow.agent_states.length;\n\tif (total === 0) return 0;\n\n\tconst completed = workflow.agent_states.filter(s => s.status === 'completed').length;\n\treturn (completed / total) * 100;\n}\n","<script lang=\"ts\">\n\timport Button from '$lib/components/Button.svelte';\n\timport Alert from '$lib/components/Alert.svelte';\n\timport Badge from '$lib/components/Badge.svelte';\n\timport { startWorkflowSession, getAgentTypeIcon } from '$lib/services/coordinatorService';\n\timport type { AgentNode, DependencyEdge } from '$lib/types/agents';\n\n\t// Form state\n\tlet taskDescription = $state('');\n\tlet selectedAgents = $state<Set<string>>(new Set(['planning', 'execution', 'evaluation']));\n\tlet parallelExecution = $state(false);\n\tlet retryFailures = $state(true);\n\tlet maxRetries = $state(3);\n\n\t// Error state\n\tlet error = $state<string | null>(null);\n\tlet isSubmitting = $state(false);\n\n\tconst availableAgents = [\n\t\t{ type: 'planning', label: 'Planning Agent', icon: 'ğŸ“', description: 'Define task strategy' },\n\t\t{ type: 'execution', label: 'Execution Agent', icon: 'âš¡', description: 'Generate code' },\n\t\t{ type: 'evaluation', label: 'Evaluator Agent', icon: 'âœ“', description: 'Assess quality' }\n\t];\n\n\tfunction toggleAgent(type: string): void {\n\t\tif (selectedAgents.has(type)) {\n\t\t\tselectedAgents.delete(type);\n\t\t} else {\n\t\t\tselectedAgents.add(type);\n\t\t}\n\t\tselectedAgents = new Set(selectedAgents);\n\t}\n\n\tasync function handleStartWorkflow(): Promise<void> {\n\t\tif (!taskDescription.trim()) {\n\t\t\terror = 'Task description is required';\n\t\t\treturn;\n\t\t}\n\n\t\tif (selectedAgents.size === 0) {\n\t\t\terror = 'Select at least one agent';\n\t\t\treturn;\n\t\t}\n\n\t\terror = null;\n\t\tisSubmitting = true;\n\n\t\ttry {\n\t\t\t// Build agent nodes\n\t\t\tconst agents: AgentNode[] = Array.from(selectedAgents).map((type, index) => ({\n\t\t\t\tid: `${type}_${index}`,\n\t\t\t\ttype,\n\t\t\t\tstatus: 'pending'\n\t\t\t}));\n\n\t\t\t// Build dependencies (linear workflow)\n\t\t\tconst dependencies: DependencyEdge[] = [];\n\t\t\tconst agentOrder = ['planning', 'execution', 'evaluation'];\n\t\t\tconst orderedAgents = agents.sort(\n\t\t\t\t(a, b) => agentOrder.indexOf(a.type) - agentOrder.indexOf(b.type)\n\t\t\t);\n\n\t\t\tfor (let i = 1; i < orderedAgents.length; i++) {\n\t\t\t\tdependencies.push({\n\t\t\t\t\tfrom: orderedAgents[i - 1].id,\n\t\t\t\t\tto: orderedAgents[i].id\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst result = await startWorkflowSession({\n\t\t\t\ttask: taskDescription,\n\t\t\t\tagents,\n\t\t\t\tdependencies,\n\t\t\t\toptions: {\n\t\t\t\t\tparallel_execution: parallelExecution,\n\t\t\t\t\tretry_on_failure: retryFailures,\n\t\t\t\t\tmax_retries: maxRetries\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (!result.success) {\n\t\t\t\terror = result.error?.message || 'Failed to start workflow';\n\t\t\t}\n\t\t} catch (err) {\n\t\t\terror = err instanceof Error ? err.message : 'An unknown error occurred';\n\t\t} finally {\n\t\t\tisSubmitting = false;\n\t\t}\n\t}\n</script>\n\n<div class=\"workflow-request\">\n\t<div class=\"form-section\">\n\t\t<label class=\"form-label\" for=\"task\">\n\t\t\tTask Description\n\t\t</label>\n\t\t<textarea\n\t\t\tid=\"task\"\n\t\t\tbind:value={taskDescription}\n\t\t\tplaceholder=\"Describe the multi-step task to be executed by the agent workflow...\"\n\t\t\trows=\"4\"\n\t\t></textarea>\n\t</div>\n\n\t<div class=\"form-section\">\n\t\t<label class=\"form-label\">Agent Pipeline</label>\n\t\t<p class=\"text-muted\">Select agents to include in the workflow</p>\n\n\t\t<div class=\"agents-grid\">\n\t\t\t{#each availableAgents as agent}\n\t\t\t\t<label class=\"agent-card\" class:selected={selectedAgents.has(agent.type)}>\n\t\t\t\t\t<input\n\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\tchecked={selectedAgents.has(agent.type)}\n\t\t\t\t\t\tonchange={() => toggleAgent(agent.type)}\n\t\t\t\t\t/>\n\t\t\t\t\t<div class=\"agent-content\">\n\t\t\t\t\t\t<div class=\"agent-header\">\n\t\t\t\t\t\t\t<span class=\"agent-icon\">{agent.icon}</span>\n\t\t\t\t\t\t\t<span class=\"agent-label\">{agent.label}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"agent-description\">{agent.description}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</label>\n\t\t\t{/each}\n\t\t</div>\n\t</div>\n\n\t<div class=\"form-section\">\n\t\t<label class=\"form-label\">Workflow Options</label>\n\n\t\t<div class=\"options-list\">\n\t\t\t<label class=\"option\">\n\t\t\t\t<input type=\"checkbox\" bind:checked={retryFailures} />\n\t\t\t\t<div class=\"option-content\">\n\t\t\t\t\t<span class=\"option-title\">Retry on Failure</span>\n\t\t\t\t\t<span class=\"option-description\">Automatically retry failed agents</span>\n\t\t\t\t</div>\n\t\t\t</label>\n\n\t\t\t{#if retryFailures}\n\t\t\t\t<div class=\"option-detail\">\n\t\t\t\t\t<label for=\"maxRetries\">Max Retries:</label>\n\t\t\t\t\t<input\n\t\t\t\t\t\ttype=\"number\"\n\t\t\t\t\t\tid=\"maxRetries\"\n\t\t\t\t\t\tbind:value={maxRetries}\n\t\t\t\t\t\tmin=\"1\"\n\t\t\t\t\t\tmax=\"10\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t{/if}\n\t\t</div>\n\t</div>\n\n\t{#if error}\n\t\t<Alert variant=\"error\">{error}</Alert>\n\t{/if}\n\n\t<Button\n\t\tonclick={handleStartWorkflow}\n\t\tdisabled={isSubmitting || selectedAgents.size === 0}\n\t\tfullWidth\n\t>\n\t\t{isSubmitting ? 'Starting Workflow...' : 'Start Workflow'}\n\t</Button>\n</div>\n\n<style>\n\t.workflow-request {\n\t\tpadding: 1rem;\n\t}\n\n\t.form-section {\n\t\tmargin-bottom: 1.5rem;\n\t}\n\n\t.form-label {\n\t\tdisplay: block;\n\t\tfont-size: 0.875rem;\n\t\tfont-weight: 600;\n\t\tcolor: var(--text-primary);\n\t\tmargin-bottom: 0.5rem;\n\t}\n\n\t.text-muted {\n\t\tfont-size: 0.75rem;\n\t\tcolor: var(--text-secondary);\n\t\tmargin-bottom: 0.75rem;\n\t}\n\n\ttextarea {\n\t\twidth: 100%;\n\t\tpadding: 0.75rem;\n\t\tbackground: var(--surface-2);\n\t\tborder: 1px solid var(--border-color);\n\t\tborder-radius: 6px;\n\t\tcolor: var(--text-primary);\n\t\tfont-size: 0.875rem;\n\t\tline-height: 1.5;\n\t\tresize: vertical;\n\t\tfont-family: inherit;\n\t}\n\n\ttextarea:focus {\n\t\toutline: none;\n\t\tborder-color: var(--accent-color);\n\t}\n\n\t.agents-grid {\n\t\tdisplay: grid;\n\t\tgap: 0.75rem;\n\t}\n\n\t.agent-card {\n\t\tdisplay: flex;\n\t\talign-items: flex-start;\n\t\tgap: 0.75rem;\n\t\tpadding: 1rem;\n\t\tbackground: var(--surface-2);\n\t\tborder: 2px solid var(--border-color);\n\t\tborder-radius: 6px;\n\t\tcursor: pointer;\n\t\ttransition: all 0.2s ease;\n\t}\n\n\t.agent-card:hover {\n\t\tborder-color: var(--accent-color);\n\t\tbackground: var(--surface-3);\n\t}\n\n\t.agent-card.selected {\n\t\tborder-color: var(--accent-color);\n\t\tbackground: rgba(var(--accent-rgb), 0.05);\n\t}\n\n\t.agent-card input[type='checkbox'] {\n\t\tmargin-top: 2px;\n\t\twidth: 18px;\n\t\theight: 18px;\n\t\tcursor: pointer;\n\t}\n\n\t.agent-content {\n\t\tflex: 1;\n\t\tmin-width: 0;\n\t}\n\n\t.agent-header {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 0.5rem;\n\t\tmargin-bottom: 0.25rem;\n\t}\n\n\t.agent-icon {\n\t\tfont-size: 1.125rem;\n\t}\n\n\t.agent-label {\n\t\tfont-size: 0.875rem;\n\t\tfont-weight: 600;\n\t\tcolor: var(--text-primary);\n\t}\n\n\t.agent-description {\n\t\tfont-size: 0.75rem;\n\t\tcolor: var(--text-secondary);\n\t\tline-height: 1.4;\n\t}\n\n\t.options-list {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 0.75rem;\n\t}\n\n\t.option {\n\t\tdisplay: flex;\n\t\talign-items: flex-start;\n\t\tgap: 0.75rem;\n\t\tpadding: 0.75rem;\n\t\tbackground: var(--surface-2);\n\t\tborder: 1px solid var(--border-color);\n\t\tborder-radius: 6px;\n\t\tcursor: pointer;\n\t}\n\n\t.option input[type='checkbox'] {\n\t\tmargin-top: 2px;\n\t\twidth: 18px;\n\t\theight: 18px;\n\t\tcursor: pointer;\n\t}\n\n\t.option-content {\n\t\tflex: 1;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 0.25rem;\n\t}\n\n\t.option-title {\n\t\tfont-size: 0.875rem;\n\t\tfont-weight: 500;\n\t\tcolor: var(--text-primary);\n\t}\n\n\t.option-description {\n\t\tfont-size: 0.75rem;\n\t\tcolor: var(--text-secondary);\n\t}\n\n\t.option-detail {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 0.75rem;\n\t\tpadding-left: 2.5rem;\n\t\tfont-size: 0.875rem;\n\t\tcolor: var(--text-primary);\n\t}\n\n\t.option-detail input[type='number'] {\n\t\twidth: 80px;\n\t\tpadding: 0.375rem 0.5rem;\n\t\tbackground: var(--surface-2);\n\t\tborder: 1px solid var(--border-color);\n\t\tborder-radius: 4px;\n\t\tcolor: var(--text-primary);\n\t\tfont-size: 0.875rem;\n\t}\n\n\t@media (max-width: 768px) {\n\t\t.agents-grid {\n\t\t\tgrid-template-columns: 1fr;\n\t\t}\n\t}\n</style>\n","<script lang=\"ts\">\n\timport Badge from '$lib/components/Badge.svelte';\n\timport { getAgentTypeIcon, getAgentStatusColor } from '$lib/services/coordinatorService';\n\timport type { WorkflowExecution, AgentState } from '$lib/types/agents';\n\n\tinterface Props {\n\t\tworkflow: WorkflowExecution | null;\n\t}\n\n\tlet { workflow }: Props = $props();\n\n\tfunction getStatusIcon(status: string): string {\n\t\tswitch (status) {\n\t\t\tcase 'completed':\n\t\t\t\treturn 'âœ…';\n\t\t\tcase 'running':\n\t\t\t\treturn 'â³';\n\t\t\tcase 'failed':\n\t\t\t\treturn 'âŒ';\n\t\t\tcase 'pending':\n\t\t\t\treturn 'â¸ï¸';\n\t\t\tdefault:\n\t\t\t\treturn 'âšª';\n\t\t}\n\t}\n</script>\n\n<div class=\"workflow-visualization\">\n\t{#if workflow && workflow.agent_states}\n\t\t<div class=\"workflow-pipeline\">\n\t\t\t{#each workflow.agent_states as agentState, index}\n\t\t\t\t<div class=\"pipeline-step\">\n\t\t\t\t\t<div class=\"agent-node\" class:active={agentState.status === 'running'} class:completed={agentState.status === 'completed'} class:failed={agentState.status === 'failed'}>\n\t\t\t\t\t\t<div class=\"node-icon\">\n\t\t\t\t\t\t\t{getAgentTypeIcon(agentState.agent_id.split('_')[0])}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"node-content\">\n\t\t\t\t\t\t\t<div class=\"node-title\">{agentState.agent_id}</div>\n\t\t\t\t\t\t\t<Badge variant={getAgentStatusColor(agentState.status)}>\n\t\t\t\t\t\t\t\t{getStatusIcon(agentState.status)} {agentState.status}\n\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{#if index < workflow.agent_states.length - 1}\n\t\t\t\t\t\t<div class=\"pipeline-arrow\">\n\t\t\t\t\t\t\t<svg width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n\t\t\t\t\t\t\t\t<path d=\"M12 4l-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z\"/>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\t\t\t\t</div>\n\t\t\t{/each}\n\t\t</div>\n\n\t\t{#if workflow.current_agent}\n\t\t\t<div class=\"current-agent-info\">\n\t\t\t\t<div class=\"info-label\">Currently Executing:</div>\n\t\t\t\t<div class=\"info-value\">{workflow.current_agent}</div>\n\t\t\t</div>\n\t\t{/if}\n\t{:else}\n\t\t<div class=\"empty-state\">\n\t\t\t<p class=\"text-muted\">No workflow visualization available</p>\n\t\t</div>\n\t{/if}\n</div>\n\n<style>\n\t.workflow-visualization {\n\t\tpadding: 1rem;\n\t}\n\n\t.workflow-pipeline {\n\t\tdisplay: flex;\n\t\tflex-wrap: wrap;\n\t\tgap: 1rem;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tmargin-bottom: 1.5rem;\n\t}\n\n\t.pipeline-step {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 0.5rem;\n\t}\n\n\t.agent-node {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 0.75rem;\n\t\tpadding: 1rem;\n\t\tbackground: var(--surface-2);\n\t\tborder: 2px solid var(--border-color);\n\t\tborder-radius: 8px;\n\t\tmin-width: 200px;\n\t\ttransition: all 0.3s ease;\n\t}\n\n\t.agent-node.active {\n\t\tborder-color: var(--accent-color);\n\t\tbackground: rgba(var(--accent-rgb), 0.1);\n\t\tbox-shadow: 0 0 0 4px rgba(var(--accent-rgb), 0.1);\n\t}\n\n\t.agent-node.completed {\n\t\tborder-color: var(--color-success);\n\t\tbackground: rgba(34, 197, 94, 0.05);\n\t}\n\n\t.agent-node.failed {\n\t\tborder-color: var(--color-danger);\n\t\tbackground: rgba(239, 68, 68, 0.05);\n\t}\n\n\t.node-icon {\n\t\tfont-size: 1.5rem;\n\t}\n\n\t.node-content {\n\t\tflex: 1;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 0.5rem;\n\t}\n\n\t.node-title {\n\t\tfont-size: 0.875rem;\n\t\tfont-weight: 600;\n\t\tcolor: var(--text-primary);\n\t}\n\n\t.pipeline-arrow {\n\t\tcolor: var(--text-secondary);\n\t}\n\n\t.current-agent-info {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 0.75rem;\n\t\tpadding: 0.75rem 1rem;\n\t\tbackground: var(--surface-2);\n\t\tborder: 1px solid var(--border-color);\n\t\tborder-radius: 6px;\n\t}\n\n\t.info-label {\n\t\tfont-size: 0.8125rem;\n\t\tcolor: var(--text-secondary);\n\t}\n\n\t.info-value {\n\t\tfont-size: 0.875rem;\n\t\tfont-weight: 600;\n\t\tcolor: var(--text-primary);\n\t}\n\n\t.empty-state {\n\t\ttext-align: center;\n\t\tpadding: 2rem 1rem;\n\t}\n\n\t.text-muted {\n\t\tcolor: var(--text-secondary);\n\t}\n\n\t@media (max-width: 768px) {\n\t\t.workflow-pipeline {\n\t\t\tflex-direction: column;\n\t\t}\n\n\t\t.pipeline-arrow {\n\t\t\ttransform: rotate(90deg);\n\t\t}\n\t}\n</style>\n","<script lang=\"ts\">\n\timport { coordinatorStore } from '$lib/stores/coordinator.svelte';\n\timport ErrorBoundary from '$lib/components/ErrorBoundary.svelte';\n\timport Panel from '$lib/components/Panel.svelte';\n\timport { SessionStatus } from '$lib/types/agents';\n\timport WorkflowRequest from '$lib/components/panels/coordinator/WorkflowRequest.svelte';\n\timport WorkflowVisualization from '$lib/components/panels/coordinator/WorkflowVisualization.svelte';\n\timport WorkflowHistory from '$lib/components/panels/coordinator/WorkflowHistory.svelte';\n\timport { calculateWorkflowProgress } from '$lib/services/coordinatorService';\n\n\tconst currentSession = $derived(coordinatorStore.currentSession);\n\tconst isRunning = $derived(coordinatorStore.isRunning);\n</script>\n\n<ErrorBoundary>\n\t<div class=\"coordinator-page\">\n\t\t<header class=\"page-header\">\n\t\t\t<h1>Coordinator Agent</h1>\n\t\t\t<p class=\"text-muted\">Orchestrate multi-agent workflows</p>\n\t\t</header>\n\n\t\t<div class=\"content-grid\">\n\t\t\t<div class=\"left-column\">\n\t\t\t\t<Panel title=\"New Workflow\">\n\t\t\t\t\t<WorkflowRequest />\n\t\t\t\t</Panel>\n\n\t\t\t\t{#if currentSession}\n\t\t\t\t\t<Panel title=\"Workflow History\" class=\"mt-6\">\n\t\t\t\t\t\t<WorkflowHistory />\n\t\t\t\t\t</Panel>\n\t\t\t\t{/if}\n\t\t\t</div>\n\n\t\t\t<div class=\"right-column\">\n\t\t\t\t{#if currentSession}\n\t\t\t\t\t{#if currentSession.status === SessionStatus.RUNNING}\n\t\t\t\t\t\t<Panel title=\"Workflow Executing\">\n\t\t\t\t\t\t\t{#if currentSession.workflow}\n\t\t\t\t\t\t\t\t<WorkflowVisualization workflow={currentSession.workflow} />\n\t\t\t\t\t\t\t\t<div class=\"workflow-progress\">\n\t\t\t\t\t\t\t\t\t<div class=\"progress-label\">Overall Progress</div>\n\t\t\t\t\t\t\t\t\t<div class=\"progress-bar\">\n\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\tclass=\"progress-bar-fill\"\n\t\t\t\t\t\t\t\t\t\t\tstyle=\"width: {calculateWorkflowProgress(currentSession.workflow)}%\"\n\t\t\t\t\t\t\t\t\t\t></div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div class=\"progress-percent\">\n\t\t\t\t\t\t\t\t\t\t{calculateWorkflowProgress(currentSession.workflow).toFixed(0)}%\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t\t<div class=\"progress-message\">\n\t\t\t\t\t\t\t\t\t<div class=\"spinner\"></div>\n\t\t\t\t\t\t\t\t\t<p>Initializing workflow...</p>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t</Panel>\n\t\t\t\t\t{:else if currentSession.status === SessionStatus.COMPLETED && currentSession.workflow}\n\t\t\t\t\t\t<Panel title=\"Workflow Completed\">\n\t\t\t\t\t\t\t<div class=\"success-state\">\n\t\t\t\t\t\t\t\t<svg width=\"64\" height=\"64\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\">\n\t\t\t\t\t\t\t\t\t<path d=\"M22 11.08V12a10 10 0 1 1-5.93-9.14\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\n\t\t\t\t\t\t\t\t\t<polyline points=\"22 4 12 14.01 9 11.01\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\n\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t<h3>Workflow Executed Successfully</h3>\n\t\t\t\t\t\t\t\t<p>All agents have completed their tasks.</p>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div class=\"workflow-results\">\n\t\t\t\t\t\t\t\t<WorkflowVisualization workflow={currentSession.workflow} />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</Panel>\n\t\t\t\t\t{:else if currentSession.status === SessionStatus.FAILED}\n\t\t\t\t\t\t<Panel title=\"Workflow Failed\">\n\t\t\t\t\t\t\t<div class=\"error-state\">\n\t\t\t\t\t\t\t\t<svg width=\"48\" height=\"48\" viewBox=\"0 0 16 16\" fill=\"currentColor\">\n\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\td=\"M8 0a8 8 0 1 0 0 16A8 8 0 0 0 8 0zM7 4h2v5H7V4zm0 6h2v2H7v-2z\"\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t<h3>Workflow Failed</h3>\n\t\t\t\t\t\t\t\t{#if currentSession.error}\n\t\t\t\t\t\t\t\t\t<p class=\"error-message\">{currentSession.error}</p>\n\t\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t{#if currentSession.workflow}\n\t\t\t\t\t\t\t\t<div class=\"workflow-results\">\n\t\t\t\t\t\t\t\t\t<WorkflowVisualization workflow={currentSession.workflow} />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t</Panel>\n\t\t\t\t\t{/if}\n\t\t\t\t{:else}\n\t\t\t\t\t<Panel title=\"Welcome\">\n\t\t\t\t\t\t<div class=\"empty-state\">\n\t\t\t\t\t\t\t<div class=\"empty-icon\">ğŸ¯</div>\n\t\t\t\t\t\t\t<h2>Create a Workflow</h2>\n\t\t\t\t\t\t\t<p>Design and execute multi-agent coordination workflows to handle complex tasks.</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</Panel>\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</ErrorBoundary>\n\n<style>\n\t.coordinator-page {\n\t\tpadding: 24px;\n\t\tmax-width: 1400px;\n\t\tmargin: 0 auto;\n\t}\n\n\t.page-header {\n\t\tmargin-bottom: 24px;\n\t}\n\n\t.page-header h1 {\n\t\tfont-family: 'Cinzel', serif;\n\t\tfont-weight: 300;\n\t\tfont-size: 2rem;\n\t\tcolor: var(--color-text);\n\t\tmargin-bottom: 8px;\n\t}\n\n\t.text-muted {\n\t\tcolor: var(--color-text-muted);\n\t\tfont-size: 0.875rem;\n\t}\n\n\t.content-grid {\n\t\tdisplay: grid;\n\t\tgrid-template-columns: 450px 1fr;\n\t\tgap: 24px;\n\t\talign-items: start;\n\t}\n\n\t.left-column,\n\t.right-column {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 24px;\n\t}\n\n\t:global(.mt-6) {\n\t\tmargin-top: 24px;\n\t}\n\n\t.workflow-progress {\n\t\tpadding: 1rem;\n\t\tbackground: var(--surface-2);\n\t\tborder: 1px solid var(--border-color);\n\t\tborder-radius: 8px;\n\t\tmargin-top: 1.5rem;\n\t}\n\n\t.progress-label {\n\t\tfont-size: 0.875rem;\n\t\tfont-weight: 600;\n\t\tcolor: var(--text-primary);\n\t\tmargin-bottom: 0.75rem;\n\t}\n\n\t.progress-bar {\n\t\theight: 12px;\n\t\tbackground: var(--surface-1);\n\t\tborder-radius: 6px;\n\t\toverflow: hidden;\n\t\tmargin-bottom: 0.5rem;\n\t}\n\n\t.progress-bar-fill {\n\t\theight: 100%;\n\t\tbackground: linear-gradient(90deg, var(--accent-color), #10b981);\n\t\tborder-radius: 6px;\n\t\ttransition: width 0.5s ease;\n\t}\n\n\t.progress-percent {\n\t\tfont-size: 1.25rem;\n\t\tfont-weight: 700;\n\t\tcolor: var(--text-primary);\n\t\ttext-align: center;\n\t}\n\n\t.progress-message {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tpadding: 48px 24px;\n\t\ttext-align: center;\n\t}\n\n\t.spinner {\n\t\twidth: 40px;\n\t\theight: 40px;\n\t\tborder: 3px solid var(--border-color);\n\t\tborder-top-color: var(--accent-color);\n\t\tborder-radius: 50%;\n\t\tanimation: spin 1s linear infinite;\n\t\tmargin-bottom: 16px;\n\t}\n\n\t@keyframes spin {\n\t\tto {\n\t\t\ttransform: rotate(360deg);\n\t\t}\n\t}\n\n\t.progress-message p {\n\t\tcolor: var(--text-secondary);\n\t\tfont-size: 0.875rem;\n\t}\n\n\t.success-state,\n\t.error-state {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tpadding: 48px 24px;\n\t\ttext-align: center;\n\t}\n\n\t.success-state svg {\n\t\tcolor: var(--color-success);\n\t\tmargin-bottom: 16px;\n\t}\n\n\t.success-state h3 {\n\t\tfont-size: 1.25rem;\n\t\tcolor: var(--text-primary);\n\t\tmargin-bottom: 8px;\n\t}\n\n\t.success-state p {\n\t\tfont-size: 0.875rem;\n\t\tcolor: var(--text-secondary);\n\t\tmargin: 0;\n\t}\n\n\t.error-state svg {\n\t\tcolor: var(--color-danger);\n\t\tmargin-bottom: 16px;\n\t}\n\n\t.error-state h3 {\n\t\tfont-size: 1.25rem;\n\t\tcolor: var(--text-primary);\n\t\tmargin-bottom: 12px;\n\t}\n\n\t.error-message {\n\t\tcolor: var(--color-danger);\n\t\tfont-size: 0.875rem;\n\t\tpadding: 12px 16px;\n\t\tbackground: rgba(239, 68, 68, 0.1);\n\t\tborder: 1px solid rgba(239, 68, 68, 0.3);\n\t\tborder-radius: 6px;\n\t\tmax-width: 500px;\n\t}\n\n\t.workflow-results {\n\t\tmargin-top: 1.5rem;\n\t\tpadding: 1rem;\n\t\tbackground: var(--surface-2);\n\t\tborder: 1px solid var(--border-color);\n\t\tborder-radius: 8px;\n\t}\n\n\t.empty-state {\n\t\ttext-align: center;\n\t\tpadding: 48px 24px;\n\t}\n\n\t.empty-icon {\n\t\tfont-size: 4rem;\n\t\tmargin-bottom: 16px;\n\t}\n\n\t.empty-state h2 {\n\t\tfont-size: 1.5rem;\n\t\tcolor: var(--color-text);\n\t\tmargin-bottom: 12px;\n\t}\n\n\t.empty-state p {\n\t\tcolor: var(--color-text-muted);\n\t\tfont-size: 0.875rem;\n\t\tmax-width: 400px;\n\t\tmargin: 0 auto;\n\t}\n\n\t@media (max-width: 1024px) {\n\t\t.content-grid {\n\t\t\tgrid-template-columns: 1fr;\n\t\t}\n\t}\n</style>\n","<script lang=\"ts\">\n\timport Badge from '$lib/components/Badge.svelte';\n\timport Button from '$lib/components/Button.svelte';\n\timport { coordinatorStore } from '$lib/stores/coordinator.svelte';\n\timport { SessionStatus } from '$lib/types/agents';\n\timport { calculateWorkflowProgress } from '$lib/services/coordinatorService';\n\n\tconst sessions = $derived(coordinatorStore.sessions);\n\n\tfunction formatDate(date: Date): string {\n\t\treturn new Intl.DateTimeFormat('en-US', {\n\t\t\tmonth: 'short',\n\t\t\tday: 'numeric',\n\t\t\thour: '2-digit',\n\t\t\tminute: '2-digit'\n\t\t}).format(date);\n\t}\n\n\tfunction getStatusBadgeVariant(status: SessionStatus): 'success' | 'warning' | 'danger' | 'neutral' {\n\t\tswitch (status) {\n\t\t\tcase SessionStatus.COMPLETED:\n\t\t\t\treturn 'success';\n\t\t\tcase SessionStatus.RUNNING:\n\t\t\t\treturn 'warning';\n\t\t\tcase SessionStatus.FAILED:\n\t\t\tcase SessionStatus.CANCELLED:\n\t\t\t\treturn 'danger';\n\t\t\tdefault:\n\t\t\t\treturn 'neutral';\n\t\t}\n\t}\n\n\tfunction getStatusIcon(status: SessionStatus): string {\n\t\tswitch (status) {\n\t\t\tcase SessionStatus.COMPLETED:\n\t\t\t\treturn 'âœ…';\n\t\t\tcase SessionStatus.RUNNING:\n\t\t\t\treturn 'â³';\n\t\t\tcase SessionStatus.FAILED:\n\t\t\t\treturn 'âŒ';\n\t\t\tcase SessionStatus.CANCELLED:\n\t\t\t\treturn 'ğŸš«';\n\t\t\tdefault:\n\t\t\t\treturn 'â¸ï¸';\n\t\t}\n\t}\n\n\tfunction selectSession(sessionId: string): void {\n\t\tcoordinatorStore.setCurrentSession(sessionId);\n\t}\n\n\tfunction deleteSession(sessionId: string): void {\n\t\tif (confirm('Are you sure you want to delete this workflow session?')) {\n\t\t\tcoordinatorStore.deleteSession(sessionId);\n\t\t}\n\t}\n</script>\n\n<div class=\"workflow-history\">\n\t{#if sessions.length > 0}\n\t\t<div class=\"history-header\">\n\t\t\t<h3>Past Workflows ({sessions.length})</h3>\n\t\t\t<Button variant=\"ghost\" size=\"sm\" onclick={() => coordinatorStore.clearAll()}>\n\t\t\t\tClear All\n\t\t\t</Button>\n\t\t</div>\n\n\t\t<div class=\"sessions-list\">\n\t\t\t{#each sessions as session}\n\t\t\t\t{@const isActive = coordinatorStore.currentSession?.id === session.id}\n\t\t\t\t<div\n\t\t\t\t\tclass=\"session-card\"\n\t\t\t\t\tclass:active={isActive}\n\t\t\t\t\trole=\"button\"\n\t\t\t\t\ttabindex=\"0\"\n\t\t\t\t\tonclick={() => selectSession(session.id)}\n\t\t\t\t\tonkeydown={(e) => e.key === 'Enter' && selectSession(session.id)}\n\t\t\t\t>\n\t\t\t\t\t<div class=\"session-header\">\n\t\t\t\t\t\t<div class=\"session-info\">\n\t\t\t\t\t\t\t<span class=\"session-icon\">{getStatusIcon(session.status)}</span>\n\t\t\t\t\t\t\t<div class=\"session-title-group\">\n\t\t\t\t\t\t\t\t<div class=\"session-title\">\n\t\t\t\t\t\t\t\t\t{session.request.task || `Workflow #${session.id.split('_')[1]}`}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class=\"session-meta\">\n\t\t\t\t\t\t\t\t\t<span class=\"session-date\">{formatDate(session.createdAt)}</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<Badge variant={getStatusBadgeVariant(session.status)}>\n\t\t\t\t\t\t\t{session.status}\n\t\t\t\t\t\t</Badge>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{#if session.workflow}\n\t\t\t\t\t\t<div class=\"session-stats\">\n\t\t\t\t\t\t\t<div class=\"stat\">\n\t\t\t\t\t\t\t\t<span class=\"stat-icon\">ğŸ¤–</span>\n\t\t\t\t\t\t\t\t<span class=\"stat-value\">{session.workflow.agent_states.length}</span>\n\t\t\t\t\t\t\t\t<span class=\"stat-label\">agents</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"stat\">\n\t\t\t\t\t\t\t\t<span class=\"stat-icon\">ğŸ“Š</span>\n\t\t\t\t\t\t\t\t<span class=\"stat-value\">{calculateWorkflowProgress(session.workflow).toFixed(0)}%</span>\n\t\t\t\t\t\t\t\t<span class=\"stat-label\">progress</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\n\t\t\t\t\t{#if session.error}\n\t\t\t\t\t\t<div class=\"session-error\">\n\t\t\t\t\t\t\t<svg width=\"14\" height=\"14\" viewBox=\"0 0 16 16\" fill=\"currentColor\">\n\t\t\t\t\t\t\t\t<path d=\"M8 0a8 8 0 1 0 0 16A8 8 0 0 0 8 0zM7 4h2v5H7V4zm0 6h2v2H7v-2z\"/>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t<span>{session.error}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/if}\n\n\t\t\t\t\t<div class=\"session-actions\">\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\tonclick={(e: Event) => {\n\t\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t\tselectSession(session.id);\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tView Details\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\tonclick={(e: Event) => {\n\t\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t\tdeleteSession(session.id);\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tDelete\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t{/each}\n\t\t</div>\n\t{:else}\n\t\t<div class=\"empty-state\">\n\t\t\t<div class=\"empty-icon\">ğŸ“‹</div>\n\t\t\t<p class=\"empty-title\">No workflow history</p>\n\t\t\t<p class=\"empty-description\">\n\t\t\t\tStart a workflow to see your history here.\n\t\t\t</p>\n\t\t</div>\n\t{/if}\n</div>\n\n<style>\n\t.workflow-history {\n\t\tpadding: 1rem;\n\t}\n\n\t.history-header {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tmargin-bottom: 1rem;\n\t}\n\n\t.history-header h3 {\n\t\tfont-size: 1rem;\n\t\tfont-weight: 600;\n\t\tcolor: var(--text-primary);\n\t\tmargin: 0;\n\t}\n\n\t.sessions-list {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 0.75rem;\n\t}\n\n\t.session-card {\n\t\tpadding: 1rem;\n\t\tbackground: var(--surface-2);\n\t\tborder: 2px solid var(--border-color);\n\t\tborder-radius: 8px;\n\t\tcursor: pointer;\n\t\ttransition: all 0.2s ease;\n\t}\n\n\t.session-card:hover {\n\t\tborder-color: var(--accent-color);\n\t\tbox-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n\t}\n\n\t.session-card.active {\n\t\tborder-color: var(--accent-color);\n\t\tbackground: var(--surface-3);\n\t}\n\n\t.session-header {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: flex-start;\n\t\tgap: 1rem;\n\t\tmargin-bottom: 0.75rem;\n\t}\n\n\t.session-info {\n\t\tdisplay: flex;\n\t\talign-items: flex-start;\n\t\tgap: 0.75rem;\n\t\tflex: 1;\n\t\tmin-width: 0;\n\t}\n\n\t.session-icon {\n\t\tfont-size: 1.25rem;\n\t\tline-height: 1;\n\t}\n\n\t.session-title-group {\n\t\tflex: 1;\n\t\tmin-width: 0;\n\t}\n\n\t.session-title {\n\t\tfont-size: 0.9375rem;\n\t\tfont-weight: 500;\n\t\tcolor: var(--text-primary);\n\t\tmargin-bottom: 0.25rem;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t\twhite-space: nowrap;\n\t}\n\n\t.session-meta {\n\t\tdisplay: flex;\n\t\tgap: 0.75rem;\n\t\tfont-size: 0.75rem;\n\t\tcolor: var(--text-secondary);\n\t}\n\n\t.session-stats {\n\t\tdisplay: flex;\n\t\tgap: 1rem;\n\t\tmargin-bottom: 0.75rem;\n\t\tpadding: 0.5rem;\n\t\tbackground: var(--surface-1);\n\t\tborder-radius: 6px;\n\t}\n\n\t.stat {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 0.25rem;\n\t\tfont-size: 0.875rem;\n\t}\n\n\t.stat-icon {\n\t\tfont-size: 1rem;\n\t}\n\n\t.stat-value {\n\t\tfont-weight: 600;\n\t\tcolor: var(--text-primary);\n\t}\n\n\t.stat-label {\n\t\tcolor: var(--text-secondary);\n\t}\n\n\t.session-error {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 0.5rem;\n\t\tpadding: 0.5rem 0.75rem;\n\t\tbackground: rgba(239, 68, 68, 0.1);\n\t\tborder: 1px solid rgba(239, 68, 68, 0.3);\n\t\tborder-radius: 6px;\n\t\tcolor: var(--color-danger);\n\t\tfont-size: 0.875rem;\n\t\tmargin-bottom: 0.75rem;\n\t}\n\n\t.session-actions {\n\t\tdisplay: flex;\n\t\tgap: 0.5rem;\n\t\tpadding-top: 0.75rem;\n\t\tborder-top: 1px solid var(--border-color);\n\t}\n\n\t.empty-state {\n\t\ttext-align: center;\n\t\tpadding: 3rem 1rem;\n\t}\n\n\t.empty-icon {\n\t\tfont-size: 3rem;\n\t\tmargin-bottom: 1rem;\n\t}\n\n\t.empty-title {\n\t\tfont-size: 1rem;\n\t\tfont-weight: 600;\n\t\tcolor: var(--text-primary);\n\t\tmargin-bottom: 0.5rem;\n\t}\n\n\t.empty-description {\n\t\tfont-size: 0.875rem;\n\t\tcolor: var(--text-secondary);\n\t\tmargin: 0;\n\t}\n\n\t@media (max-width: 768px) {\n\t\t.session-stats {\n\t\t\tflex-wrap: wrap;\n\t\t\tgap: 0.5rem;\n\t\t}\n\n\t\t.session-actions {\n\t\t\tflex-direction: column;\n\t\t}\n\t}\n</style>\n"],"names":["state","sessions","currentSession","isCoordinating","coordinatorStore","activeSessions","filter","s","status","SessionStatus","RUNNING","PENDING","completedSessions","COMPLETED","failedSessions","FAILED","createSession","request","workflow","nodes","agents","map","agent","nodeId","id","progress","WorkflowStatus","session","Date","now","Math","random","toString","substr","type","createdAt","startSession","sessionId","find","startedAt","updateNodeExecution","updates","node","n","Object","assign","startNode","agentSessionId","updateNodeProgress","min","max","completeNode","completedAt","every","this","completeSession","failNode","error","PARTIAL","failSession","cancelSession","CANCELLED","setCurrentSession","deleteSession","clearAll","validateWorkflowRequest","task","trim","length","createValidationError","validTypes","includes","edges","graph","Map","forEach","set","Set","edge","deps","get","from","add","to","visited","recStack","hasCycleUtil","has","neighbors","neighbor","delete","keys","detectCycle","dependencies","getAgentTypeIcon","getAgentStatusColor","calculateWorkflowProgress","total","agent_states","selectedAgents","retryFailures","isSubmitting","label","icon","description","each_array","$$index","$.attr","$.escape","async","size","Array","index","agentOrder","orderedAgents","sort","a","b","indexOf","i","push","result","validationError","success","streamUrl","streamingService","subscribe","onChunk","content","appendStreamingOutput","onStageStart","agentId","updateAgentStatus","onStageEnd","output","updateAgentOutput","onComplete","onError","message","classifyError","startWorkflowSession","options","parallel_execution","retry_on_failure","max_retries","err","Error","disabled","$$props","getStatusIcon","$.ensure_array_like","agentState","agent_id","split","$$renderer","current_agent","formatDate","date","Intl","DateTimeFormat","month","day","hour","minute","format","getStatusBadgeVariant","onclick","isActive","toFixed","e","stopPropagation","confirm","WorkflowVisualization","$.attr_style","$.stringify"],"mappings":"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"}