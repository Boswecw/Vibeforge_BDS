{"version":3,"file":"_page.svelte.js","sources":["../../../../../../src/routes/settings/+page.svelte"],"sourcesContent":["<script lang=\"ts\">\n  import { onMount } from 'svelte';\n  import { tokenManager } from '$lib/api/auth';\n  import { forgeAgentsClient } from '$lib/api/forgeAgentsClient';\n  import { Panel, Input, Button, Alert, Badge, Select } from '$lib/components';\n\n  let apiBaseUrl = 'http://localhost:3000';\n  let apiTimeout = 30000;\n  let isAuthenticated = false;\n  let tokenExpiresAt: string | null = null;\n\n  // Login form\n  let showLoginForm = false;\n  let loginEmail = '';\n  let loginPassword = '';\n  let loginError = '';\n  let loginLoading = false;\n\n  // Settings state\n  let saveSuccess = false;\n  let saveError = '';\n\n  // Timeout options for select\n  const timeoutOptions = [\n    { value: 5000, label: '5 seconds' },\n    { value: 10000, label: '10 seconds' },\n    { value: 15000, label: '15 seconds' },\n    { value: 30000, label: '30 seconds' },\n    { value: 60000, label: '60 seconds' },\n    { value: 120000, label: '120 seconds' }\n  ];\n\n  onMount(async () => {\n    await tokenManager.initialize();\n    isAuthenticated = tokenManager.isAuthenticated();\n\n    // Load token expiry if authenticated\n    if (isAuthenticated) {\n      const expiresAt = localStorage.getItem('token_expires_at');\n      if (expiresAt) {\n        tokenExpiresAt = new Date(expiresAt).toLocaleString();\n      }\n    }\n\n    // Load saved settings from localStorage\n    const savedApiUrl = localStorage.getItem('api_base_url');\n    if (savedApiUrl) apiBaseUrl = savedApiUrl;\n\n    const savedTimeout = localStorage.getItem('api_timeout');\n    if (savedTimeout) apiTimeout = parseInt(savedTimeout, 10);\n  });\n\n  async function handleLogin() {\n    loginError = '';\n    loginLoading = true;\n\n    try {\n      await forgeAgentsClient.login(loginEmail, loginPassword);\n      isAuthenticated = true;\n      showLoginForm = false;\n      loginEmail = '';\n      loginPassword = '';\n\n      // Update token expiry display\n      const expiresAt = localStorage.getItem('token_expires_at');\n      if (expiresAt) {\n        tokenExpiresAt = new Date(expiresAt).toLocaleString();\n      }\n    } catch (error: any) {\n      loginError = error.message || 'Login failed';\n    } finally {\n      loginLoading = false;\n    }\n  }\n\n  async function handleLogout() {\n    try {\n      await forgeAgentsClient.logout();\n      isAuthenticated = false;\n      tokenExpiresAt = null;\n    } catch (error) {\n      console.error('Logout error:', error);\n    }\n  }\n\n  function saveSettings() {\n    saveSuccess = false;\n    saveError = '';\n\n    try {\n      localStorage.setItem('api_base_url', apiBaseUrl);\n      localStorage.setItem('api_timeout', apiTimeout.toString());\n      saveSuccess = true;\n\n      // Clear success message after 3s\n      setTimeout(() => {\n        saveSuccess = false;\n      }, 3000);\n    } catch (error: any) {\n      saveError = error.message || 'Failed to save settings';\n    }\n  }\n\n  function resetSettings() {\n    apiBaseUrl = 'http://localhost:3000';\n    apiTimeout = 30000;\n    localStorage.removeItem('api_base_url');\n    localStorage.removeItem('api_timeout');\n    saveSuccess = true;\n    setTimeout(() => {\n      saveSuccess = false;\n    }, 3000);\n  }\n</script>\n\n<div class=\"settings-container\">\n  <!-- Page Header -->\n  <div class=\"page-header\">\n    <h1 class=\"page-title\">Settings</h1>\n    <p class=\"page-description\">Configure your VibeForge_BDS application</p>\n  </div>\n\n  <!-- API Configuration Section -->\n  <Panel title=\"API Configuration\" subtitle=\"Configure the ForgeAgents API endpoint and connection settings\" variant=\"bordered\" padding=\"lg\">\n    <div class=\"form-section\">\n      <Input\n        label=\"API Base URL\"\n        bind:value={apiBaseUrl}\n        placeholder=\"http://localhost:3000\"\n        helperText=\"The base URL for the ForgeAgents 120-skill API\"\n        fullWidth\n      />\n\n      <Select\n        label=\"Request Timeout\"\n        bind:value={apiTimeout}\n        options={timeoutOptions}\n        helperText=\"Maximum time to wait for API responses\"\n        fullWidth\n      />\n\n      <div class=\"button-group\">\n        <Button variant=\"primary\" on:click={saveSettings}>Save Settings</Button>\n        <Button variant=\"secondary\" on:click={resetSettings}>Reset to Defaults</Button>\n      </div>\n\n      {#if saveSuccess}\n        <Alert variant=\"success\" dismissible on:dismiss={() => (saveSuccess = false)}>\n          Settings saved successfully!\n        </Alert>\n      {/if}\n      {#if saveError}\n        <Alert variant=\"error\" dismissible on:dismiss={() => (saveError = '')}>\n          {saveError}\n        </Alert>\n      {/if}\n    </div>\n  </Panel>\n\n  <!-- Authentication Section -->\n  <Panel title=\"Authentication\" subtitle=\"Manage your BDS credentials and session\" variant=\"bordered\" padding=\"lg\">\n    <div class=\"auth-section\">\n      {#if isAuthenticated}\n        <div class=\"status-row\">\n          <div class=\"status-indicator\">\n            <Badge variant=\"success\" dot>Connected</Badge>\n          </div>\n          {#if tokenExpiresAt}\n            <p class=\"auth-info\">Token expires: {tokenExpiresAt}</p>\n          {/if}\n        </div>\n\n        <Button variant=\"danger\" on:click={handleLogout}>Logout</Button>\n      {:else}\n        <div class=\"status-row\">\n          <Badge variant=\"error\" dot>Disconnected</Badge>\n        </div>\n\n        {#if !showLoginForm}\n          <Button variant=\"primary\" on:click={() => (showLoginForm = true)}>\n            Login to BDS\n          </Button>\n        {:else}\n          <Panel variant=\"elevated\" padding=\"lg\">\n            <div class=\"login-form\">\n              <Input\n                label=\"Email\"\n                type=\"email\"\n                bind:value={loginEmail}\n                placeholder=\"your@email.com\"\n                required\n                fullWidth\n              />\n\n              <Input\n                label=\"Password\"\n                type=\"password\"\n                bind:value={loginPassword}\n                placeholder=\"••••••••\"\n                required\n                fullWidth\n              />\n\n              {#if loginError}\n                <Alert variant=\"error\">{loginError}</Alert>\n              {/if}\n\n              <div class=\"button-group\">\n                <Button variant=\"primary\" loading={loginLoading} on:click={handleLogin}>\n                  Login\n                </Button>\n                <Button variant=\"ghost\" on:click={() => (showLoginForm = false)}>\n                  Cancel\n                </Button>\n              </div>\n            </div>\n          </Panel>\n        {/if}\n      {/if}\n    </div>\n  </Panel>\n\n  <!-- About Section -->\n  <Panel title=\"About\" subtitle=\"System information and version details\" variant=\"bordered\" padding=\"lg\">\n    <div class=\"info-grid\">\n      <div class=\"info-card\">\n        <div class=\"info-label\">Application</div>\n        <div class=\"info-value\">VibeForge_BDS</div>\n      </div>\n      <div class=\"info-card\">\n        <div class=\"info-label\">Version</div>\n        <div class=\"info-value\">\n          <Badge variant=\"accent\">v0.1.0</Badge>\n        </div>\n      </div>\n      <div class=\"info-card\">\n        <div class=\"info-label\">Contract Version</div>\n        <div class=\"info-value\">FORGE_GLOBAL_EXECUTION_CONTRACT v1.0</div>\n      </div>\n      <div class=\"info-card\">\n        <div class=\"info-label\">Access Level</div>\n        <div class=\"info-value\">\n          <Badge variant=\"warning\">BDS Only (Internal)</Badge>\n        </div>\n      </div>\n      <div class=\"info-card\">\n        <div class=\"info-label\">Total Skills</div>\n        <div class=\"info-value\">120 (45 PUBLIC + 75 BDS_ONLY)</div>\n      </div>\n      <div class=\"info-card\">\n        <div class=\"info-label\">Backend</div>\n        <div class=\"info-value\">ForgeAgents 120-Skill API</div>\n      </div>\n    </div>\n  </Panel>\n\n  <!-- System Components Section -->\n  <Panel title=\"System Components\" subtitle=\"Integrated ForgeAgents infrastructure systems\" variant=\"bordered\" padding=\"lg\">\n    <div class=\"component-list\">\n      <div class=\"component-item\">\n        <Badge variant=\"info\" size=\"sm\">MAPO</Badge>\n        <span class=\"component-desc\">Multi-step orchestration pipeline</span>\n      </div>\n      <div class=\"component-item\">\n        <Badge variant=\"info\" size=\"sm\">NeuroForge</Badge>\n        <span class=\"component-desc\">Model routing and champion selection</span>\n      </div>\n      <div class=\"component-item\">\n        <Badge variant=\"info\" size=\"sm\">DataForge</Badge>\n        <span class=\"component-desc\">Data persistence layer</span>\n      </div>\n      <div class=\"component-item\">\n        <Badge variant=\"success\" size=\"sm\">Token Management</Badge>\n        <span class=\"component-desc\">Auto-refresh with 60s buffer</span>\n      </div>\n      <div class=\"component-item\">\n        <Badge variant=\"success\" size=\"sm\">Storage</Badge>\n        <span class=\"component-desc\">Tauri secure token storage</span>\n      </div>\n    </div>\n  </Panel>\n</div>\n\n<style>\n  /* ═══════════════════════════════════════════════════════════════════════\n     Settings Container\n     ═══════════════════════════════════════════════════════════════════════ */\n\n  .settings-container {\n    max-width: 1000px;\n    margin: 0 auto;\n    display: flex;\n    flex-direction: column;\n    gap: var(--spacing-xl);\n  }\n\n  /* Page Header */\n  .page-header {\n    margin-bottom: var(--spacing-lg);\n  }\n\n  .page-title {\n    font-family: var(--font-family-heading);\n    font-size: 2.5rem;\n    font-weight: 300;\n    color: var(--color-text-primary);\n    margin: 0 0 var(--spacing-sm) 0;\n    letter-spacing: 0.02em;\n  }\n\n  .page-description {\n    font-size: 1.125rem;\n    color: var(--color-text-tertiary);\n    margin: 0;\n  }\n\n  /* Form Section */\n  .form-section {\n    display: flex;\n    flex-direction: column;\n    gap: var(--spacing-lg);\n  }\n\n  .button-group {\n    display: flex;\n    gap: var(--spacing-md);\n    flex-wrap: wrap;\n  }\n\n  /* Auth Section */\n  .auth-section {\n    display: flex;\n    flex-direction: column;\n    gap: var(--spacing-lg);\n  }\n\n  .status-row {\n    display: flex;\n    flex-direction: column;\n    gap: var(--spacing-sm);\n  }\n\n  .status-indicator {\n    display: flex;\n    align-items: center;\n    gap: var(--spacing-sm);\n  }\n\n  .auth-info {\n    font-size: 0.875rem;\n    color: var(--color-text-tertiary);\n    font-family: var(--font-family-mono);\n    margin: 0;\n  }\n\n  .login-form {\n    display: flex;\n    flex-direction: column;\n    gap: var(--spacing-lg);\n  }\n\n  /* Info Grid */\n  .info-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));\n    gap: var(--spacing-md);\n  }\n\n  .info-card {\n    display: flex;\n    flex-direction: column;\n    gap: var(--spacing-sm);\n    padding: var(--spacing-md);\n    background-color: var(--color-surface-3);\n    border-radius: var(--radius-md);\n    transition: background-color var(--transition-fast);\n  }\n\n  .info-card:hover {\n    background-color: var(--color-surface-elevated);\n  }\n\n  .info-label {\n    font-size: 0.75rem;\n    color: var(--color-text-tertiary);\n    text-transform: uppercase;\n    letter-spacing: 0.05em;\n  }\n\n  .info-value {\n    font-size: 0.9375rem;\n    color: var(--color-text-primary);\n    font-weight: 500;\n  }\n\n  /* Component List */\n  .component-list {\n    display: flex;\n    flex-direction: column;\n    gap: var(--spacing-md);\n  }\n\n  .component-item {\n    display: flex;\n    align-items: center;\n    gap: var(--spacing-md);\n    padding: var(--spacing-md);\n    background-color: var(--color-surface-3);\n    border-radius: var(--radius-md);\n    transition: all var(--transition-fast);\n  }\n\n  .component-item:hover {\n    background-color: var(--color-surface-elevated);\n    transform: translateX(4px);\n  }\n\n  .component-desc {\n    font-size: 0.875rem;\n    color: var(--color-text-secondary);\n  }\n\n  /* Responsive */\n  @media (max-width: 768px) {\n    .page-title {\n      font-size: 2rem;\n    }\n\n    .info-grid {\n      grid-template-columns: 1fr;\n    }\n\n    .button-group {\n      flex-direction: column;\n    }\n\n    .button-group :global(button) {\n      width: 100%;\n    }\n  }\n</style>\n"],"names":["apiBaseUrl","apiTimeout","timeoutOptions","value","label","$$value"],"mappings":"mQAMM,IAAAA,EAAa,wBACbC,EAAa,UAgBXC,EAAc,CAChB,CAAAC,MAAO,IAAMC,MAAO,aACpB,CAAAD,MAAO,IAAOC,MAAO,cACrB,CAAAD,MAAO,KAAOC,MAAO,cACrB,CAAAD,MAAO,IAAOC,MAAO,cACrB,CAAAD,MAAO,IAAOC,MAAO,cACrB,CAAAD,MAAO,KAAQC,MAAO,ioBAkGRJ,gBAAAA,EAAUK,wEASbH,sFADGD,gBAAAA,EAAUI"}