function e(e){const r=a(),t=new Date;return function(e){return"object"==typeof e&&null!==e&&"category"in e&&"severity"in e&&"message"in e&&"userMessage"in e}(e)?{...e,id:r,timestamp:t}:e instanceof Response?function(e,r,t){const{status:s,statusText:a}=e,n={id:r,timestamp:t,statusCode:s,details:a};if(s>=400&&s<500)switch(s){case 400:return{...n,category:"VALIDATION",severity:"LOW",message:"Invalid request",userMessage:"Invalid input. Please check your data and try again.",retryable:!1};case 401:return{...n,category:"AUTHENTICATION",severity:"HIGH",message:"Authentication required",userMessage:"You need to log in to access this resource.",retryable:!1};case 403:return{...n,category:"AUTHORIZATION",severity:"HIGH",message:"Access forbidden",userMessage:"You don't have permission to access this resource.",retryable:!1};case 404:return{...n,category:"NOT_FOUND",severity:"MEDIUM",message:"Resource not found",userMessage:"The requested resource was not found.",retryable:!1};case 429:{const r=e.headers.get("Retry-After");let t=6e4;if(r){const e=parseInt(r,10);if(isNaN(e)){const e=new Date(r);isNaN(e.getTime())||(t=Math.max(0,e.getTime()-Date.now()))}else t=1e3*e}return{...n,category:"RATE_LIMIT",severity:"MEDIUM",message:"Rate limit exceeded",userMessage:`Too many requests. Please wait ${Math.ceil(t/1e3)} seconds and try again.`,retryable:!0,retryAfter:t}}default:return{...n,category:"API",severity:"MEDIUM",message:`Client error: ${s}`,userMessage:"Request failed. Please check your input and try again.",retryable:!1}}if(s>=500)return{...n,category:"SERVER",severity:"HIGH",message:`Server error: ${s}`,userMessage:"Server error. Please try again later.",retryable:!0,retryAfter:1e4};return{...n,category:"API",severity:"MEDIUM",message:`HTTP error: ${s}`,userMessage:"Request failed. Please try again.",retryable:!0}}(e,r,t):e instanceof TypeError?{id:r,category:"NETWORK",severity:"HIGH",message:e.message,userMessage:"Network connection error. Please check your internet connection.",timestamp:t,retryable:!0,retryAfter:5e3,originalError:e}:e instanceof Error?e.message.includes("timeout")?{id:r,category:"TIMEOUT",severity:"MEDIUM",message:e.message,userMessage:"Request timed out. Please try again.",timestamp:t,retryable:!0,retryAfter:3e3,originalError:e}:e.message.includes("not found")||e.message.includes("404")?{id:r,category:"NOT_FOUND",severity:"MEDIUM",message:e.message,userMessage:"Resource not found.",timestamp:t,retryable:!1,originalError:e}:{id:r,category:"UNKNOWN",severity:"MEDIUM",message:e.message,userMessage:"An unexpected error occurred. Please try again.",timestamp:t,retryable:!0,retryAfter:3e3,originalError:e}:"string"==typeof e?{id:r,category:"UNKNOWN",severity:"LOW",message:e,userMessage:e,timestamp:t,retryable:!0}:{id:r,category:"UNKNOWN",severity:"MEDIUM",message:"Unknown error",userMessage:"An unexpected error occurred. Please try again.",details:JSON.stringify(e),timestamp:t,retryable:!0}}function r(e,r){return{id:a(),category:"NETWORK",severity:"HIGH",message:e,userMessage:"Network error. Please check your connection.",details:r,timestamp:new Date,retryable:!0,retryAfter:5e3}}function t(e,r){return{id:a(),category:"VALIDATION",severity:"LOW",message:e,userMessage:e,context:r,timestamp:new Date,retryable:!1}}function s(e){return{id:a(),category:"AUTHENTICATION",severity:"HIGH",message:e,userMessage:"Authentication required. Please log in.",timestamp:new Date,retryable:!1}}function a(){return`err_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}function n(e,r,t=3){return!!e.retryable&&(!(r>=t)&&("VALIDATION"!==e.category&&"AUTHENTICATION"!==e.category&&"AUTHORIZATION"!==e.category&&"NOT_FOUND"!==e.category))}function o(e,r){return e.retryAfter?e.retryAfter:Math.min(1e3*Math.pow(2,r),3e4)}function i(e,r){const t={error:e,userAgent:navigator.userAgent,url:window.location.href,...r};try{const e=JSON.parse(localStorage.getItem("vibeforge_error_log")||"[]");e.push(t),e.length>50&&e.shift(),localStorage.setItem("vibeforge_error_log",JSON.stringify(e))}catch(s){}}function c(e){switch(e){case"CRITICAL":case"HIGH":return"error";case"MEDIUM":return"warning";default:return"info"}}export{e as a,r as b,t as c,o as d,s as e,c as g,i as l,n as s};
