function t(t,e,n,i){if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(t):i?i.value:e.get(t)}function e(t,e,n,i,s){if("function"==typeof e||!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,n),n}var n,i,s,r,a;const o="__TAURI_TO_IPC_KEY__";function c(t,e=!1){return window.__TAURI_INTERNALS__.transformCallback(t,e)}class h{constructor(a){n.set(this,void 0),i.set(this,0),s.set(this,[]),r.set(this,void 0),e(this,n,a||(()=>{})),this.id=c(a=>{const o=a.index;if("end"in a)return void(o==t(this,i,"f")?this.cleanupCallback():e(this,r,o));const c=a.message;if(o==t(this,i,"f")){for(t(this,n,"f").call(this,c),e(this,i,t(this,i,"f")+1);t(this,i,"f")in t(this,s,"f");){const r=t(this,s,"f")[t(this,i,"f")];t(this,n,"f").call(this,r),delete t(this,s,"f")[t(this,i,"f")],e(this,i,t(this,i,"f")+1)}t(this,i,"f")===t(this,r,"f")&&this.cleanupCallback()}else t(this,s,"f")[o]=c})}cleanupCallback(){window.__TAURI_INTERNALS__.unregisterCallback(this.id)}set onmessage(t){e(this,n,t)}get onmessage(){return t(this,n,"f")}[(n=new WeakMap,i=new WeakMap,s=new WeakMap,r=new WeakMap,o)](){return`__CHANNEL__:${this.id}`}toJSON(){return this[o]()}}class l{constructor(t,e,n){this.plugin=t,this.event=e,this.channelId=n}async unregister(){return d(`plugin:${this.plugin}|remove_listener`,{event:this.event,channelId:this.channelId})}}async function u(t,e,n){const i=new h(n);try{return await d(`plugin:${t}|register_listener`,{event:e,handler:i}),new l(t,e,i.id)}catch{return await d(`plugin:${t}|registerListener`,{event:e,handler:i}),new l(t,e,i.id)}}async function f(t){return d(`plugin:${t}|check_permissions`)}async function _(t){return d(`plugin:${t}|request_permissions`)}async function d(t,e={},n){return window.__TAURI_INTERNALS__.invoke(t,e,n)}function w(t,e="asset"){return window.__TAURI_INTERNALS__.convertFileSrc(t,e)}class p{get rid(){return t(this,a,"f")}constructor(t){a.set(this,void 0),e(this,a,t)}async close(){return d("plugin:resources|close",{rid:this.rid})}}function g(){return!!(globalThis||window).isTauri}a=new WeakMap;export{h as Channel,l as PluginListener,p as Resource,o as SERIALIZE_TO_IPC_FN,u as addPluginListener,f as checkPermissions,w as convertFileSrc,d as invoke,g as isTauri,_ as requestPermissions,c as transformCallback};
