var Ve=Object.defineProperty;var ze=(e,s,t)=>s in e?Ve(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t;var $e=(e,s,t)=>ze(e,typeof s!="symbol"?s+"":s,t);import{R as Je,p as ve,f as S,m as i,i as F,g as r,s as ie,e as d,c as R,q as M,H as Q,v as Z,w as I,x as D,h as c,r as n,Q as Oe,a3 as We,j as de,F as me,M as ce,a4 as Qe,k as Se,d as le,G as fe,T as Ne,b as Ze,n as Ke}from"../chunks/CJ97sMGe.js";import{E as Xe}from"../chunks/CI7XvWXj.js";import{B as oe,P as ne}from"../chunks/D8s3w_7f.js";import{I as Ye}from"../chunks/BhbBKy91.js";import{T as et}from"../chunks/BONb5YXj.js";import{A as tt}from"../chunks/BsnCgw2C.js";import{c as st,a as Te,b as we}from"../chunks/CUflB2Gp.js";import{B as xe}from"../chunks/DZ9aZlWI.js";var K=(e=>(e.PLAN="PLAN",e.ACT="ACT",e.OBSERVE="OBSERVE",e.REFLECT="REFLECT",e.TRANSITION="TRANSITION",e))(K||{}),L=(e=>(e.PENDING="PENDING",e.RUNNING="RUNNING",e.COMPLETED="COMPLETED",e.FAILED="FAILED",e.CANCELLED="CANCELLED",e))(L||{});const a=Je({sessions:[],currentSession:null,isStreaming:!1,streamingOutput:"",currentStage:null}),B={get sessions(){return a.sessions},get currentSession(){return a.currentSession},get isStreaming(){return a.isStreaming},get streamingOutput(){return a.streamingOutput},get currentStage(){return a.currentStage},get activeSessions(){return a.sessions.filter(e=>e.status===L.RUNNING||e.status===L.PENDING)},get completedSessions(){return a.sessions.filter(e=>e.status===L.COMPLETED)},get failedSessions(){return a.sessions.filter(e=>e.status===L.FAILED)},createSession(e){const s={id:rt(),type:"planning",status:L.PENDING,createdAt:new Date,request:e,stages:{}};return a.sessions=[...a.sessions,s],a.currentSession=s,s},startSession(e){const s=a.sessions.find(t=>t.id===e);s&&(s.status=L.RUNNING,s.startedAt=new Date,s.currentStage=K.PLAN,a.currentStage=K.PLAN,a.isStreaming=!0,a.streamingOutput="",a.sessions=[...a.sessions])},updateStageOutput(e,s,t){const u=a.sessions.find(_=>_.id===e);if(u){switch(s){case K.PLAN:u.stages.plan=t;break;case K.ACT:u.stages.act=t;break;case K.OBSERVE:u.stages.observe=t;break;case K.REFLECT:u.stages.reflect=t;break}a.sessions=[...a.sessions]}},appendStreamingOutput(e){a.streamingOutput+=e},clearStreamingOutput(){a.streamingOutput=""},advanceStage(e,s){const t=a.sessions.find(u=>u.id===e);t&&(s?(t.currentStage=s,a.currentStage=s,a.streamingOutput=""):(t.currentStage=void 0,a.currentStage=null,a.isStreaming=!1),a.sessions=[...a.sessions])},completeSession(e,s){const t=a.sessions.find(u=>u.id===e);t&&(t.status=L.COMPLETED,t.completedAt=new Date,t.deliverable=s,t.currentStage=void 0,a.currentStage=null,a.isStreaming=!1,a.streamingOutput="",a.sessions=[...a.sessions])},failSession(e,s){const t=a.sessions.find(u=>u.id===e);t&&(t.status=L.FAILED,t.completedAt=new Date,t.error=s,t.currentStage=void 0,a.currentStage=null,a.isStreaming=!1,a.streamingOutput="",a.sessions=[...a.sessions])},cancelSession(e){var t;const s=a.sessions.find(u=>u.id===e);s&&(s.status=L.CANCELLED,s.completedAt=new Date,s.currentStage=void 0,((t=a.currentSession)==null?void 0:t.id)===e&&(a.currentStage=null,a.isStreaming=!1,a.streamingOutput=""),a.sessions=[...a.sessions])},setCurrentSession(e){if(e===null){a.currentSession=null;return}const s=a.sessions.find(t=>t.id===e);s&&(a.currentSession=s)},deleteSession(e){var s;a.sessions=a.sessions.filter(t=>t.id!==e),((s=a.currentSession)==null?void 0:s.id)===e&&(a.currentSession=null,a.currentStage=null,a.isStreaming=!1,a.streamingOutput="")},clearAll(){a.sessions=[],a.currentSession=null,a.isStreaming=!1,a.streamingOutput="",a.currentStage=null}};function rt(){return`planning_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}class at{constructor(){$e(this,"activeStreams",new Map)}subscribe(s,t={}){const{onChunk:u,onStageStart:_,onStageEnd:f,onComplete:A,onError:$,reconnect:O=!0,reconnectDelay:b=3e3,maxReconnectAttempts:N=5}=t;let p=null,w=0,E=!1,C=!1,m=null;const y=()=>{if(!C)try{p=new EventSource(s),this.activeStreams.set(s,p),p.addEventListener("chunk",o=>{if(!(E||C))try{const l=JSON.parse(o.data);if(l.type==="chunk"&&typeof l.data=="object"&&l.data!==null){const P=l.data;P.content&&u&&u(P.content)}}catch(l){console.error("[StreamingService] Failed to parse chunk:",l)}}),p.addEventListener("stage_start",o=>{if(!(E||C))try{const l=JSON.parse(o.data);if(l.type==="stage_start"&&typeof l.data=="object"&&l.data!==null){const P=l.data;P.stage&&_&&_(P.stage)}}catch(l){console.error("[StreamingService] Failed to parse stage_start:",l)}}),p.addEventListener("stage_end",o=>{if(!(E||C))try{const l=JSON.parse(o.data);if(l.type==="stage_end"&&typeof l.data=="object"&&l.data!==null){const P=l.data;P.stage&&f&&f(P.stage,P.output)}}catch(l){console.error("[StreamingService] Failed to parse stage_end:",l)}}),p.addEventListener("complete",o=>{if(!(E||C))try{const l=JSON.parse(o.data);if(l.type==="complete"&&typeof l.data=="object"&&l.data!==null){const P=l.data;A&&A(P.result)}}catch(l){console.error("[StreamingService] Failed to parse complete:",l)}finally{g()}}),p.addEventListener("error",()=>{if(C)return;const o=st("Stream connection error");O&&w<N?(w++,console.log(`[StreamingService] Reconnecting (attempt ${w}/${N})...`),p==null||p.close(),this.activeStreams.delete(s),m=setTimeout(()=>{y()},b)):($&&$(o),g())}),p.addEventListener("open",()=>{w=0,console.log("[StreamingService] Stream connected")})}catch(o){const l=Te(o);$&&$(l),g()}},g=()=>{C=!0,E=!1,m&&(clearTimeout(m),m=null),p&&(p.close(),this.activeStreams.delete(s),p=null)},v=()=>{E=!0},h=()=>{E=!1};return y(),{close:g,pause:v,resume:h,get isActive(){return!C&&p!==null},get isPaused(){return E}}}closeAll(){this.activeStreams.forEach(s=>{s.close()}),this.activeStreams.clear()}get activeStreamCount(){return this.activeStreams.size}}const nt=new at,it="http://localhost:8787";function Ie(e){return!e.title||e.title.trim().length===0?we("Title is required"):e.title.length>200?we("Title must be 200 characters or less"):!e.description||e.description.trim().length===0?we("Description is required"):e.description.length>5e3?we("Description must be 5000 characters or less"):null}async function lt(e){const s=Ie(e);if(s)return{success:!1,error:s};try{const t=B.createSession(e);B.startSession(t.id);const u=`${it}/api/v1/bds/planning/${t.id}/stream`;return nt.subscribe(u,{onChunk:_=>{B.appendStreamingOutput(_)},onStageStart:_=>{const f=_;B.advanceStage(t.id,f)},onStageEnd:(_,f)=>{const A=_,$=f;B.updateStageOutput(t.id,A,$),B.clearStreamingOutput()},onComplete:_=>{const f=_;B.completeSession(t.id,f)},onError:_=>{B.failSession(t.id,_.message)}}),{success:!0,sessionId:t.id}}catch(t){return{success:!1,error:Te(t)}}}function ot(e){return e<1e3?`${e}ms`:e<6e4?`${(e/1e3).toFixed(1)}s`:e<36e5?`${(e/6e4).toFixed(1)}m`:`${(e/36e5).toFixed(1)}h`}function ct(e){return e<.01?`$${e.toFixed(4)}`:`$${e.toFixed(2)}`}function vt(e){return e<1e3?`${e} tokens`:e<1e6?`${(e/1e3).toFixed(1)}K tokens`:`${(e/1e6).toFixed(1)}M tokens`}var dt=S(`<form class="request-form svelte-19tf9np"><!> <!> <!> <div class="form-actions svelte-19tf9np"><!> <!></div> <div class="form-hint svelte-19tf9np"><p class="svelte-19tf9np">The Planning Agent will analyze your request and generate a detailed implementation plan with
			specific steps, acceptance criteria, and risk assessment.</p></div></form>`);function ut(e,s){ve(s,!0);let t=ie(""),u=ie(""),_=ie(null),f=ie(!1);const A=M(()=>B.isStreaming);async function $(){R(_,null);const g={title:r(t).trim(),description:r(u).trim()},v=Ie(g);if(v){R(_,v,!0);return}R(f,!0);try{const h=await lt(g);if(!h.success&&h.error){R(_,h.error,!0),R(f,!1);return}R(t,""),R(u,""),R(f,!1)}catch{R(f,!1)}}function O(){R(t,""),R(u,""),R(_,null)}var b=dt(),N=i(b);{var p=g=>{tt(g,{variant:"error",children:(v,h)=>{Q();var o=Z();I(()=>D(o,r(_).userMessage)),c(v,o)},$$slots:{default:!0}})};F(N,g=>{r(_)&&g(p)})}var w=d(N,2);{let g=M(()=>r(A)||r(f));Ye(w,{label:"Task Title",placeholder:"e.g., Add user authentication system",maxlength:200,required:!0,get disabled(){return r(g)},get value(){return r(t)},set value(v){R(t,v,!0)}})}var E=d(w,2);{let g=M(()=>r(A)||r(f));et(E,{label:"Description",placeholder:"Provide detailed requirements, constraints, and context for this task...",rows:8,maxlength:5e3,required:!0,get disabled(){return r(g)},get value(){return r(u)},set value(v){R(u,v,!0)}})}var C=d(E,2),m=i(C);{let g=M(()=>r(A)||r(f)||!r(t).trim()||!r(u).trim());oe(m,{type:"submit",variant:"primary",get disabled(){return r(g)},get loading(){return r(f)},children:(v,h)=>{Q();var o=Z();I(()=>D(o,r(f)?"Starting...":"Start Planning")),c(v,o)},$$slots:{default:!0}})}var y=d(m,2);{let g=M(()=>r(A)||r(f));oe(y,{type:"button",variant:"secondary",onclick:O,get disabled(){return r(g)},children:(v,h)=>{Q();var o=Z("Clear");c(v,o)},$$slots:{default:!0}})}n(C),Q(2),n(b),Oe("submit",b,We($)),c(e,b),de()}var pt=Qe('<svg width="16" height="16" viewBox="0 0 16 16" fill="none" class="svelte-e0qkuv"><path d="M13.5 4.5L6 12L2.5 8.5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-e0qkuv"></path></svg>'),gt=S('<div class="pulse svelte-e0qkuv"></div>'),mt=S("<div></div>"),ft=S('<div><div class="stage-indicator svelte-e0qkuv"><div class="stage-number svelte-e0qkuv"><!></div></div> <div class="stage-content svelte-e0qkuv"><div class="stage-label svelte-e0qkuv"> </div> <div class="stage-description svelte-e0qkuv"> </div></div> <!></div>'),_t=S('<div class="stage-progress svelte-e0qkuv"><div class="stages svelte-e0qkuv"></div></div>');function ht(e,s){ve(s,!0);const t=[{key:K.PLAN,label:"Plan",description:"Define strategy"},{key:K.ACT,label:"Act",description:"Execute steps"},{key:K.OBSERVE,label:"Observe",description:"Analyze results"},{key:K.REFLECT,label:"Reflect",description:"Evaluate success"}];function u($){return $?t.findIndex(O=>O.key===$):-1}const _=M(()=>u(s.stage));var f=_t(),A=i(f);me(A,21,()=>t,fe,($,O,b)=>{const N=M(()=>b===r(_)),p=M(()=>r(_)>b),w=M(()=>r(_)<b);var E=ft();let C;var m=i(E),y=i(m),g=i(y);{var v=x=>{var k=pt();c(x,k)},h=x=>{var k=Se(),q=le(k);{var W=j=>{var X=gt();c(j,X)},Y=j=>{var X=Z();X.nodeValue=b+1,c(j,X)};F(q,j=>{r(N)?j(W):j(Y,!1)},!0)}c(x,k)};F(g,x=>{r(p)?x(v):x(h,!1)})}n(y),n(m);var o=d(m,2),l=i(o),P=i(l,!0);n(l);var T=d(l,2),G=i(T,!0);n(T),n(o);var z=d(o,2);{var J=x=>{var k=mt();let q;I(()=>q=ce(k,1,"stage-connector svelte-e0qkuv",null,q,{completed:r(p)})),c(x,k)};F(z,x=>{b<t.length-1&&x(J)})}n(E),I(()=>{C=ce(E,1,"stage svelte-e0qkuv",null,C,{active:r(N),completed:r(p),pending:r(w)}),D(P,r(O).label),D(G,r(O).description)}),c($,E)}),n(A),n(f),c(e,f),de()}var wt=S('<pre class="output-text svelte-8glc1h"> </pre>'),St=S('<div class="loading-indicator svelte-8glc1h"><div class="spinner svelte-8glc1h"></div> <p class="svelte-8glc1h">Waiting for output...</p></div>'),bt=S('<div class="streaming-indicator svelte-8glc1h"><div class="dot svelte-8glc1h"></div> <div class="dot svelte-8glc1h"></div> <div class="dot svelte-8glc1h"></div></div>'),Et=S('<button class="scroll-to-bottom svelte-8glc1h"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" class="svelte-8glc1h"><path d="M8 12L4 8H12L8 12Z" fill="currentColor" class="svelte-8glc1h"></path></svg> Scroll to bottom</button>'),yt=S("<div><!> <!></div> <!>",1),kt=S('<div class="empty-state svelte-8glc1h"><p class="svelte-8glc1h">Output will appear here when the planning session starts.</p></div>'),xt=S('<div class="stage-output svelte-8glc1h"><!></div>');function Nt(e,s){ve(s,!0);let t,u=ie(!0);Ze(()=>{t&&r(u)&&s.output&&(t.scrollTop=t.scrollHeight)});function _(){if(!t)return;const{scrollTop:b,scrollHeight:N,clientHeight:p}=t,w=N-(b+p)<100;R(u,w)}var f=xt(),A=i(f);{var $=b=>{var N=yt(),p=le(N);let w;var E=i(p);{var C=o=>{var l=wt(),P=i(l,!0);n(l),I(()=>D(P,s.output)),c(o,l)},m=o=>{var l=St();c(o,l)};F(E,o=>{s.output?o(C):o(m,!1)})}var y=d(E,2);{var g=o=>{var l=bt();c(o,l)};F(y,o=>{s.isStreaming&&o(g)})}n(p),Ke(p,o=>t=o,()=>t);var v=d(p,2);{var h=o=>{var l=Et();l.__click=()=>{R(u,!0),t&&(t.scrollTop=t.scrollHeight)},c(o,l)};F(v,o=>{!r(u)&&s.isStreaming&&o(h)})}I(()=>w=ce(p,1,"output-container svelte-8glc1h",null,w,{streaming:s.isStreaming})),Oe("scroll",p,_),c(b,N)},O=b=>{var N=kt();c(b,N)};F(A,b=>{s.isStreaming||s.output?b($):b(O,!1)})}n(f),c(e,f),de()}Ne(["click"]);var Pt=S('<div class="empty-state svelte-1dk4y4m"><p>No planning sessions yet</p></div>'),Ct=S('<span class="session-duration svelte-1dk4y4m"> </span>'),Dt=S('<button><div class="session-header svelte-1dk4y4m"><span class="session-title svelte-1dk4y4m"> </span> <!></div> <div class="session-meta svelte-1dk4y4m"><span class="session-date svelte-1dk4y4m"> </span> <!></div></button>'),Lt=S('<div class="session-list svelte-1dk4y4m"></div>'),At=S('<div class="session-history svelte-1dk4y4m"><!></div>');function $t(e,s){ve(s,!0);const t=M(()=>B.sessions),u=M(()=>B.currentSession);function _(w){return new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(w)}function f(w){switch(w){case L.COMPLETED:return"success";case L.FAILED:case L.CANCELLED:return"error";case L.RUNNING:return"warning";default:return"info"}}function A(w){switch(w){case L.COMPLETED:return"Completed";case L.FAILED:return"Failed";case L.CANCELLED:return"Cancelled";case L.RUNNING:return"Running";case L.PENDING:return"Pending";default:return"Unknown"}}function $(w){B.setCurrentSession(w.id)}var O=At(),b=i(O);{var N=w=>{var E=Pt();c(w,E)},p=w=>{var E=Lt();me(E,21,()=>r(t).slice().reverse(),fe,(C,m)=>{var y=Dt();let g;y.__click=()=>$(r(m));var v=i(y),h=i(v),o=i(h,!0);n(h);var l=d(h,2);{let x=M(()=>f(r(m).status));xe(l,{get variant(){return r(x)},children:(k,q)=>{Q();var W=Z();I(Y=>D(W,Y),[()=>A(r(m).status)]),c(k,W)},$$slots:{default:!0}})}n(v);var P=d(v,2),T=i(P),G=i(T,!0);n(T);var z=d(T,2);{var J=x=>{const k=M(()=>r(m).completedAt.getTime()-r(m).startedAt.getTime());var q=Ct(),W=i(q,!0);n(q),I(Y=>D(W,Y),[()=>r(k)<6e4?`${Math.round(r(k)/1e3)}s`:`${Math.round(r(k)/6e4)}m`]),c(x,q)};F(z,x=>{r(m).completedAt&&r(m).startedAt&&x(J)})}n(P),n(y),I(x=>{var k;g=ce(y,1,"session-item svelte-1dk4y4m",null,g,{active:((k=r(u))==null?void 0:k.id)===r(m).id}),D(o,r(m).request.title),D(G,x)},[()=>_(r(m).createdAt)]),c(C,y)}),n(E),c(w,E)};F(b,w=>{r(t).length===0?w(N):w(p,!1)})}n(O),c(e,O),de()}Ne(["click"]);var Ot=S('<li class="svelte-2cw5wd"> </li>'),Tt=S('<div class="acceptance-criteria svelte-2cw5wd"><h5 class="svelte-2cw5wd">Acceptance Criteria:</h5> <ul class="svelte-2cw5wd"></ul></div>'),It=S('<div class="dependencies svelte-2cw5wd"><strong class="svelte-2cw5wd">Dependencies:</strong> </div>'),Ft=S('<div class="step-card svelte-2cw5wd"><div class="step-header svelte-2cw5wd"><span class="step-number svelte-2cw5wd"></span> <h4 class="svelte-2cw5wd"> </h4></div> <p class="step-description svelte-2cw5wd"> </p> <!> <!> <div class="step-meta svelte-2cw5wd"><!></div></div>'),Rt=S('<li class="svelte-2cw5wd"> </li>'),qt=S('<div class="plan-section svelte-2cw5wd"><h3 class="svelte-2cw5wd">Risks & Considerations</h3> <ul class="risks-list svelte-2cw5wd"></ul></div>'),Mt=S('<div class="plan-view"><div class="plan-header svelte-2cw5wd"><h2 class="svelte-2cw5wd"> </h2> <div class="plan-actions svelte-2cw5wd"><!> <!></div></div> <div class="plan-section svelte-2cw5wd"><h3 class="svelte-2cw5wd">Overview</h3> <p class="overview-text svelte-2cw5wd"> </p></div> <div class="plan-section svelte-2cw5wd"><h3 class="svelte-2cw5wd">Estimated Effort</h3> <!></div> <div class="plan-section svelte-2cw5wd"><h3 class="svelte-2cw5wd">Implementation Steps</h3> <div class="steps-list svelte-2cw5wd"></div></div> <!> <div class="metadata svelte-2cw5wd"><div class="metadata-item svelte-2cw5wd"><span class="label svelte-2cw5wd">Tokens Used:</span> <span class="value svelte-2cw5wd"> </span></div> <div class="metadata-item svelte-2cw5wd"><span class="label svelte-2cw5wd">Cost:</span> <span class="value svelte-2cw5wd"> </span></div> <div class="metadata-item svelte-2cw5wd"><span class="label svelte-2cw5wd">Duration:</span> <span class="value svelte-2cw5wd"> </span></div></div></div>'),Ut=S('<div class="prompt-view svelte-2cw5wd"><div class="prompt-header svelte-2cw5wd"><h3 class="svelte-2cw5wd">Execution Prompt</h3> <div class="prompt-actions svelte-2cw5wd"><!> <!></div></div> <pre class="prompt-text svelte-2cw5wd"> </pre></div>'),Bt=S('<div class="deliverable-viewer svelte-2cw5wd"><div class="tabs svelte-2cw5wd"><button>Implementation Plan</button> <button>Execution Prompt</button></div> <div class="tab-content svelte-2cw5wd"><!></div></div>');function Gt(e,s){ve(s,!0);let t=ie("plan");async function u(m){try{await navigator.clipboard.writeText(m)}catch(y){console.error("Failed to copy:",y)}}function _(m,y){const g=new Blob([m],{type:"text/plain"}),v=URL.createObjectURL(g),h=document.createElement("a");h.href=v,h.download=y,h.click(),URL.revokeObjectURL(v)}var f=Bt(),A=i(f),$=i(A);let O;$.__click=()=>R(t,"plan");var b=d($,2);let N;b.__click=()=>R(t,"prompt"),n(A);var p=d(A,2),w=i(p);{var E=m=>{var y=Mt(),g=i(y),v=i(g),h=i(v,!0);n(v);var o=d(v,2),l=i(o);oe(l,{variant:"secondary",size:"sm",onclick:()=>u(JSON.stringify(s.deliverable.plan,null,2)),children:(H,U)=>{Q();var V=Z("Copy");c(H,V)},$$slots:{default:!0}});var P=d(l,2);oe(P,{variant:"secondary",size:"sm",onclick:()=>_(JSON.stringify(s.deliverable.plan,null,2),`${s.deliverable.plan.title}.json`),children:(H,U)=>{Q();var V=Z("Download");c(H,V)},$$slots:{default:!0}}),n(o),n(g);var T=d(g,2),G=d(i(T),2),z=i(G,!0);n(G),n(T);var J=d(T,2),x=d(i(J),2);xe(x,{variant:"info",children:(H,U)=>{Q();var V=Z();I(()=>D(V,s.deliverable.plan.estimatedEffort)),c(H,V)},$$slots:{default:!0}}),n(J);var k=d(J,2),q=d(i(k),2);me(q,21,()=>s.deliverable.plan.steps,fe,(H,U,V)=>{var pe=Ft(),ge=i(pe),ae=i(ge);ae.textContent=V+1;var he=d(ae,2),qe=i(he,!0);n(he),n(ge);var Ee=d(ge,2),Me=i(Ee,!0);n(Ee);var De=d(Ee,2);{var Ue=ee=>{var te=Tt(),se=d(i(te),2);me(se,21,()=>r(U).acceptanceCriteria,fe,(ye,je)=>{var ke=Ot(),He=i(ke,!0);n(ke),I(()=>D(He,r(je))),c(ye,ke)}),n(se),n(te),c(ee,te)};F(De,ee=>{r(U).acceptanceCriteria.length>0&&ee(Ue)})}var Le=d(De,2);{var Be=ee=>{var te=It(),se=d(i(te));n(te),I(ye=>D(se,` ${ye??""}`),[()=>r(U).dependencies.join(", ")]),c(ee,te)};F(Le,ee=>{r(U).dependencies.length>0&&ee(Be)})}var Ae=d(Le,2),Ge=i(Ae);xe(Ge,{variant:"info",children:(ee,te)=>{Q();var se=Z();I(()=>D(se,r(U).estimatedEffort)),c(ee,se)},$$slots:{default:!0}}),n(Ae),n(pe),I(()=>{D(qe,r(U).title),D(Me,r(U).description)}),c(H,pe)}),n(q),n(k);var W=d(k,2);{var Y=H=>{var U=qt(),V=d(i(U),2);me(V,21,()=>s.deliverable.plan.risks,fe,(pe,ge)=>{var ae=Rt(),he=i(ae,!0);n(ae),I(()=>D(he,r(ge))),c(pe,ae)}),n(V),n(U),c(H,U)};F(W,H=>{s.deliverable.plan.risks.length>0&&H(Y)})}var j=d(W,2),X=i(j),be=d(i(X),2),ue=i(be,!0);n(be),n(X);var re=d(X,2),_e=d(i(re),2),Fe=i(_e,!0);n(_e),n(re);var Pe=d(re,2),Ce=d(i(Pe),2),Re=i(Ce,!0);n(Ce),n(Pe),n(j),n(y),I((H,U,V)=>{D(h,s.deliverable.plan.title),D(z,s.deliverable.plan.overview),D(ue,H),D(Fe,U),D(Re,V)},[()=>vt(s.deliverable.metadata.totalTokens),()=>ct(s.deliverable.metadata.totalCost),()=>ot(s.deliverable.metadata.duration)]),c(m,y)},C=m=>{var y=Ut(),g=i(y),v=d(i(g),2),h=i(v);oe(h,{variant:"secondary",size:"sm",onclick:()=>u(s.deliverable.prompt),children:(T,G)=>{Q();var z=Z("Copy");c(T,z)},$$slots:{default:!0}});var o=d(h,2);oe(o,{variant:"secondary",size:"sm",onclick:()=>_(s.deliverable.prompt,`${s.deliverable.plan.title}-prompt.txt`),children:(T,G)=>{Q();var z=Z("Download");c(T,z)},$$slots:{default:!0}}),n(v),n(g);var l=d(g,2),P=i(l,!0);n(l),n(y),I(()=>D(P,s.deliverable.prompt)),c(m,y)};F(w,m=>{r(t)==="plan"?m(E):m(C,!1)})}n(p),n(f),I(()=>{O=ce($,1,"tab svelte-2cw5wd",null,O,{active:r(t)==="plan"}),N=ce(b,1,"tab svelte-2cw5wd",null,N,{active:r(t)==="prompt"})}),c(e,f),de()}Ne(["click"]);var jt=S("<!> <!>",1),Ht=S('<div class="error-message svelte-dy79yi"><h3 class="svelte-dy79yi">Error</h3> <p> </p></div>'),Vt=S('<div class="empty-state svelte-dy79yi"><h2 class="svelte-dy79yi">Start a Planning Session</h2> <p>Fill out the form on the left to begin planning a new task.</p></div>'),zt=S('<div class="planning-page svelte-dy79yi"><header class="page-header svelte-dy79yi"><h1 class="svelte-dy79yi">Planning Agent</h1> <p class="text-muted svelte-dy79yi">Define and plan complex implementation tasks</p></header> <div class="content-grid svelte-dy79yi"><div class="left-column"><!> <!></div> <div class="right-column"><!></div></div></div>');function ss(e,s){ve(s,!0);const t=M(()=>B.currentSession),u=M(()=>B.isStreaming),_=M(()=>B.currentStage),f=M(()=>B.streamingOutput);Xe(e,{children:(A,$)=>{var O=zt(),b=d(i(O),2),N=i(b),p=i(N);ne(p,{title:"New Planning Request",children:(v,h)=>{ut(v,{})},$$slots:{default:!0}});var w=d(p,2);{var E=v=>{ne(v,{title:"Session History",class:"mt-6",children:(h,o)=>{$t(h,{})},$$slots:{default:!0}})};F(w,v=>{r(t)&&v(E)})}n(N);var C=d(N,2),m=i(C);{var y=v=>{var h=Se(),o=le(h);{var l=T=>{ne(T,{title:"Planning in Progress",children:(G,z)=>{var J=jt(),x=le(J);ht(x,{get stage(){return r(_)}});var k=d(x,2);Nt(k,{get output(){return r(f)},get isStreaming(){return r(u)}}),c(G,J)},$$slots:{default:!0}})},P=T=>{var G=Se(),z=le(G);{var J=k=>{ne(k,{title:"Planning Complete",children:(q,W)=>{Gt(q,{get deliverable(){return r(t).deliverable}})},$$slots:{default:!0}})},x=k=>{var q=Se(),W=le(q);{var Y=j=>{ne(j,{title:"Planning Failed",variant:"error",children:(X,be)=>{var ue=Ht(),re=d(i(ue),2),_e=i(re,!0);n(re),n(ue),I(()=>D(_e,r(t).error||"An unknown error occurred")),c(X,ue)},$$slots:{default:!0}})};F(W,j=>{r(t).status===L.FAILED&&j(Y)},!0)}c(k,q)};F(z,k=>{r(t).status===L.COMPLETED&&r(t).deliverable?k(J):k(x,!1)},!0)}c(T,G)};F(o,T=>{r(t).status===L.RUNNING||r(t).status===L.PENDING?T(l):T(P,!1)})}c(v,h)},g=v=>{ne(v,{title:"Welcome",children:(h,o)=>{var l=Vt();c(h,l)},$$slots:{default:!0}})};F(m,v=>{r(t)?v(y):v(g,!1)})}n(C),n(b),n(O),c(A,O)},$$slots:{default:!0}}),de()}export{ss as component};
