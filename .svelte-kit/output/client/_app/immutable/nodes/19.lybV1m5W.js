import{s as e,T as t,o as s,e as a,i as l,z as r,k as i,l as v,p as n,j as d,q as c,a as u,r as o,I as p,y as f,g as m,x as h,A as g,m as $,h as b,G as y,H as x,P as k,W as T,Z as w}from"../chunks/BBEC77oO.js";import{s as R}from"../chunks/DRhfx38_.js";import{P as O}from"../chunks/B2n38f_9.js";import{B as D}from"../chunks/DHMzYP54.js";import{A as S}from"../chunks/hkv9Cn3v.js";import{I as C}from"../chunks/DJbQjZGk.js";import{S as P}from"../chunks/BFrF1liP.js";import{B as E}from"../chunks/BLNhyOUm.js";import{T as N}from"../chunks/BMepI2hO.js";import{f as j}from"../chunks/Bt2SublD.js";var I=a('<div class="view-tabs svelte-6vfrt7"><!> <!></div>'),W=a('<div class="loading-state svelte-6vfrt7"><div class="spinner svelte-6vfrt7"></div> <p>Loading skills...</p></div>'),z=a('<span class="helper-text svelte-6vfrt7"> </span>'),_=a('<label class="checkbox-label svelte-6vfrt7"><input type="checkbox" class="svelte-6vfrt7"/> <span> </span> <!></label>'),A=a('<div class="input-field svelte-6vfrt7"><!></div>'),q=a('<div class="skill-info svelte-6vfrt7"><!> <p class="skill-description svelte-6vfrt7"> </p></div> <div class="inputs-section svelte-6vfrt7"><h3 class="subsection-title svelte-6vfrt7">Test Inputs</h3> <!></div> <div class="assertion-section svelte-6vfrt7"><h3 class="subsection-title svelte-6vfrt7">Assertion</h3> <label class="checkbox-label svelte-6vfrt7"><input type="checkbox" class="svelte-6vfrt7"/> <span>Use regex pattern matching</span></label> <!></div> <div class="options-section svelte-6vfrt7"><h3 class="subsection-title svelte-6vfrt7">Execution Options</h3> <!> <!> <!></div> <!>',1),F=a('<div class="panel-section svelte-6vfrt7"><h2 class="section-title svelte-6vfrt7">Create Test Case</h2> <div class="form-section svelte-6vfrt7"><!> <!> <!></div></div>'),H=a('<div class="empty-state svelte-6vfrt7"><p class="empty-message svelte-6vfrt7">No test cases created yet.</p> <p class="empty-hint svelte-6vfrt7">Create a test case on the left to get started.</p></div>'),L=a('<div class="result-error svelte-6vfrt7"><span class="result-label svelte-6vfrt7">Error:</span> <span class="error-message svelte-6vfrt7"> </span></div>'),M=a('<div class="test-result svelte-6vfrt7"><div class="result-details svelte-6vfrt7"><span class="result-label svelte-6vfrt7">Execution Time:</span> <span class="result-value svelte-6vfrt7"> </span></div> <div class="result-details svelte-6vfrt7"><span class="result-label svelte-6vfrt7">Match:</span> <span class="result-value svelte-6vfrt7"> </span></div> <!></div>'),B=a('<div class="test-case-card svelte-6vfrt7"><div class="test-case-header svelte-6vfrt7"><div class="test-info svelte-6vfrt7"><h3 class="test-name svelte-6vfrt7"> </h3> <div class="test-meta svelte-6vfrt7"><!> <!></div></div> <div class="test-actions svelte-6vfrt7"><!> <!></div></div> <!></div>'),G=a('<div class="test-cases-list svelte-6vfrt7"></div>'),J=a('<div class="panel-section svelte-6vfrt7"><div class="section-header svelte-6vfrt7"><h2 class="section-title svelte-6vfrt7"> </h2> <!></div> <!></div>'),U=a('<div class="builder-layout svelte-6vfrt7"><!> <!></div>'),Z=a('<div class="empty-state svelte-6vfrt7"><p class="empty-message svelte-6vfrt7">No test results yet.</p> <p class="empty-hint svelte-6vfrt7">Run some tests to see results here.</p></div>'),K=a('<div class="detail-row error svelte-6vfrt7"><span class="detail-label svelte-6vfrt7">Error:</span> <span class="detail-value svelte-6vfrt7"> </span></div>'),Q=a('<div class="history-item svelte-6vfrt7"><div class="history-header svelte-6vfrt7"><div class="history-info svelte-6vfrt7"><h3 class="history-title svelte-6vfrt7"> </h3> <div class="history-meta svelte-6vfrt7"><span class="timestamp svelte-6vfrt7"> </span> <!> <span class="execution-time svelte-6vfrt7"> </span></div></div></div> <div class="history-details svelte-6vfrt7"><div class="detail-row svelte-6vfrt7"><span class="detail-label svelte-6vfrt7">Match Details:</span> <span class="detail-value svelte-6vfrt7"> </span></div> <!> <div class="detail-row svelte-6vfrt7"><span class="detail-label svelte-6vfrt7">Output:</span> <pre class="output-preview svelte-6vfrt7"> </pre></div></div></div>'),V=a('<div class="history-list svelte-6vfrt7"></div>'),X=a('<div class="panel-section svelte-6vfrt7"><div class="section-header svelte-6vfrt7"><h2 class="section-title svelte-6vfrt7"> </h2> <!></div> <!></div>'),Y=a('<div class="testing-container svelte-6vfrt7"><div class="page-header svelte-6vfrt7"><div class="header-content svelte-6vfrt7"><h1 class="page-title svelte-6vfrt7">Skill Testing Lab</h1> <p class="page-description svelte-6vfrt7">Create, run, and manage automated tests for your skills</p></div> <div class="stats-row svelte-6vfrt7"><div class="stat-item svelte-6vfrt7"><span class="stat-value svelte-6vfrt7"> </span> <span class="stat-label svelte-6vfrt7">Total Tests</span></div> <div class="stat-item svelte-6vfrt7"><span class="stat-value success svelte-6vfrt7"> </span> <span class="stat-label svelte-6vfrt7">Passed</span></div> <div class="stat-item svelte-6vfrt7"><span class="stat-value error svelte-6vfrt7"> </span> <span class="stat-label svelte-6vfrt7">Failed</span></div> <div class="stat-item svelte-6vfrt7"><span class="stat-value warning svelte-6vfrt7"> </span> <span class="stat-label svelte-6vfrt7">Not Run</span></div></div></div> <!> <!> <!></div>');function ee(a,ee){n(ee,!0);let te=e(t([])),se=e(t([])),ae=e(t([])),le=e(!0),re=e(null),ie=e(""),ve=e(""),ne=e(t({})),de=e(""),ce=e(""),ue=e(!1),oe=e("gpt-4o-mini"),pe=e(.7),fe=e(4096),me=e(null),he=e("builder"),ge=h(()=>m(te).find(e=>e.id===m(ie))||null),$e=h(()=>m(te).map(e=>({value:e.id,label:`${e.name} (${e.category})`}))),be=h(()=>({total:m(se).length,passed:m(se).filter(e=>!0===e.lastResult?.passed).length,failed:m(se).filter(e=>!1===e.lastResult?.passed).length,notRun:m(se).filter(e=>!e.lastResult).length}));const ye=[{value:"gpt-4o",label:"GPT-4o"},{value:"gpt-4o-mini",label:"GPT-4o Mini"},{value:"claude-3-5-sonnet-20241022",label:"Claude 3.5 Sonnet"},{value:"claude-3-5-haiku-20241022",label:"Claude 3.5 Haiku"}];function xe(){localStorage.setItem("vibeforge_test_cases",JSON.stringify(m(se)))}function ke(){localStorage.setItem("vibeforge_test_history",JSON.stringify(m(ae)))}function Te(){if(!m(ge)||!m(ve).trim())return void u(re,"Please select a skill and provide a test name");const e={id:`test-${Date.now()}`,name:m(ve),skillId:m(ge).id,skillName:m(ge).name,inputs:{...m(ne)},expectedOutput:m(ue)?void 0:m(de),expectedPattern:m(ue)?m(ce):void 0,executionOptions:{model:m(oe),temperature:m(pe),max_tokens:m(fe)},createdAt:new Date};u(se,[...m(se),e],!0),xe(),u(ve,""),u(ne,{},!0),u(de,""),u(ce,""),u(re,null)}async function we(e){u(me,e.id,!0),u(re,null);const t=Date.now();try{const s=await j.invokeSkill(e.skillId,{inputs:e.inputs,options:e.executionOptions}),a=Date.now()-t,l=s.output;let r=!1,i="";if(e.expectedPattern){r=new RegExp(e.expectedPattern,"i").test(l),i=r?`Output matched pattern: ${e.expectedPattern}`:`Output did not match pattern: ${e.expectedPattern}`}else if(e.expectedOutput){const t=e.expectedOutput.trim().toLowerCase(),s=l.trim().toLowerCase();r=s.includes(t)||t.includes(s),i=r?"Output matched expected result":"Output did not match expected result"}else r=!0,i="No assertion defined - execution successful";const v={passed:r,actualOutput:l,executionTime:a,matchDetails:i,timestamp:new Date};u(se,m(se).map(t=>t.id===e.id?{...t,lastRun:new Date,lastResult:v}:t),!0),xe();const n={id:`run-${Date.now()}`,testCaseId:e.id,result:v,timestamp:new Date};u(ae,[n,...m(ae)],!0),ke()}catch(s){const a={passed:!1,actualOutput:"",executionTime:Date.now()-t,error:s instanceof Error?s.message:"Execution failed",timestamp:new Date};u(se,m(se).map(t=>t.id===e.id?{...t,lastRun:new Date,lastResult:a}:t),!0),xe()}finally{u(me,null)}}async function Re(){for(const e of m(se))await we(e)}function Oe(){u(ae,[],!0),ke()}s(async()=>{try{u(te,await R.getAllSkills(),!0),function(){const e=localStorage.getItem("vibeforge_test_cases");e&&u(se,JSON.parse(e,(e,t)=>"createdAt"===e||"lastRun"===e||"timestamp"===e?new Date(t):t),!0)}(),function(){const e=localStorage.getItem("vibeforge_test_history");e&&u(ae,JSON.parse(e,(e,t)=>"timestamp"===e?new Date(t):t),!0)}(),u(le,!1)}catch(e){u(re,e instanceof Error?e.message:"Failed to load skills",!0),u(le,!1)}});var De=Y(),Se=c(De),Ce=d(c(Se),2),Pe=c(Ce),Ee=c(Pe),Ne=c(Ee,!0);o(Ee),p(2),o(Pe);var je=d(Pe,2),Ie=c(je),We=c(Ie,!0);o(Ie),p(2),o(je);var ze=d(je,2),_e=c(ze),Ae=c(_e,!0);o(_e),p(2),o(ze);var qe=d(ze,2),Fe=c(qe),He=c(Fe,!0);o(Fe),p(2),o(qe),o(Ce),o(Se);var Le=d(Se,2);O(Le,{variant:"bordered",padding:"md",children:(e,t)=>{var s=I(),a=c(s);{let e=h(()=>"builder"===m(he)?"primary":"ghost");D(a,{get variant(){return m(e)},$$events:{click:()=>u(he,"builder")},children:(e,t)=>{p();var s=f("Test Builder");i(e,s)},$$slots:{default:!0}})}var l=d(a,2);{let e=h(()=>"results"===m(he)?"primary":"ghost");D(l,{get variant(){return m(e)},$$events:{click:()=>u(he,"results")},children:(e,t)=>{p();var s=f("Test Results");i(e,s)},$$slots:{default:!0}})}o(s),i(e,s)},$$slots:{default:!0}});var Me=d(Le,2),Be=e=>{S(e,{variant:"error",title:"Error",children:(e,t)=>{p();var s=f();r(()=>g(s,m(re))),i(e,s)},$$slots:{default:!0}})};l(Me,e=>{m(re)&&e(Be)});var Ge=d(Me,2),Je=e=>{var t=W();i(e,t)},Ue=e=>{var t=$(),s=b(t),a=e=>{var t=U(),s=c(t);O(s,{variant:"bordered",padding:"lg",children:(e,t)=>{var s=F(),a=d(c(s),2),v=c(a);C(v,{type:"text",label:"Test Name",placeholder:"e.g., Test code generation for Python",required:!0,fullWidth:!0,get value(){return m(ve)},set value(e){u(ve,e,!0)}});var n=d(v,2);P(n,{label:"Skill to Test",get options(){return m($e)},placeholder:"Select a skill...",required:!0,fullWidth:!0,get value(){return m(ie)},set value(e){u(ie,e,!0)}});var R=d(n,2),O=e=>{var t=q(),s=b(t),a=c(s);E(a,{variant:"info",size:"sm",children:(e,t)=>{p();var s=f();r(()=>g(s,m(ge).category)),i(e,s)},$$slots:{default:!0}});var v=d(a,2),n=c(v,!0);o(v),o(s);var R=d(s,2),O=d(c(R),2);y(O,17,()=>Object.entries(m(ge).inputs),x,(e,t)=>{var s=h(()=>w(m(t),2));let a=()=>m(s)[0],v=()=>m(s)[1];var n=A(),u=c(n),p=e=>{N(e,{get label(){return a()},get helperText(){return v().description},get required(){return v().required},fullWidth:!0,get value(){return m(ne)[a()]},set value(e){m(ne)[a()]=e}})},f=e=>{var t=$(),s=b(t),n=e=>{C(e,{type:"number",get label(){return a()},get helperText(){return v().description},get required(){return v().required},fullWidth:!0,get value(){return m(ne)[a()]},set value(e){m(ne)[a()]=e}})},u=e=>{var t=$(),s=b(t),n=e=>{var t=_(),s=c(t);k(s);var n=d(s,2),u=c(n,!0);o(n);var p=d(n,2),f=e=>{var t=z(),s=c(t,!0);o(t),r(()=>g(s,v().description)),i(e,t)};l(p,e=>{v().description&&e(f)}),o(t),r(()=>g(u,a())),T(s,()=>m(ne)[a()],e=>m(ne)[a()]=e),i(e,t)};l(s,e=>{"boolean"===v().type&&e(n)},!0),i(e,t)};l(s,e=>{"number"===v().type?e(n):e(u,!1)},!0),i(e,t)};l(u,e=>{"string"===v().type?e(p):e(f,!1)}),o(n),i(e,n)}),o(R);var S=d(R,2),j=d(c(S),2),I=c(j);k(I),p(2),o(j);var W=d(j,2),F=e=>{C(e,{type:"text",label:"Expected Pattern (Regex)",placeholder:"e.g., function.*calculate",helperText:"Regular expression to match against output",fullWidth:!0,get value(){return m(ce)},set value(e){u(ce,e,!0)}})},H=e=>{N(e,{label:"Expected Output",placeholder:"Enter the expected output (or leave empty for no assertion)",helperText:"Test will check if output contains this text",fullWidth:!0,get value(){return m(de)},set value(e){u(de,e,!0)}})};l(W,e=>{m(ue)?e(F):e(H,!1)}),o(S);var L=d(S,2),M=d(c(L),2);P(M,{label:"Model",get options(){return ye},fullWidth:!0,get value(){return m(oe)},set value(e){u(oe,e,!0)}});var B=d(M,2);C(B,{type:"number",label:"Temperature",min:0,max:2,step:.1,fullWidth:!0,get value(){return m(pe)},set value(e){u(pe,e,!0)}});var G=d(B,2);C(G,{type:"number",label:"Max Tokens",min:1,max:32e3,fullWidth:!0,get value(){return m(fe)},set value(e){u(fe,e,!0)}}),o(L);var J=d(L,2);D(J,{variant:"primary",fullWidth:!0,$$events:{click:Te},children:(e,t)=>{p();var s=f("Create Test Case");i(e,s)},$$slots:{default:!0}}),r(()=>g(n,m(ge).description)),T(I,()=>m(ue),e=>u(ue,e)),i(e,t)};l(R,e=>{m(ge)&&e(O)}),o(a),o(s),i(e,s)},$$slots:{default:!0}});var a=d(s,2);O(a,{variant:"bordered",padding:"lg",children:(e,t)=>{var s=J(),a=c(s),v=c(a),n=c(v);o(v);var $=d(v,2),b=e=>{D(e,{variant:"secondary",size:"sm",$$events:{click:Re},children:(e,t)=>{p();var s=f("Run All Tests");i(e,s)},$$slots:{default:!0}})};l($,e=>{m(se).length>0&&e(b)}),o(a);var x=d(a,2),k=e=>{var t=H();i(e,t)},T=e=>{var t=G();y(t,21,()=>m(se),e=>e.id,(e,t)=>{var s=B(),a=c(s),v=c(a),n=c(v),$=c(n,!0);o(n);var b=d(n,2),y=c(b);E(y,{variant:"default",size:"sm",children:(e,s)=>{p();var a=f();r(()=>g(a,m(t).skillName)),i(e,a)},$$slots:{default:!0}});var x=d(y,2),k=e=>{{let s=h(()=>m(t).lastResult.passed?"success":"error");E(e,{get variant(){return m(s)},size:"sm",children:(e,s)=>{p();var a=f();r(()=>g(a,m(t).lastResult.passed?"✓ Passed":"✗ Failed")),i(e,a)},$$slots:{default:!0}})}},T=e=>{E(e,{variant:"warning",size:"sm",children:(e,t)=>{p();var s=f("Not Run");i(e,s)},$$slots:{default:!0}})};l(x,e=>{m(t).lastResult?e(k):e(T,!1)}),o(b),o(v);var w=d(v,2),R=c(w);{let e=h(()=>m(me)===m(t).id);D(R,{variant:"primary",size:"sm",get loading(){return m(e)},$$events:{click:()=>we(m(t))},children:(e,t)=>{p();var s=f("Run");i(e,s)},$$slots:{default:!0}})}var O=d(R,2);D(O,{variant:"ghost",size:"sm",$$events:{click:()=>{return e=m(t).id,u(se,m(se).filter(t=>t.id!==e),!0),xe(),u(ae,m(ae).filter(t=>t.testCaseId!==e),!0),void ke();var e}},children:(e,t)=>{p();var s=f("Delete");i(e,s)},$$slots:{default:!0}}),o(w),o(a);var S=d(a,2),C=e=>{var s=M(),a=c(s),v=d(c(a),2),n=c(v);o(v),o(a);var u=d(a,2),p=d(c(u),2),f=c(p,!0);o(p),o(u);var h=d(u,2),$=e=>{var s=L(),a=d(c(s),2),l=c(a,!0);o(a),o(s),r(()=>g(l,m(t).lastResult.error)),i(e,s)};l(h,e=>{m(t).lastResult.error&&e($)}),o(s),r(()=>{g(n,`${m(t).lastResult.executionTime??""}ms`),g(f,m(t).lastResult.matchDetails)}),i(e,s)};l(S,e=>{m(t).lastResult&&e(C)}),o(s),r(()=>g($,m(t).name)),i(e,s)}),o(t),i(e,t)};l(x,e=>{0===m(se).length?e(k):e(T,!1)}),o(s),r(()=>g(n,`Test Cases (${m(se).length??""})`)),i(e,s)},$$slots:{default:!0}}),o(t),i(e,t)},v=e=>{O(e,{variant:"bordered",padding:"lg",children:(e,t)=>{var s=X(),a=c(s),v=c(a),n=c(v);o(v);var u=d(v,2),$=e=>{D(e,{variant:"danger",size:"sm",$$events:{click:Oe},children:(e,t)=>{p();var s=f("Clear History");i(e,s)},$$slots:{default:!0}})};l(u,e=>{m(ae).length>0&&e($)}),o(a);var b=d(a,2),x=e=>{var t=Z();i(e,t)},k=e=>{var t=V();y(t,21,()=>m(ae),e=>e.id,(e,t)=>{const s=h(()=>m(se).find(e=>e.id===m(t).testCaseId));var a=Q(),v=c(a),n=c(v),u=c(n),$=c(u,!0);o(u);var b=d(u,2),y=c(b),x=c(y,!0);o(y);var k=d(y,2);{let e=h(()=>m(t).result.passed?"success":"error");E(k,{get variant(){return m(e)},size:"sm",children:(e,s)=>{p();var a=f();r(()=>g(a,m(t).result.passed?"✓ Passed":"✗ Failed")),i(e,a)},$$slots:{default:!0}})}var T=d(k,2),w=c(T);o(T),o(b),o(n),o(v);var R=d(v,2),O=c(R),D=d(c(O),2),S=c(D,!0);o(D),o(O);var C=d(O,2),P=e=>{var s=K(),a=d(c(s),2),l=c(a,!0);o(a),o(s),r(()=>g(l,m(t).result.error)),i(e,s)};l(C,e=>{m(t).result.error&&e(P)});var N=d(C,2),j=d(c(N),2),I=c(j);o(j),o(N),o(R),o(a),r((e,a)=>{g($,m(s)?.name||"Unknown Test"),g(x,e),g(w,`${m(t).result.executionTime??""}ms`),g(S,m(t).result.matchDetails),g(I,`${a??""}${m(t).result.actualOutput.length>200?"...":""}`)},[()=>m(t).timestamp.toLocaleString("en-US",{dateStyle:"short",timeStyle:"medium"}),()=>m(t).result.actualOutput.slice(0,200)]),i(e,a)}),o(t),i(e,t)};l(b,e=>{0===m(ae).length?e(x):e(k,!1)}),o(s),r(()=>g(n,`Test History (${m(ae).length??""})`)),i(e,s)},$$slots:{default:!0}})};l(s,e=>{"builder"===m(he)?e(a):e(v,!1)},!0),i(e,t)};l(Ge,e=>{m(le)?e(Je):e(Ue,!1)}),o(De),r(()=>{g(Ne,m(be).total),g(We,m(be).passed),g(Ae,m(be).failed),g(He,m(be).notRun)}),i(a,De),v()}export{ee as component};
