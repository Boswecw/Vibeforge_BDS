{"version":3,"file":"20.C8Vb6wxo.js","sources":["../../../../../../src/lib/components/DragDropWorkflow.svelte","../../../../../../src/lib/components/Modal.svelte","../../../../../../src/routes/workflows/+page.svelte"],"sourcesContent":["<script lang=\"ts\">\n  // @ts-nocheck - This file uses @dnd-kit (React library) with Svelte, causing type incompatibilities\n  // The runtime works correctly, but TypeScript types are for React components\n  import { onMount } from 'svelte';\n  import {\n    DndContext,\n    DragOverlay,\n    closestCenter,\n    PointerSensor,\n    KeyboardSensor,\n    useSensor,\n    useSensors,\n    type DragEndEvent,\n    type DragStartEvent\n  } from '@dnd-kit/core';\n  import {\n    SortableContext,\n    verticalListSortingStrategy,\n    useSortable,\n    arrayMove\n  } from '@dnd-kit/sortable';\n  import { CSS } from '@dnd-kit/utilities';\n  import type { Skill } from '$lib/api/types';\n  import { Button, Badge, Modal, Input, Textarea, Alert, Select } from '$lib/components';\n\n  // Props\n  interface Props {\n    skills: Skill[];\n    initialSteps?: WorkflowStep[];\n    onSave?: (steps: WorkflowStep[]) => void;\n    onCancel?: () => void;\n  }\n\n  interface WorkflowStep {\n    id: string;\n    skillId: string;\n    skillName: string;\n    order: number;\n    inputs: Record<string, any>;\n    useOutputFrom?: string;\n  }\n\n  interface ValidationError {\n    stepId: string;\n    message: string;\n  }\n\n  interface HistoryEntry {\n    steps: WorkflowStep[];\n    timestamp: number;\n  }\n\n  let { skills, initialSteps = [], onSave, onCancel }: Props = $props();\n\n  // State\n  let workflowSteps = $state<WorkflowStep[]>([...initialSteps]);\n  let activeSkillId = $state<string | null>(null);\n  let activeStepId = $state<string | null>(null);\n  let isDraggingFromLibrary = $state(false);\n  let configModalOpen = $state(false);\n  let selectedStep = $state<WorkflowStep | null>(null);\n  let selectedStepInputsJson = $state<string>('{}');\n  let validationErrors = $state<ValidationError[]>([]);\n  let autoSaveEnabled = $state(true);\n  let lastSaved = $state<Date | null>(null);\n\n  // Undo/Redo state\n  let history = $state<HistoryEntry[]>([]);\n  let historyIndex = $state(-1);\n  let maxHistorySize = 20;\n\n  // Sensors for drag-and-drop\n  const sensors = useSensors(\n    useSensor(PointerSensor),\n    useSensor(KeyboardSensor)\n  );\n\n  // Derived state\n  let canUndo = $derived(historyIndex > 0);\n  let canRedo = $derived(historyIndex < history.length - 1);\n\n  // Initialize history\n  onMount(() => {\n    addToHistory(workflowSteps);\n  });\n\n  // Auto-save effect\n  $effect(() => {\n    if (autoSaveEnabled && workflowSteps.length > 0 && onSave) {\n      const timeoutId = setTimeout(() => {\n        onSave(workflowSteps);\n        lastSaved = new Date();\n      }, 1000); // Debounce auto-save by 1 second\n\n      return () => clearTimeout(timeoutId);\n    }\n  });\n\n  // Validation effect\n  $effect(() => {\n    validateWorkflow();\n  });\n\n  // Global keyboard shortcuts\n  onMount(() => {\n    function handleKeyDown(e: KeyboardEvent) {\n      // Undo: Cmd+Z / Ctrl+Z\n      if ((e.metaKey || e.ctrlKey) && e.key === 'z' && !e.shiftKey) {\n        e.preventDefault();\n        undo();\n      }\n      // Redo: Cmd+Shift+Z / Ctrl+Shift+Z\n      else if ((e.metaKey || e.ctrlKey) && e.key === 'z' && e.shiftKey) {\n        e.preventDefault();\n        redo();\n      }\n    }\n\n    window.addEventListener('keydown', handleKeyDown);\n    return () => window.removeEventListener('keydown', handleKeyDown);\n  });\n\n  /**\n   * History Management\n   */\n  function addToHistory(steps: WorkflowStep[]) {\n    // Remove future history if we're not at the end\n    if (historyIndex < history.length - 1) {\n      history = history.slice(0, historyIndex + 1);\n    }\n\n    // Add new entry\n    history = [...history, { steps: JSON.parse(JSON.stringify(steps)), timestamp: Date.now() }];\n\n    // Limit history size\n    if (history.length > maxHistorySize) {\n      history = history.slice(history.length - maxHistorySize);\n    }\n\n    historyIndex = history.length - 1;\n  }\n\n  function undo() {\n    if (!canUndo) return;\n\n    historyIndex--;\n    workflowSteps = JSON.parse(JSON.stringify(history[historyIndex].steps));\n  }\n\n  function redo() {\n    if (!canRedo) return;\n\n    historyIndex++;\n    workflowSteps = JSON.parse(JSON.stringify(history[historyIndex].steps));\n  }\n\n  /**\n   * Drag-and-Drop Handlers\n   */\n  function handleDragStart(event: DragStartEvent) {\n    const { active } = event;\n    const activeId = active.id as string;\n\n    // Check if dragging from skill library\n    if (activeId.startsWith('skill-')) {\n      activeSkillId = activeId.replace('skill-', '');\n      isDraggingFromLibrary = true;\n    } else if (activeId.startsWith('step-')) {\n      activeStepId = activeId;\n      isDraggingFromLibrary = false;\n    }\n  }\n\n  function handleDragEnd(event: DragEndEvent) {\n    const { active, over } = event;\n\n    if (!over) {\n      activeSkillId = null;\n      activeStepId = null;\n      isDraggingFromLibrary = false;\n      return;\n    }\n\n    const activeId = active.id as string;\n    const overId = over.id as string;\n\n    // Handle drop from skill library to workflow canvas\n    if (isDraggingFromLibrary && overId === 'workflow-canvas') {\n      const skill = skills.find(s => s.id === activeSkillId);\n      if (skill) {\n        addSkillToWorkflow(skill);\n      }\n    }\n    // Handle reordering within workflow\n    else if (!isDraggingFromLibrary && activeId.startsWith('step-')) {\n      const oldIndex = workflowSteps.findIndex(s => `step-${s.id}` === activeId);\n      const newIndex = workflowSteps.findIndex(s => `step-${s.id}` === overId);\n\n      if (oldIndex !== -1 && newIndex !== -1) {\n        const reordered = arrayMove(workflowSteps, oldIndex, newIndex);\n        // Update order numbers\n        workflowSteps = reordered.map((step, index) => ({ ...step, order: index }));\n        addToHistory(workflowSteps);\n      }\n    }\n\n    activeSkillId = null;\n    activeStepId = null;\n    isDraggingFromLibrary = false;\n  }\n\n  /**\n   * Workflow Management\n   */\n  function addSkillToWorkflow(skill: Skill) {\n    const newStep: WorkflowStep = {\n      id: `step-${Date.now()}`,\n      skillId: skill.id,\n      skillName: skill.name,\n      order: workflowSteps.length,\n      inputs: {},\n      useOutputFrom: workflowSteps.length > 0 ? workflowSteps[workflowSteps.length - 1].id : undefined\n    };\n\n    workflowSteps = [...workflowSteps, newStep];\n    addToHistory(workflowSteps);\n  }\n\n  function removeStep(stepId: string) {\n    workflowSteps = workflowSteps\n      .filter(s => s.id !== stepId)\n      .map((step, index) => ({ ...step, order: index }));\n    addToHistory(workflowSteps);\n  }\n\n  function openConfigModal(step: WorkflowStep) {\n    selectedStep = step;\n    selectedStepInputsJson = JSON.stringify(step.inputs, null, 2);\n    configModalOpen = true;\n  }\n\n  function saveStepConfig() {\n    if (!selectedStep) return;\n\n    const index = workflowSteps.findIndex(s => s.id === selectedStep.id);\n    if (index !== -1) {\n      // Parse JSON inputs\n      let parsedInputs: Record<string, any> = {};\n      try {\n        parsedInputs = JSON.parse(selectedStepInputsJson);\n      } catch {\n        // Keep existing inputs if JSON is invalid\n        parsedInputs = selectedStep.inputs;\n      }\n      workflowSteps[index] = { ...selectedStep, inputs: parsedInputs };\n      addToHistory(workflowSteps);\n    }\n\n    configModalOpen = false;\n    selectedStep = null;\n    selectedStepInputsJson = '{}';\n  }\n\n  /**\n   * Validation\n   */\n  function validateWorkflow() {\n    const errors: ValidationError[] = [];\n\n    // Check for missing inputs\n    workflowSteps.forEach(step => {\n      const skill = skills.find(s => s.id === step.skillId);\n      if (skill?.requiredInputs) {\n        skill.requiredInputs.forEach(input => {\n          if (!step.inputs[input] && !step.useOutputFrom) {\n            errors.push({\n              stepId: step.id,\n              message: `Missing required input: ${input}`\n            });\n          }\n        });\n      }\n    });\n\n    // Check for circular dependencies (simple check)\n    const stepMap = new Map(workflowSteps.map(s => [s.id, s]));\n    workflowSteps.forEach(step => {\n      const visited = new Set<string>();\n      let current = step;\n\n      while (current.useOutputFrom) {\n        if (visited.has(current.id)) {\n          errors.push({\n            stepId: step.id,\n            message: 'Circular dependency detected'\n          });\n          break;\n        }\n        visited.add(current.id);\n        const next = stepMap.get(current.useOutputFrom);\n        if (!next) break;\n        current = next;\n      }\n    });\n\n    validationErrors = errors;\n  }\n\n  function getStepErrors(stepId: string): string[] {\n    return validationErrors.filter(e => e.stepId === stepId).map(e => e.message);\n  }\n\n  /**\n   * Manual Save/Cancel\n   */\n  function handleSave() {\n    if (onSave) {\n      onSave(workflowSteps);\n      lastSaved = new Date();\n    }\n  }\n\n  function handleCancel() {\n    if (onCancel) {\n      onCancel();\n    }\n  }\n</script>\n\n<!-- Drag-and-Drop Workflow Builder -->\n<div class=\"workflow-builder\">\n  <!-- Toolbar -->\n  <div class=\"toolbar\">\n    <div class=\"toolbar-left\">\n      <h2>Workflow Builder</h2>\n      <div class=\"status\">\n        {#if lastSaved}\n          <span class=\"saved-indicator\">âœ“ Saved {lastSaved.toLocaleTimeString()}</span>\n        {:else}\n          <span class=\"unsaved-indicator\">â— Unsaved changes</span>\n        {/if}\n      </div>\n    </div>\n    <div class=\"toolbar-right\">\n      <Button variant=\"ghost\" size=\"sm\" onclick={undo} disabled={!canUndo}>\n        â†¶ Undo\n      </Button>\n      <Button variant=\"ghost\" size=\"sm\" onclick={redo} disabled={!canRedo}>\n        â†· Redo\n      </Button>\n      <Button variant=\"ghost\" size=\"sm\" onclick={handleCancel}>\n        Cancel\n      </Button>\n      <Button variant=\"primary\" size=\"sm\" onclick={handleSave}>\n        Save Workflow\n      </Button>\n    </div>\n  </div>\n\n  <!-- Main Content: Side-by-side panels -->\n  <DndContext\n    sensors={sensors}\n    collisionDetection={closestCenter}\n    onDragStart={handleDragStart}\n    onDragEnd={handleDragEnd}\n  >\n    <div class=\"builder-content\">\n      <!-- Skill Library Panel -->\n      <div class=\"skill-library\">\n        <h3>Skill Library</h3>\n        <p class=\"hint\">Drag skills to the workflow canvas</p>\n\n        <div class=\"skill-list\">\n          {#each skills as skill}\n            <SkillLibraryItem {skill} />\n          {/each}\n        </div>\n      </div>\n\n      <!-- Workflow Canvas -->\n      <div class=\"workflow-canvas\" id=\"workflow-canvas\" data-droppable=\"true\">\n        <h3>Workflow Steps ({workflowSteps.length})</h3>\n\n        {#if workflowSteps.length === 0}\n          <div class=\"empty-state\">\n            <div class=\"empty-icon\">âš¡</div>\n            <p>Drag skills from the library to build your workflow</p>\n            <p class=\"empty-hint\">You can reorder steps by dragging them</p>\n          </div>\n        {:else}\n          <SortableContext\n            items={workflowSteps.map(s => `step-${s.id}`)}\n            strategy={verticalListSortingStrategy}\n          >\n            {#each workflowSteps as step (step.id)}\n              <WorkflowStepItem\n                {step}\n                errors={getStepErrors(step.id)}\n                onConfigure={() => openConfigModal(step)}\n                onRemove={() => removeStep(step.id)}\n              />\n            {/each}\n          </SortableContext>\n        {/if}\n      </div>\n    </div>\n\n    <!-- Drag Overlay -->\n    <DragOverlay>\n      {#if activeSkillId}\n        {@const skill = skills.find(s => s.id === activeSkillId)}\n        {#if skill}\n          <div class=\"drag-preview\">\n            <Badge variant=\"primary\">{skill.category}</Badge>\n            <strong>{skill.name}</strong>\n          </div>\n        {/if}\n      {:else if activeStepId}\n        {@const step = workflowSteps.find(s => `step-${s.id}` === activeStepId)}\n        {#if step}\n          <div class=\"drag-preview step-preview\">\n            <Badge variant=\"info\">Step {step.order + 1}</Badge>\n            <strong>{step.skillName}</strong>\n          </div>\n        {/if}\n      {/if}\n    </DragOverlay>\n  </DndContext>\n\n  <!-- Validation Errors -->\n  {#if validationErrors.length > 0}\n    <div class=\"validation-errors\">\n      <Alert variant=\"error\">\n        <strong>Validation Errors ({validationErrors.length})</strong>\n        <ul>\n          {#each validationErrors.slice(0, 5) as error}\n            <li>{error.message} (Step {workflowSteps.find(s => s.id === error.stepId)?.order ?? '?'})</li>\n          {/each}\n          {#if validationErrors.length > 5}\n            <li>...and {validationErrors.length - 5} more</li>\n          {/if}\n        </ul>\n      </Alert>\n    </div>\n  {/if}\n</div>\n\n<!-- Step Configuration Modal -->\n{#if configModalOpen && selectedStep}\n  <Modal\n    title=\"Configure Step: {selectedStep.skillName}\"\n    open={configModalOpen}\n    onClose={() => { configModalOpen = false; selectedStep = null; }}\n  >\n    <div class=\"config-modal\">\n      <div class=\"form-group\">\n        <Select\n          label=\"Use output from previous step\"\n          options={[\n            { value: '', label: 'None' },\n            ...workflowSteps\n              .filter(s => s.order < selectedStep.order)\n              .map(s => ({ value: s.id, label: `Step ${s.order + 1}: ${s.skillName}` }))\n          ]}\n          bind:value={selectedStep.useOutputFrom}\n        />\n      </div>\n\n      <div class=\"form-group\">\n        <Textarea\n          label=\"Custom Inputs (JSON)\"\n          bind:value={selectedStepInputsJson}\n          rows={6}\n          placeholder={`{\"key\": \"value\"}`}\n        />\n      </div>\n\n      <div class=\"modal-actions\">\n        <Button variant=\"ghost\" onclick={() => { configModalOpen = false; selectedStep = null; }}>\n          Cancel\n        </Button>\n        <Button variant=\"primary\" onclick={saveStepConfig}>\n          Save Configuration\n        </Button>\n      </div>\n    </div>\n  </Modal>\n{/if}\n\n<!-- Skill Library Item Component -->\n{#snippet SkillLibraryItem({ skill }: { skill: Skill })}\n  {@const sortable = useSortable({ id: `skill-${skill.id}` })}\n  <div\n    class=\"skill-item\"\n    style={sortable.transform ? `transform: ${CSS.Transform.toString(sortable.transform)}` : ''}\n    {...sortable.attributes}\n    {...sortable.listeners}\n  >\n    <Badge variant=\"primary\" size=\"sm\">{skill.category}</Badge>\n    <div class=\"skill-info\">\n      <strong>{skill.name}</strong>\n      <p>{skill.description}</p>\n    </div>\n    <div class=\"drag-handle\">â‹®â‹®</div>\n  </div>\n{/snippet}\n\n<!-- Workflow Step Item Component -->\n{#snippet WorkflowStepItem({\n  step,\n  errors,\n  onConfigure,\n  onRemove\n}: {\n  step: WorkflowStep;\n  errors: string[];\n  onConfigure: () => void;\n  onRemove: () => void\n})}\n  {@const sortable = useSortable({ id: `step-${step.id}` })}\n  <div\n    class=\"workflow-step {errors.length > 0 ? 'has-error' : ''}\"\n    style={sortable.transform ? `transform: ${CSS.Transform.toString(sortable.transform)}` : ''}\n    {...sortable.attributes}\n  >\n    <div class=\"step-header\">\n      <div class=\"step-drag-handle\" {...sortable.listeners}>â‹®â‹®</div>\n      <Badge variant=\"info\" size=\"sm\">Step {step.order + 1}</Badge>\n      <strong class=\"step-name\">{step.skillName}</strong>\n      <div class=\"step-actions\">\n        <Button variant=\"ghost\" size=\"sm\" onclick={onConfigure}>\n          âš™ï¸ Configure\n        </Button>\n        <Button variant=\"ghost\" size=\"sm\" onclick={onRemove}>\n          ğŸ—‘ï¸\n        </Button>\n      </div>\n    </div>\n\n    {#if step.useOutputFrom}\n      {@const prevStep = workflowSteps.find(s => s.id === step.useOutputFrom)}\n      {#if prevStep}\n        <div class=\"step-dependency\">\n          â†³ Uses output from Step {prevStep.order + 1}\n        </div>\n      {/if}\n    {/if}\n\n    {#if errors.length > 0}\n      <div class=\"step-errors\">\n        {#each errors as error}\n          <div class=\"error-message\">âš ï¸ {error}</div>\n        {/each}\n      </div>\n    {/if}\n  </div>\n{/snippet}\n\n<style>\n  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n     Workflow Builder Layout\n     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */\n\n  .workflow-builder {\n    display: flex;\n    flex-direction: column;\n    height: 100%;\n    gap: var(--spacing-md);\n  }\n\n  .toolbar {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: var(--spacing-md);\n    background: var(--color-midnight-light);\n    border: 1px solid var(--color-brass);\n    border-radius: 8px;\n  }\n\n  .toolbar-left {\n    display: flex;\n    align-items: center;\n    gap: var(--spacing-md);\n  }\n\n  .toolbar-left h2 {\n    margin: 0;\n    font-size: 1.25rem;\n    color: var(--color-pearl);\n  }\n\n  .status {\n    font-size: 0.875rem;\n  }\n\n  .saved-indicator {\n    color: var(--color-success);\n  }\n\n  .unsaved-indicator {\n    color: var(--color-warning);\n  }\n\n  .toolbar-right {\n    display: flex;\n    gap: var(--spacing-sm);\n  }\n\n  .builder-content {\n    display: grid;\n    grid-template-columns: 350px 1fr;\n    gap: var(--spacing-lg);\n    flex: 1;\n    overflow: hidden;\n  }\n\n  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n     Skill Library Panel\n     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */\n\n  .skill-library {\n    display: flex;\n    flex-direction: column;\n    background: var(--color-midnight-light);\n    border: 1px solid var(--color-brass);\n    border-radius: 8px;\n    padding: var(--spacing-md);\n    overflow-y: auto;\n  }\n\n  .skill-library h3 {\n    margin: 0 0 var(--spacing-sm) 0;\n    color: var(--color-brass);\n    font-size: 1.125rem;\n  }\n\n  .hint {\n    margin: 0 0 var(--spacing-md) 0;\n    font-size: 0.875rem;\n    color: var(--color-pearl-dark);\n  }\n\n  .skill-list {\n    display: flex;\n    flex-direction: column;\n    gap: var(--spacing-sm);\n  }\n\n  .skill-item {\n    display: flex;\n    align-items: flex-start;\n    gap: var(--spacing-sm);\n    padding: var(--spacing-sm);\n    background: var(--color-midnight);\n    border: 1px solid var(--color-brass-dark);\n    border-radius: 6px;\n    cursor: grab;\n    transition: all 0.2s ease;\n  }\n\n  .skill-item:hover {\n    border-color: var(--color-brass);\n    box-shadow: 0 2px 8px rgba(184, 134, 11, 0.2);\n  }\n\n  .skill-item:active {\n    cursor: grabbing;\n  }\n\n  .skill-info {\n    flex: 1;\n    min-width: 0;\n  }\n\n  .skill-info strong {\n    display: block;\n    color: var(--color-pearl);\n    font-size: 0.9375rem;\n    margin-bottom: 4px;\n  }\n\n  .skill-info p {\n    margin: 0;\n    font-size: 0.8125rem;\n    color: var(--color-pearl-dark);\n    overflow: hidden;\n    text-overflow: ellipsis;\n    display: -webkit-box;\n    -webkit-line-clamp: 2;\n    line-clamp: 2;\n    -webkit-box-orient: vertical;\n  }\n\n  .drag-handle {\n    color: var(--color-brass-dark);\n    font-size: 1.25rem;\n    cursor: grab;\n  }\n\n  .drag-handle:active {\n    cursor: grabbing;\n  }\n\n  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n     Workflow Canvas\n     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */\n\n  .workflow-canvas {\n    display: flex;\n    flex-direction: column;\n    background: var(--color-midnight-light);\n    border: 2px dashed var(--color-brass-dark);\n    border-radius: 8px;\n    padding: var(--spacing-md);\n    overflow-y: auto;\n    min-height: 400px;\n  }\n\n  .workflow-canvas h3 {\n    margin: 0 0 var(--spacing-md) 0;\n    color: var(--color-brass);\n    font-size: 1.125rem;\n  }\n\n  .empty-state {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    flex: 1;\n    text-align: center;\n    color: var(--color-pearl-dark);\n  }\n\n  .empty-icon {\n    font-size: 4rem;\n    margin-bottom: var(--spacing-md);\n    opacity: 0.5;\n  }\n\n  .empty-state p {\n    margin: 0;\n    font-size: 1rem;\n  }\n\n  .empty-hint {\n    font-size: 0.875rem;\n    margin-top: var(--spacing-sm);\n    opacity: 0.7;\n  }\n\n  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n     Workflow Steps\n     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */\n\n  .workflow-step {\n    display: flex;\n    flex-direction: column;\n    gap: var(--spacing-sm);\n    padding: var(--spacing-md);\n    background: var(--color-midnight);\n    border: 1px solid var(--color-brass-dark);\n    border-radius: 6px;\n    margin-bottom: var(--spacing-sm);\n    transition: all 0.2s ease;\n  }\n\n  .workflow-step:hover {\n    border-color: var(--color-brass);\n    box-shadow: 0 2px 8px rgba(184, 134, 11, 0.2);\n  }\n\n  .workflow-step.has-error {\n    border-color: var(--color-error);\n    background: rgba(255, 59, 48, 0.05);\n  }\n\n  .step-header {\n    display: flex;\n    align-items: center;\n    gap: var(--spacing-sm);\n  }\n\n  .step-drag-handle {\n    color: var(--color-brass-dark);\n    font-size: 1.25rem;\n    cursor: grab;\n    padding: 4px;\n  }\n\n  .step-drag-handle:active {\n    cursor: grabbing;\n  }\n\n  .step-name {\n    flex: 1;\n    color: var(--color-pearl);\n    font-size: 0.9375rem;\n  }\n\n  .step-actions {\n    display: flex;\n    gap: var(--spacing-xs);\n  }\n\n  .step-dependency {\n    font-size: 0.8125rem;\n    color: var(--color-info);\n    padding-left: calc(var(--spacing-md) + 1.25rem);\n  }\n\n  .step-errors {\n    padding-left: calc(var(--spacing-md) + 1.25rem);\n  }\n\n  .error-message {\n    font-size: 0.8125rem;\n    color: var(--color-error);\n    margin-top: 4px;\n  }\n\n  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n     Drag Overlay\n     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */\n\n  .drag-preview {\n    display: flex;\n    align-items: center;\n    gap: var(--spacing-sm);\n    padding: var(--spacing-sm) var(--spacing-md);\n    background: var(--color-midnight);\n    border: 2px solid var(--color-brass);\n    border-radius: 6px;\n    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.5);\n    opacity: 0.9;\n  }\n\n  .drag-preview strong {\n    color: var(--color-pearl);\n    font-size: 0.9375rem;\n  }\n\n  .step-preview {\n    background: var(--color-midnight-light);\n  }\n\n  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n     Configuration Modal\n     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */\n\n  .config-modal {\n    display: flex;\n    flex-direction: column;\n    gap: var(--spacing-md);\n  }\n\n  .form-group {\n    display: flex;\n    flex-direction: column;\n    gap: var(--spacing-xs);\n  }\n\n  .form-group label {\n    font-weight: 500;\n    color: var(--color-pearl);\n    font-size: 0.9375rem;\n  }\n\n  .modal-actions {\n    display: flex;\n    justify-content: flex-end;\n    gap: var(--spacing-sm);\n    margin-top: var(--spacing-md);\n  }\n\n  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n     Validation Errors\n     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */\n\n  .validation-errors {\n    padding: var(--spacing-md);\n  }\n\n  .validation-errors ul {\n    margin: var(--spacing-sm) 0 0 var(--spacing-md);\n    padding: 0;\n  }\n\n  .validation-errors li {\n    margin-bottom: var(--spacing-xs);\n  }\n\n  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n     Responsive\n     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */\n\n  @media (max-width: 1024px) {\n    .builder-content {\n      grid-template-columns: 1fr;\n      grid-template-rows: auto 1fr;\n    }\n\n    .skill-library {\n      max-height: 300px;\n    }\n  }\n</style>\n","<script lang=\"ts\">\n  import { createEventDispatcher, onMount } from 'svelte';\n  import Button from './Button.svelte';\n  import { FocusTrap } from '$lib/utils/accessibility';\n\n  // Props\n  export let open: boolean = false;\n  export let title: string = '';\n  export let size: 'sm' | 'md' | 'lg' | 'xl' | 'full' = 'md';\n  export let closeOnBackdrop: boolean = true;\n  export let closeOnEscape: boolean = true;\n  export let showClose: boolean = true;\n  export let showFooter: boolean = true;\n  export let onClose: (() => void) | undefined = undefined;\n\n  const dispatch = createEventDispatcher();\n  let focusTrap: FocusTrap | null = null;\n  let modalEl: HTMLElement;\n\n  // Effect to manage focus trap when modal opens/closes\n  $: if (open && modalEl) {\n    setTimeout(() => {\n      focusTrap = new FocusTrap(modalEl);\n      focusTrap.activate();\n    }, 50);\n  } else if (!open && focusTrap) {\n    focusTrap.deactivate();\n    focusTrap = null;\n  }\n\n  // Size classes\n  $: sizeClass = {\n    sm: 'modal-sm',\n    md: 'modal-md',\n    lg: 'modal-lg',\n    xl: 'modal-xl',\n    full: 'modal-full'\n  }[size];\n\n  // Handle escape key\n  function handleKeydown(event: KeyboardEvent) {\n    if (closeOnEscape && event.key === 'Escape' && open) {\n      close();\n    }\n  }\n\n  // Handle backdrop click\n  function handleBackdropClick(event: MouseEvent) {\n    if (closeOnBackdrop && event.target === event.currentTarget) {\n      close();\n    }\n  }\n\n  function close() {\n    open = false;\n    dispatch('close');\n    if (onClose) onClose();\n  }\n</script>\n\n<svelte:window on:keydown={handleKeydown} />\n\n{#if open}\n  <div class=\"modal-backdrop\" on:click={handleBackdropClick} role=\"presentation\">\n    <div bind:this={modalEl} class=\"modal {sizeClass}\" role=\"dialog\" aria-modal=\"true\" aria-labelledby=\"modal-title\">\n      <!-- Header -->\n      <div class=\"modal-header\">\n        {#if title}\n          <h3 class=\"modal-title\" id=\"modal-title\">{title}</h3>\n        {:else if $$slots.header}\n          <div class=\"modal-title\">\n            <slot name=\"header\" />\n          </div>\n        {/if}\n\n        {#if showClose}\n          <button class=\"modal-close\" on:click={close} aria-label=\"Close modal\">\n            âœ•\n          </button>\n        {/if}\n      </div>\n\n      <!-- Body -->\n      <div class=\"modal-body\">\n        <slot />\n      </div>\n\n      <!-- Footer -->\n      {#if showFooter && $$slots.footer}\n        <div class=\"modal-footer\">\n          <slot name=\"footer\" />\n        </div>\n      {/if}\n    </div>\n  </div>\n{/if}\n\n<style>\n  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n     Modal Backdrop\n     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */\n\n  .modal-backdrop {\n    position: fixed;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    background-color: rgba(0, 0, 0, 0.7);\n    backdrop-filter: blur(4px);\n    -webkit-backdrop-filter: blur(4px);\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    z-index: var(--z-modal-backdrop);\n    padding: var(--spacing-lg);\n    animation: fadeIn var(--transition-base);\n  }\n\n  @keyframes fadeIn {\n    from {\n      opacity: 0;\n    }\n    to {\n      opacity: 1;\n    }\n  }\n\n  /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n     Modal Container\n     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */\n\n  .modal {\n    background-color: var(--color-surface-2);\n    border-radius: var(--radius-lg);\n    box-shadow: var(--shadow-xl);\n    display: flex;\n    flex-direction: column;\n    max-height: calc(100vh - var(--spacing-3xl));\n    overflow: hidden;\n    z-index: var(--z-modal);\n    animation: slideUp var(--transition-base);\n  }\n\n  @keyframes slideUp {\n    from {\n      opacity: 0;\n      transform: translateY(20px) scale(0.98);\n    }\n    to {\n      opacity: 1;\n      transform: translateY(0) scale(1);\n    }\n  }\n\n  /* Size variants */\n  .modal-sm {\n    width: 100%;\n    max-width: 400px;\n  }\n\n  .modal-md {\n    width: 100%;\n    max-width: 600px;\n  }\n\n  .modal-lg {\n    width: 100%;\n    max-width: 800px;\n  }\n\n  .modal-xl {\n    width: 100%;\n    max-width: 1200px;\n  }\n\n  .modal-full {\n    width: calc(100vw - var(--spacing-3xl));\n    max-width: none;\n    height: calc(100vh - var(--spacing-3xl));\n    max-height: none;\n  }\n\n  /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n     Modal Header\n     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */\n\n  .modal-header {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    padding: var(--spacing-lg) var(--spacing-xl);\n    border-bottom: 1px solid var(--color-border-subtle);\n    flex-shrink: 0;\n  }\n\n  .modal-title {\n    font-family: var(--font-family-heading);\n    font-size: 1.5rem;\n    font-weight: 300;\n    color: var(--color-text-primary);\n    margin: 0;\n    letter-spacing: 0.02em;\n  }\n\n  .modal-close {\n    width: 32px;\n    height: 32px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    background: transparent;\n    border: none;\n    color: var(--color-text-tertiary);\n    cursor: pointer;\n    border-radius: var(--radius-sm);\n    transition: all var(--transition-fast);\n    font-size: 1.25rem;\n    line-height: 1;\n    padding: 0;\n    margin-left: var(--spacing-md);\n  }\n\n  .modal-close:hover {\n    background-color: var(--color-surface-3);\n    color: var(--color-text-primary);\n  }\n\n  .modal-close:active {\n    background-color: var(--color-graphite);\n  }\n\n  /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n     Modal Body\n     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */\n\n  .modal-body {\n    flex: 1;\n    padding: var(--spacing-xl);\n    overflow-y: auto;\n    overflow-x: hidden;\n  }\n\n  /* Scrollbar styling */\n  .modal-body::-webkit-scrollbar {\n    width: 8px;\n  }\n\n  .modal-body::-webkit-scrollbar-track {\n    background: var(--color-surface-2);\n  }\n\n  .modal-body::-webkit-scrollbar-thumb {\n    background: var(--color-border-default);\n    border-radius: var(--radius-sm);\n  }\n\n  .modal-body::-webkit-scrollbar-thumb:hover {\n    background: var(--color-border-emphasis);\n  }\n\n  /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n     Modal Footer\n     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */\n\n  .modal-footer {\n    display: flex;\n    align-items: center;\n    justify-content: flex-end;\n    gap: var(--spacing-md);\n    padding: var(--spacing-lg) var(--spacing-xl);\n    border-top: 1px solid var(--color-border-subtle);\n    flex-shrink: 0;\n  }\n\n  /* â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\n     Responsive\n     â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */\n\n  @media (max-width: 768px) {\n    .modal-backdrop {\n      padding: 0;\n    }\n\n    .modal {\n      max-height: 100vh;\n      border-radius: 0;\n    }\n\n    .modal-sm,\n    .modal-md,\n    .modal-lg,\n    .modal-xl {\n      width: 100vw;\n      max-width: none;\n    }\n\n    .modal-full {\n      width: 100vw;\n      height: 100vh;\n    }\n  }\n</style>\n","<script lang=\"ts\">\n\timport { Panel, Badge, Button, Input, Select, Alert, DragDropWorkflow } from '$lib/components';\n\timport { skillRegistry } from '$lib/api/skillRegistry';\n\timport { onMount } from 'svelte';\n\timport type { Skill } from '$lib/api/types';\n\n\tinterface WorkflowStep {\n\t\tid: string;\n\t\tskillId: string;\n\t\tskillName: string;\n\t\torder: number;\n\t\tinputs: Record<string, any>;\n\t\tuseOutputFrom?: string; // Previous step ID\n\t}\n\n\tinterface Workflow {\n\t\tid: string;\n\t\tname: string;\n\t\tdescription: string;\n\t\tsteps: WorkflowStep[];\n\t\tcreatedAt: Date;\n\t\tlastRun?: Date;\n\t\tstatus: 'draft' | 'active' | 'archived';\n\t}\n\n\t// State\n\tlet workflows = $state<Workflow[]>([]);\n\tlet skills = $state<Skill[]>([]);\n\tlet loading = $state(true);\n\tlet selectedWorkflow = $state<Workflow | null>(null);\n\tlet isCreatingWorkflow = $state(false);\n\tlet newWorkflowName = $state('');\n\tlet newWorkflowDescription = $state('');\n\n\t// Load data\n\tonMount(async () => {\n\t\ttry {\n\t\t\tskills = await skillRegistry.getAllSkills();\n\t\t\tloadWorkflows();\n\t\t\tloading = false;\n\t\t} catch (err) {\n\t\t\tconsole.error('Failed to load data:', err);\n\t\t\tloading = false;\n\t\t}\n\t});\n\n\tfunction loadWorkflows() {\n\t\tconst stored = localStorage.getItem('workflows');\n\t\tif (stored) {\n\t\t\ttry {\n\t\t\t\tconst parsed = JSON.parse(stored);\n\t\t\t\tworkflows = parsed.map((w: any) => ({\n\t\t\t\t\t...w,\n\t\t\t\t\tcreatedAt: new Date(w.createdAt),\n\t\t\t\t\tlastRun: w.lastRun ? new Date(w.lastRun) : undefined\n\t\t\t\t}));\n\t\t\t} catch (err) {\n\t\t\t\tconsole.error('Failed to parse workflows:', err);\n\t\t\t\tworkflows = [];\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction saveWorkflows() {\n\t\tlocalStorage.setItem('workflows', JSON.stringify(workflows));\n\t}\n\n\tfunction createWorkflow() {\n\t\tif (!newWorkflowName.trim()) return;\n\n\t\tconst newWorkflow: Workflow = {\n\t\t\tid: `wf-${Date.now()}`,\n\t\t\tname: newWorkflowName,\n\t\t\tdescription: newWorkflowDescription,\n\t\t\tsteps: [],\n\t\t\tcreatedAt: new Date(),\n\t\t\tstatus: 'draft'\n\t\t};\n\n\t\tworkflows = [...workflows, newWorkflow];\n\t\tsaveWorkflows();\n\n\t\tselectedWorkflow = newWorkflow;\n\t\tisCreatingWorkflow = false;\n\t\tnewWorkflowName = '';\n\t\tnewWorkflowDescription = '';\n\t}\n\n\tfunction deleteWorkflow(workflowId: string) {\n\t\tworkflows = workflows.filter((w) => w.id !== workflowId);\n\t\tsaveWorkflows();\n\t\tif (selectedWorkflow?.id === workflowId) {\n\t\t\tselectedWorkflow = null;\n\t\t}\n\t}\n\n\tfunction addStep(workflowId: string, skillId: string) {\n\t\tconst skill = skills.find((s) => s.id === skillId);\n\t\tif (!skill) return;\n\n\t\tworkflows = workflows.map((w) => {\n\t\t\tif (w.id === workflowId) {\n\t\t\t\tconst newStep: WorkflowStep = {\n\t\t\t\t\tid: `step-${Date.now()}`,\n\t\t\t\t\tskillId: skill.id,\n\t\t\t\t\tskillName: skill.name,\n\t\t\t\t\torder: w.steps.length + 1,\n\t\t\t\t\tinputs: {}\n\t\t\t\t};\n\t\t\t\treturn {\n\t\t\t\t\t...w,\n\t\t\t\t\tsteps: [...w.steps, newStep]\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn w;\n\t\t});\n\n\t\tsaveWorkflows();\n\t\tselectedWorkflow = workflows.find((w) => w.id === workflowId) || null;\n\t}\n\n\tfunction removeStep(workflowId: string, stepId: string) {\n\t\tworkflows = workflows.map((w) => {\n\t\t\tif (w.id === workflowId) {\n\t\t\t\treturn {\n\t\t\t\t\t...w,\n\t\t\t\t\tsteps: w.steps.filter((s) => s.id !== stepId).map((s, i) => ({ ...s, order: i + 1 }))\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn w;\n\t\t});\n\n\t\tsaveWorkflows();\n\t\tselectedWorkflow = workflows.find((w) => w.id === workflowId) || null;\n\t}\n\n\tfunction getStatusVariant(status: Workflow['status']) {\n\t\tconst variants = {\n\t\t\tdraft: 'default' as const,\n\t\t\tactive: 'success' as const,\n\t\t\tarchived: 'warning' as const\n\t\t};\n\t\treturn variants[status];\n\t}\n\n\tlet stats = $derived.by(() => ({\n\t\ttotal: workflows.length,\n\t\tdraft: workflows.filter((w) => w.status === 'draft').length,\n\t\tactive: workflows.filter((w) => w.status === 'active').length,\n\t\tarchived: workflows.filter((w) => w.status === 'archived').length\n\t}));\n</script>\n\n<div class=\"workflows-container\">\n\t<!-- Page Header -->\n\t<div class=\"page-header\">\n\t\t<div class=\"header-content\">\n\t\t\t<h1 class=\"page-title\">Skill Workflows</h1>\n\t\t\t<p class=\"page-description\">\n\t\t\t\tBuild multi-step workflows by chaining skills together for complex automation\n\t\t\t</p>\n\t\t</div>\n\n\t\t<div class=\"stats-row\">\n\t\t\t<div class=\"stat-item\">\n\t\t\t\t<span class=\"stat-value\">{stats.total}</span>\n\t\t\t\t<span class=\"stat-label\">Total</span>\n\t\t\t</div>\n\t\t\t<div class=\"stat-item\">\n\t\t\t\t<span class=\"stat-value default\">{stats.draft}</span>\n\t\t\t\t<span class=\"stat-label\">Draft</span>\n\t\t\t</div>\n\t\t\t<div class=\"stat-item\">\n\t\t\t\t<span class=\"stat-value success\">{stats.active}</span>\n\t\t\t\t<span class=\"stat-label\">Active</span>\n\t\t\t</div>\n\t\t\t<div class=\"stat-item\">\n\t\t\t\t<span class=\"stat-value warning\">{stats.archived}</span>\n\t\t\t\t<span class=\"stat-label\">Archived</span>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\n\t<!-- Main Content -->\n\t<div class=\"content-grid\">\n\t\t<!-- Workflows List -->\n\t\t<Panel variant=\"bordered\" padding=\"lg\">\n\t\t\t<div class=\"section-header\">\n\t\t\t\t<h2>My Workflows</h2>\n\t\t\t\t<Button\n\t\t\t\t\tvariant=\"primary\"\n\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\ton:click={() => (isCreatingWorkflow = true)}\n\t\t\t\t\tdisabled={isCreatingWorkflow}\n\t\t\t\t>\n\t\t\t\t\t+ New Workflow\n\t\t\t\t</Button>\n\t\t\t</div>\n\n\t\t\t{#if isCreatingWorkflow}\n\t\t\t\t<Panel variant=\"elevated\" padding=\"md\">\n\t\t\t\t\t<div class=\"create-workflow-form\">\n\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\tlabel=\"Workflow Name\"\n\t\t\t\t\t\t\tbind:value={newWorkflowName}\n\t\t\t\t\t\t\tplaceholder=\"e.g., Code Review & Test\"\n\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t\tfullWidth\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\tlabel=\"Description\"\n\t\t\t\t\t\t\tbind:value={newWorkflowDescription}\n\t\t\t\t\t\t\tplaceholder=\"Describe what this workflow does...\"\n\t\t\t\t\t\t\tfullWidth\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<div class=\"form-actions\">\n\t\t\t\t\t\t\t<Button variant=\"primary\" on:click={createWorkflow} disabled={!newWorkflowName.trim()}>\n\t\t\t\t\t\t\t\tCreate\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t<Button variant=\"ghost\" on:click={() => (isCreatingWorkflow = false)}>\n\t\t\t\t\t\t\t\tCancel\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</Panel>\n\t\t\t{/if}\n\n\t\t\t{#if workflows.length === 0}\n\t\t\t\t<div class=\"empty-state\">\n\t\t\t\t\t<p>No workflows yet. Create your first workflow to get started.</p>\n\t\t\t\t</div>\n\t\t\t{:else}\n\t\t\t\t<div class=\"workflows-list\">\n\t\t\t\t\t{#each workflows as workflow (workflow.id)}\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclass=\"workflow-item\"\n\t\t\t\t\t\t\tclass:selected={selectedWorkflow?.id === workflow.id}\n\t\t\t\t\t\t\tonclick={() => (selectedWorkflow = workflow)}\n\t\t\t\t\t\t\tonkeydown={(e) => {\n\t\t\t\t\t\t\t\tif (e.key === 'Enter' || e.key === ' ') {\n\t\t\t\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\t\t\t\tselectedWorkflow = workflow;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\trole=\"button\"\n\t\t\t\t\t\t\ttabindex=\"0\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div class=\"workflow-info\">\n\t\t\t\t\t\t\t\t<div class=\"workflow-name\">{workflow.name}</div>\n\t\t\t\t\t\t\t\t<div class=\"workflow-description\">{workflow.description || 'No description'}</div>\n\t\t\t\t\t\t\t\t<div class=\"workflow-meta\">\n\t\t\t\t\t\t\t\t\t<Badge variant={getStatusVariant(workflow.status)} size=\"sm\">\n\t\t\t\t\t\t\t\t\t\t{workflow.status}\n\t\t\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t\t\t\t<span class=\"workflow-steps\">{workflow.steps.length} steps</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\tvariant=\"danger\"\n\t\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\t\ton:click={(e) => {\n\t\t\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t\t\tdeleteWorkflow(workflow.id);\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\tDelete\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t{/each}\n\t\t\t\t</div>\n\t\t\t{/if}\n\t\t</Panel>\n\n\t\t<!-- Workflow Details/Builder -->\n\t\t{#if selectedWorkflow}\n\t\t\t<DragDropWorkflow\n\t\t\t\tskills={skills}\n\t\t\t\tinitialSteps={selectedWorkflow.steps}\n\t\t\t\tonSave={(steps) => {\n\t\t\t\t\tworkflows = workflows.map((w) => {\n\t\t\t\t\t\tif (w.id === selectedWorkflow.id) {\n\t\t\t\t\t\t\treturn { ...w, steps };\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn w;\n\t\t\t\t\t});\n\t\t\t\t\tsaveWorkflows();\n\t\t\t\t\tselectedWorkflow = workflows.find((w) => w.id === selectedWorkflow.id) || null;\n\t\t\t\t}}\n\t\t\t\tonCancel={() => (selectedWorkflow = null)}\n\t\t\t/>\n\t\t{:else}\n\t\t\t<Panel variant=\"bordered\" padding=\"lg\">\n\t\t\t\t<div class=\"no-selection\">\n\t\t\t\t\t<p>Select a workflow from the list to view and edit its steps.</p>\n\t\t\t\t</div>\n\t\t\t</Panel>\n\t\t{/if}\n\t</div>\n</div>\n\n<style>\n\t/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n     Workflows Container\n     â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */\n\n\t.workflows-container {\n\t\tmax-width: 1400px;\n\t\tmargin: 0 auto;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: var(--spacing-xl);\n\t}\n\n\t/* Page Header */\n\t.page-header {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: var(--spacing-lg);\n\t}\n\n\t.header-content {\n\t\tflex: 1;\n\t}\n\n\t.page-title {\n\t\tfont-family: var(--font-family-heading);\n\t\tfont-size: 2.5rem;\n\t\tfont-weight: 300;\n\t\tcolor: var(--color-text-primary);\n\t\tmargin: 0 0 var(--spacing-sm) 0;\n\t\tletter-spacing: 0.02em;\n\t}\n\n\t.page-description {\n\t\tfont-size: 1.125rem;\n\t\tcolor: var(--color-text-secondary);\n\t\tmargin: 0;\n\t}\n\n\t.stats-row {\n\t\tdisplay: flex;\n\t\tgap: var(--spacing-xl);\n\t\tflex-wrap: wrap;\n\t}\n\n\t.stat-item {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: var(--spacing-xs);\n\t}\n\n\t.stat-value {\n\t\tfont-size: 2rem;\n\t\tfont-weight: 600;\n\t\tcolor: var(--color-text-primary);\n\t\tfont-family: var(--font-family-mono);\n\t}\n\n\t.stat-value.default {\n\t\tcolor: var(--color-cool-gray);\n\t}\n\n\t.stat-value.success {\n\t\tcolor: var(--color-success);\n\t}\n\n\t.stat-value.warning {\n\t\tcolor: var(--color-warning);\n\t}\n\n\t.stat-label {\n\t\tfont-size: 0.75rem;\n\t\tcolor: var(--color-text-tertiary);\n\t\ttext-transform: uppercase;\n\t\tletter-spacing: 0.05em;\n\t}\n\n\t/* Content Grid */\n\t.content-grid {\n\t\tdisplay: grid;\n\t\tgrid-template-columns: 400px 1fr;\n\t\tgap: var(--spacing-xl);\n\t}\n\n\t.section-header {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tmargin-bottom: var(--spacing-lg);\n\t}\n\n\th2 {\n\t\tfont-family: var(--font-family-heading);\n\t\tfont-size: 1.5rem;\n\t\tfont-weight: 300;\n\t\tcolor: var(--color-text-primary);\n\t\tmargin: 0;\n\t\tletter-spacing: 0.02em;\n\t}\n\n\th3 {\n\t\tfont-family: var(--font-family-heading);\n\t\tfont-size: 1.125rem;\n\t\tfont-weight: 300;\n\t\tcolor: var(--color-text-primary);\n\t\tmargin: 0 0 var(--spacing-md) 0;\n\t\tletter-spacing: 0.02em;\n\t}\n\n\t/* Create Workflow Form */\n\t.create-workflow-form {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: var(--spacing-md);\n\t}\n\n\t.form-actions {\n\t\tdisplay: flex;\n\t\tgap: var(--spacing-md);\n\t}\n\n\t/* Empty State */\n\t.empty-state {\n\t\tpadding: var(--spacing-xl);\n\t\ttext-align: center;\n\t\tcolor: var(--color-text-secondary);\n\t}\n\n\t/* Workflows List */\n\t.workflows-list {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: var(--spacing-md);\n\t}\n\n\t.workflow-item {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tgap: var(--spacing-md);\n\t\tpadding: var(--spacing-md);\n\t\tbackground-color: var(--color-surface-3);\n\t\tborder: 2px solid transparent;\n\t\tborder-radius: var(--radius-md);\n\t\tcursor: pointer;\n\t\ttransition: all var(--transition-fast);\n\t}\n\n\t.workflow-item:hover {\n\t\tbackground-color: var(--color-surface-elevated);\n\t\tborder-color: var(--color-border-default);\n\t}\n\n\t.workflow-item.selected {\n\t\tborder-color: var(--color-brass);\n\t\tbackground-color: var(--color-surface-elevated);\n\t}\n\n\t.workflow-info {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: var(--spacing-xs);\n\t\tflex: 1;\n\t}\n\n\t.workflow-name {\n\t\tfont-weight: 500;\n\t\tcolor: var(--color-text-primary);\n\t}\n\n\t.workflow-description {\n\t\tfont-size: 0.875rem;\n\t\tcolor: var(--color-text-secondary);\n\t}\n\n\t.workflow-meta {\n\t\tdisplay: flex;\n\t\tgap: var(--spacing-sm);\n\t\talign-items: center;\n\t}\n\n\t.workflow-steps {\n\t\tfont-size: 0.75rem;\n\t\tcolor: var(--color-text-tertiary);\n\t}\n\n\t/* Workflow Builder */\n\t.workflow-builder {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: var(--spacing-xl);\n\t}\n\n\t.builder-header {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t}\n\n\t.builder-description {\n\t\tcolor: var(--color-text-secondary);\n\t\tmargin: 0;\n\t}\n\n\t.steps-section,\n\t.add-step-section {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: var(--spacing-md);\n\t}\n\n\t.steps-list {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: var(--spacing-sm);\n\t}\n\n\t.step-card {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: var(--spacing-md);\n\t\tpadding: var(--spacing-md);\n\t\tbackground-color: var(--color-surface-3);\n\t\tborder-radius: var(--radius-md);\n\t}\n\n\t.step-number {\n\t\twidth: 32px;\n\t\theight: 32px;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tbackground-color: var(--color-brass);\n\t\tcolor: var(--color-midnight);\n\t\tborder-radius: 50%;\n\t\tfont-weight: 600;\n\t\tfont-size: 0.875rem;\n\t}\n\n\t.step-content {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: var(--spacing-xs);\n\t\tflex: 1;\n\t}\n\n\t.step-name {\n\t\tfont-weight: 500;\n\t\tcolor: var(--color-text-primary);\n\t}\n\n\t.step-id {\n\t\tfont-family: var(--font-family-mono);\n\t\tfont-size: 0.75rem;\n\t\tcolor: var(--color-text-tertiary);\n\t}\n\n\t.step-connector {\n\t\ttext-align: center;\n\t\tcolor: var(--color-brass);\n\t\tfont-size: 1.5rem;\n\t\tpadding: var(--spacing-xs) 0;\n\t}\n\n\t.no-selection {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tmin-height: 400px;\n\t\tcolor: var(--color-text-secondary);\n\t}\n\n\t/* Responsive */\n\t@media (max-width: 768px) {\n\t\t.page-title {\n\t\t\tfont-size: 2rem;\n\t\t}\n\n\t\t.stats-row {\n\t\t\tflex-direction: column;\n\t\t\tgap: var(--spacing-md);\n\t\t}\n\n\t\t.content-grid {\n\t\t\tgrid-template-columns: 1fr;\n\t\t}\n\t}\n</style>\n"],"names":["initialSteps","$.prop","$$props","workflowSteps","$.state","$.proxy","activeSkillId","activeStepId","isDraggingFromLibrary","configModalOpen","selectedStep","selectedStepInputsJson","validationErrors","lastSaved","history","historyIndex","sensors","useSensors","useSensor","PointerSensor","KeyboardSensor","canUndo","$.derived","$.get","canRedo","length","addToHistory","steps","slice","JSON","parse","stringify","timestamp","Date","now","$.set","undo","redo","saveStepConfig","index","findIndex","s","id","parsedInputs","inputs","onMount","$.user_effect","onSave","timeoutId","setTimeout","clearTimeout","errors","forEach","step","skill","skills","find","skillId","requiredInputs","input","useOutputFrom","push","stepId","message","stepMap","Map","map","visited","Set","current","has","add","next","get","validateWorkflow","handleKeyDown","e","metaKey","ctrlKey","key","shiftKey","preventDefault","window","addEventListener","removeEventListener","div_9","$.first_child","fragment_3","div_10","div_11","div_12","span","root_11","$.template_effect","$0","$.set_text","text_9","toLocaleTimeString","span_1","root_12","$$render","consequent_3","alternate","div_13","Button","node_8","node_9","node_10","onCancel","node_11","DndContext","node_12","closestCenter","event","active","activeId","startsWith","replace","over","overId","newStep","skillName","name","order","addSkillToWorkflow","oldIndex","newIndex","reordered","arrayMove","div_14","fragment_4","div_15","div_16","$.each","$$anchor","$$arg0","sortable","useSortable","div","root_1","attributes","listeners","transform","CSS","Transform","toString","node","$.child","Badge","text","category","div_1","$.sibling","strong","p","$.reset","text_1","text_2","description","$.append","SkillLibraryItem","div_17","h3","div_18","root_19","SortableContext","consequent_4","alternate_1","DragOverlay","node_15","div_19","root_25","node_18","text_15","strong_2","text_16","consequent_5","div_20","root_29","node_21","strong_3","text_18","consequent_7","consequent_8","consequent_6","alternate_2","text_14","div_21","root_31","Alert","node_23","strong_4","fragment_15","ul","node_24","error","li","root_33","text_20","li_1","root_34","consequent_9","text_19","consequent_10","open","title","size","closeOnBackdrop","closeOnEscape","showClose","showFooter","onClose","dispatch","createEventDispatcher","focusTrap","modalEl","$.mutable_source","handleBackdropClick","target","currentTarget","close","FocusTrap","activate","deactivate","sizeClass","sm","md","lg","xl","full","div_2","root_2","div_3","root_4","$.untrack","$$slots","header","consequent_1","consequent","button","root_5","$.event","consequent_2","div_4","div_5","root_6","footer","$$value","$.set_class","Modal","div_22","root_36","div_23","value","label","filter","Select","node_27","div_24","Textarea","node_28","div_25","node_29","node_30","consequent_11","workflows","loading","selectedWorkflow","isCreatingWorkflow","newWorkflowName","newWorkflowDescription","saveWorkflows","localStorage","setItem","createWorkflow","trim","newWorkflow","createdAt","status","async","skillRegistry","getAllSkills","stored","getItem","parsed","w","lastRun","err","loadWorkflows","stats","total","draft","archived","root","span_2","div_6","span_3","div_7","Panel","div_8","fragment","node_1","$$events","click","Input","node_3","node_4","node_5","node_6","root_7","root_8","workflow","root_9","__click","__keydown","span_4","workflowId","stopPropagation","classes","selected","text_7","DragDropWorkflow","root_14","text_3"],"mappings":"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"}