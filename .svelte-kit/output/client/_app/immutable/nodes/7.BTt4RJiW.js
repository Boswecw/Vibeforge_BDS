const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/B5wA7gKp.js","../chunks/CJ97sMGe.js","../chunks/duZwLxnm.js","../assets/LineChart.Barpiufm.css","../chunks/o3Czqw6I.js","../assets/BarChart.CDyFXi3S.css"])))=>i.map(i=>d[i]);
var Xt=Object.defineProperty;var Zt=(V,d,m)=>d in V?Xt(V,d,{enumerable:!0,configurable:!0,writable:!0,value:m}):V[d]=m;var Et=(V,d,m)=>Zt(V,typeof d!="symbol"?d+"":d,m);import{_ as Bt}from"../chunks/Dp1pzeXC.js";import{p as te,o as ee,b as se,g as t,s as St,f as b,i as Mt,h as c,j as ae,c as X,e as o,m as i,H as z,v as K,w as M,x as R,r,k as gt,d as w,q as k,Y as Ct,F as Vt,G as Nt,l as yt}from"../chunks/CJ97sMGe.js";import"../chunks/CUflB2Gp.js";import{B as wt,P as U}from"../chunks/D8s3w_7f.js";import{S as re}from"../chunks/Bo2G-ODY.js";import{B as xt}from"../chunks/DZ9aZlWI.js";class le{constructor(){Et(this,"storageKey","execution_history")}getHistory(){try{const d=localStorage.getItem(this.storageKey);return d?JSON.parse(d):[]}catch(d){return console.error("Failed to load history:",d),[]}}filterByTimeRange(d,m){if(m==="all")return d;const s=new Date;let e;switch(m){case"24h":e=new Date(s.getTime()-1440*60*1e3);break;case"7d":e=new Date(s.getTime()-10080*60*1e3);break;case"30d":e=new Date(s.getTime()-720*60*60*1e3);break;default:return d}return d.filter(L=>new Date(L.timestamp)>=e)}getAnalytics(d="7d"){const m=this.getHistory(),s=this.filterByTimeRange(m,d);if(s.length===0)return this.getEmptyAnalytics();const e=s.length,l=s.filter(g=>g.success).length/e*100,p=100-l,P=s.filter(g=>g.metadata.latency!==void 0).map(g=>g.metadata.latency),I=P.length>0?P.reduce((g,u)=>g+u,0)/P.length:0,Tt=s.reduce((g,u)=>g+(u.metadata.cost||0),0),W=new Map;s.forEach(g=>{W.has(g.skillId)||W.set(g.skillId,{entries:[],name:g.skillName}),W.get(g.skillId).entries.push(g)});const Z=Array.from(W.entries()).map(([g,{entries:u,name:q}])=>{const H=u.filter(T=>T.success).length,E=u.reduce((T,st)=>T+(st.metadata.cost||0),0),O=u.filter(T=>T.metadata.latency!==void 0).map(T=>T.metadata.latency),D=O.length>0?O.reduce((T,st)=>T+st,0)/O.length:0;return{skillId:g,skillName:q,count:u.length,successRate:H/u.length*100,avgCost:E/u.length,avgLatency:D}}).sort((g,u)=>u.count-g.count).slice(0,10),N=new Map;s.forEach(g=>{const u=g.metadata.model||"Unknown";N.has(u)||N.set(u,[]),N.get(u).push(g)});const tt=Array.from(N.entries()).map(([g,u])=>{const q=u.filter(D=>D.success).length,H=u.reduce((D,T)=>D+(T.metadata.cost||0),0),E=u.filter(D=>D.metadata.latency!==void 0).map(D=>D.metadata.latency),O=E.length>0?E.reduce((D,T)=>D+T,0)/E.length:0;return{model:g,count:u.length,avgResponseTime:O,totalCost:H,successRate:q/u.length*100}}).sort((g,u)=>u.count-g.count),et=this.generateTimeSeries(s,d),ht=this.generateCostTrend(s,d);return{totalInvocations:e,successRate:l,avgResponseTime:I,totalCost:Tt,topSkills:Z,modelUsage:tt,errorRate:p,timeSeriesData:et,costTrend:ht}}generateTimeSeries(d,m){const s=new Map,e=l=>m==="24h"?`${l.getFullYear()}-${String(l.getMonth()+1).padStart(2,"0")}-${String(l.getDate()).padStart(2,"0")} ${String(l.getHours()).padStart(2,"0")}:00`:`${l.getFullYear()}-${String(l.getMonth()+1).padStart(2,"0")}-${String(l.getDate()).padStart(2,"0")}`;return d.forEach(l=>{const p=e(new Date(l.timestamp));s.has(p)||s.set(p,[]),s.get(p).push(l)}),Array.from(s.entries()).map(([l,p])=>({date:l,invocations:p.length,errors:p.filter(P=>!P.success).length,cost:p.reduce((P,I)=>P+(I.metadata.cost||0),0)})).sort((l,p)=>l.date.localeCompare(p.date))}generateCostTrend(d,m){const s=new Map,e=l=>m==="24h"?`${l.getFullYear()}-${String(l.getMonth()+1).padStart(2,"0")}-${String(l.getDate()).padStart(2,"0")} ${String(l.getHours()).padStart(2,"0")}:00`:`${l.getFullYear()}-${String(l.getMonth()+1).padStart(2,"0")}-${String(l.getDate()).padStart(2,"0")}`;return d.forEach(l=>{const p=e(new Date(l.timestamp));s.has(p)||s.set(p,[]),s.get(p).push(l)}),Array.from(s.entries()).map(([l,p])=>({date:l,cost:p.reduce((P,I)=>P+(I.metadata.cost||0),0),invocations:p.length})).sort((l,p)=>l.date.localeCompare(p.date))}getEmptyAnalytics(){return{totalInvocations:0,successRate:0,avgResponseTime:0,totalCost:0,topSkills:[],modelUsage:[],errorRate:0,timeSeriesData:[],costTrend:[]}}exportToCSV(d="7d"){const m=this.getAnalytics(d),s=[];return s.push("Analytics Summary"),s.push(`Time Range,${d}`),s.push(`Total Invocations,${m.totalInvocations}`),s.push(`Success Rate,${m.successRate.toFixed(2)}%`),s.push(`Error Rate,${m.errorRate.toFixed(2)}%`),s.push(`Average Response Time,${m.avgResponseTime.toFixed(3)}s`),s.push(`Total Cost,$${m.totalCost.toFixed(4)}`),s.push(""),s.push("Top Skills by Usage"),s.push("Skill ID,Skill Name,Count,Success Rate,Avg Cost,Avg Latency"),m.topSkills.forEach(e=>{s.push(`${e.skillId},${e.skillName},${e.count},${e.successRate.toFixed(2)}%,$${e.avgCost.toFixed(4)},${e.avgLatency.toFixed(3)}s`)}),s.push(""),s.push("Model Usage Breakdown"),s.push("Model,Count,Avg Response Time,Total Cost,Success Rate"),m.modelUsage.forEach(e=>{s.push(`${e.model},${e.count},${e.avgResponseTime.toFixed(3)}s,$${e.totalCost.toFixed(4)},${e.successRate.toFixed(2)}%`)}),s.push(""),s.push("Time Series Data"),s.push("Date,Invocations,Errors,Cost"),m.timeSeriesData.forEach(e=>{s.push(`${e.date},${e.invocations},${e.errors},$${e.cost.toFixed(4)}`)}),s.join(`
`)}downloadCSV(d="7d"){const m=this.exportToCSV(d),s=new Blob([m],{type:"text/csv;charset=utf-8;"}),e=document.createElement("a"),L=URL.createObjectURL(s),l=new Date().toISOString().split("T")[0];e.setAttribute("href",L),e.setAttribute("download",`vibeforge_analytics_${d}_${l}.csv`),e.style.visibility="hidden",document.body.appendChild(e),e.click(),document.body.removeChild(e),URL.revokeObjectURL(L)}}const Ot=new le;var oe=b('<div class="loading-state svelte-1m0gshv"><div class="spinner svelte-1m0gshv"></div> <p>Loading analytics...</p></div>'),ie=b('<div class="metric-card svelte-1m0gshv"><div class="metric-icon svelte-1m0gshv">ðŸ“Š</div> <div class="metric-content svelte-1m0gshv"><div class="metric-label svelte-1m0gshv">Total Invocations</div> <div class="metric-value svelte-1m0gshv"> </div></div></div>'),ve=b('<div class="metric-card svelte-1m0gshv"><div class="metric-icon svelte-1m0gshv">âœ…</div> <div class="metric-content svelte-1m0gshv"><div class="metric-label svelte-1m0gshv">Success Rate</div> <div class="metric-value svelte-1m0gshv"><!></div></div></div>'),ne=b('<div class="metric-card svelte-1m0gshv"><div class="metric-icon svelte-1m0gshv">âš¡</div> <div class="metric-content svelte-1m0gshv"><div class="metric-label svelte-1m0gshv">Avg Response Time</div> <div class="metric-value svelte-1m0gshv"> </div></div></div>'),de=b('<div class="metric-card svelte-1m0gshv"><div class="metric-icon svelte-1m0gshv">ðŸ’°</div> <div class="metric-content svelte-1m0gshv"><div class="metric-label svelte-1m0gshv">Total Cost</div> <div class="metric-value svelte-1m0gshv"> </div></div></div>'),ce=b('<div class="chart-loading svelte-1m0gshv"><div class="spinner svelte-1m0gshv"></div> <p class="svelte-1m0gshv">Loading chart...</p></div>'),ge=b('<h2 class="chart-title svelte-1m0gshv">Invocations & Errors Over Time</h2> <!>',1),he=b('<div class="chart-loading svelte-1m0gshv"><div class="spinner svelte-1m0gshv"></div> <p class="svelte-1m0gshv">Loading chart...</p></div>'),me=b('<h2 class="chart-title svelte-1m0gshv">Cost Trend</h2> <!>',1),ue=b('<div class="chart-loading svelte-1m0gshv"><div class="spinner svelte-1m0gshv"></div> <p class="svelte-1m0gshv">Loading chart...</p></div>'),pe=b('<h2 class="chart-title svelte-1m0gshv">Top 10 Skills by Usage</h2> <!>',1),_e=b('<div class="chart-loading svelte-1m0gshv"><div class="spinner svelte-1m0gshv"></div> <p class="svelte-1m0gshv">Loading chart...</p></div>'),$e=b('<h2 class="chart-title svelte-1m0gshv">Model Usage Distribution</h2> <!>',1),fe=b('<tr class="svelte-1m0gshv"><td class="svelte-1m0gshv"><!></td><td class="svelte-1m0gshv"><div class="skill-name svelte-1m0gshv"> </div> <div class="skill-id svelte-1m0gshv"> </div></td><td class="text-right svelte-1m0gshv"> </td><td class="text-right svelte-1m0gshv"><!></td><td class="text-right svelte-1m0gshv"> </td><td class="text-right svelte-1m0gshv"> </td></tr>'),be=b('<h2 class="section-title svelte-1m0gshv">Top Skills by Usage</h2> <div class="table-container svelte-1m0gshv"><table class="skills-table svelte-1m0gshv"><thead><tr class="svelte-1m0gshv"><th class="svelte-1m0gshv">Rank</th><th class="svelte-1m0gshv">Skill</th><th class="text-right svelte-1m0gshv">Usage</th><th class="text-right svelte-1m0gshv">Success Rate</th><th class="text-right svelte-1m0gshv">Avg Cost</th><th class="text-right svelte-1m0gshv">Avg Latency</th></tr></thead><tbody></tbody></table></div>',1),Se=b('<tr class="svelte-1m0gshv"><td class="svelte-1m0gshv"><div class="model-name svelte-1m0gshv"> </div></td><td class="text-right svelte-1m0gshv"> </td><td class="text-right svelte-1m0gshv"><!></td><td class="text-right svelte-1m0gshv"> </td><td class="text-right svelte-1m0gshv"> </td></tr>'),Ce=b('<h2 class="section-title svelte-1m0gshv">Model Usage Statistics</h2> <div class="table-container svelte-1m0gshv"><table class="skills-table svelte-1m0gshv"><thead><tr class="svelte-1m0gshv"><th class="svelte-1m0gshv">Model</th><th class="text-right svelte-1m0gshv">Usage</th><th class="text-right svelte-1m0gshv">Success Rate</th><th class="text-right svelte-1m0gshv">Avg Response Time</th><th class="text-right svelte-1m0gshv">Total Cost</th></tr></thead><tbody></tbody></table></div>',1),ye=b('<div class="metrics-grid svelte-1m0gshv"><!> <!> <!> <!></div> <div class="charts-row svelte-1m0gshv"><!></div> <div class="charts-row svelte-1m0gshv"><!></div> <div class="charts-grid svelte-1m0gshv"><!> <!></div> <!> <!>',1),xe=b('<div class="empty-state svelte-1m0gshv"><div class="empty-icon svelte-1m0gshv">ðŸ“Š</div> <h2 class="empty-title svelte-1m0gshv">No Analytics Data Available</h2> <p class="empty-message svelte-1m0gshv">Start using skills to see analytics and insights. Your usage statistics will appear here.</p> <!></div>'),Te=b('<div class="analytics-container svelte-1m0gshv"><div class="page-header svelte-1m0gshv"><div class="header-content svelte-1m0gshv"><h1 class="page-title svelte-1m0gshv">Analytics Dashboard</h1> <p class="page-description svelte-1m0gshv">Track usage, performance, and costs across all skills</p></div> <div class="header-actions svelte-1m0gshv"><!> <!> <!></div></div> <!></div>');function Fe(V,d){te(d,!0);const m=Bt(()=>import("../chunks/B5wA7gKp.js"),__vite__mapDeps([0,1,2,3]),import.meta.url),s=Bt(()=>import("../chunks/o3Czqw6I.js"),__vite__mapDeps([4,1,2,5]),import.meta.url);let e=St(null),L=St(!0),l=St("7d"),p=St(!1);const P=[{value:"24h",label:"Last 24 Hours"},{value:"7d",label:"Last 7 Days"},{value:"30d",label:"Last 30 Days"},{value:"all",label:"All Time"}];ee(()=>{I()});function I(){X(L,!0);try{X(e,Ot.getAnalytics(t(l)),!0)}catch(a){console.error("Failed to load analytics:",a)}finally{X(L,!1)}}function Tt(){X(p,!0),setTimeout(()=>{I(),X(p,!1)},500)}function W(){try{Ot.downloadCSV(t(l))}catch(a){console.error("Failed to export CSV:",a),alert("Failed to export CSV. Please try again.")}}se(()=>{t(l),I()});function Z(a){return`$${a.toFixed(4)}`}function N(a){return`${a.toFixed(1)}%`}function tt(a){return a<1?`${(a*1e3).toFixed(0)}ms`:`${a.toFixed(2)}s`}function et(a){return a>=95?"success":a>=85?"warning":"error"}let ht=k(()=>t(e)?{labels:t(e).timeSeriesData.map(a=>a.date),datasets:[{label:"Invocations",data:t(e).timeSeriesData.map(a=>a.invocations),borderColor:"rgb(197, 167, 123)",backgroundColor:"rgba(197, 167, 123, 0.1)",fill:!0,tension:.4},{label:"Errors",data:t(e).timeSeriesData.map(a=>a.errors),borderColor:"rgb(220, 68, 68)",backgroundColor:"rgba(220, 68, 68, 0.1)",fill:!0,tension:.4}]}:{labels:[],datasets:[]}),g=k(()=>t(e)?{labels:t(e).costTrend.map(a=>a.date),datasets:[{label:"Cost ($)",data:t(e).costTrend.map(a=>a.cost),borderColor:"rgb(45, 212, 191)",backgroundColor:"rgba(45, 212, 191, 0.1)",fill:!0,tension:.4}]}:{labels:[],datasets:[]}),u=k(()=>t(e)?{labels:t(e).topSkills.slice(0,10).map(a=>a.skillName),datasets:[{label:"Usage Count",data:t(e).topSkills.slice(0,10).map(a=>a.count),backgroundColor:t(e).topSkills.slice(0,10).map(()=>"rgba(197, 167, 123, 0.7)"),borderColor:t(e).topSkills.slice(0,10).map(()=>"rgb(197, 167, 123)"),borderWidth:1}]}:{labels:[],datasets:[]}),q=k(()=>{if(!t(e))return{labels:[],datasets:[]};const a=["rgba(197, 167, 123, 0.7)","rgba(45, 212, 191, 0.7)","rgba(99, 102, 241, 0.7)","rgba(236, 72, 153, 0.7)"];return{labels:t(e).modelUsage.map(A=>A.model),datasets:[{label:"Usage Count",data:t(e).modelUsage.map(A=>A.count),backgroundColor:a.slice(0,t(e).modelUsage.length),borderColor:a.map(A=>A.replace("0.7","1")).slice(0,t(e).modelUsage.length),borderWidth:1}]}});var H=Te(),E=i(H),O=o(i(E),2),D=i(O);re(D,{get options(){return P},get value(){return t(l)},set value(a){X(l,a,!0)}});var T=o(D,2);wt(T,{variant:"secondary",size:"sm",onclick:Tt,get loading(){return t(p)},children:(a,A)=>{z();var G=K();M(()=>R(G,t(p)?"Refreshing...":"Refresh")),c(a,G)},$$slots:{default:!0}});var st=o(T,2);wt(st,{variant:"primary",size:"sm",onclick:W,children:(a,A)=>{z();var G=K("Export CSV");c(a,G)},$$slots:{default:!0}}),r(O),r(E);var Ht=o(E,2);{var Yt=a=>{var A=oe();c(a,A)},jt=a=>{var A=gt(),G=w(A);{var zt=J=>{var mt=ye(),ut=w(mt),Q=i(ut);U(Q,{variant:"bordered",padding:"lg",children:(S,B)=>{var v=ie(),_=o(i(v),2),n=o(i(_),2),h=i(n,!0);r(n),r(_),r(v),M(C=>R(h,C),[()=>t(e).totalInvocations.toLocaleString()]),c(S,v)},$$slots:{default:!0}});var pt=o(Q,2);U(pt,{variant:"bordered",padding:"lg",children:(S,B)=>{var v=ve(),_=o(i(v),2),n=o(i(_),2),h=i(n);{let C=k(()=>et(t(e).successRate));xt(h,{get variant(){return t(C)},children:($,y)=>{z();var x=K();M(f=>R(x,f),[()=>N(t(e).successRate)]),c($,x)},$$slots:{default:!0}})}r(n),r(_),r(v),c(S,v)},$$slots:{default:!0}});var _t=o(pt,2);U(_t,{variant:"bordered",padding:"lg",children:(S,B)=>{var v=ne(),_=o(i(v),2),n=o(i(_),2),h=i(n,!0);r(n),r(_),r(v),M(C=>R(h,C),[()=>tt(t(e).avgResponseTime)]),c(S,v)},$$slots:{default:!0}});var Lt=o(_t,2);U(Lt,{variant:"bordered",padding:"lg",children:(S,B)=>{var v=de(),_=o(i(v),2),n=o(i(_),2),h=i(n,!0);r(n),r(_),r(v),M(C=>R(h,C),[()=>Z(t(e).totalCost)]),c(S,v)},$$slots:{default:!0}}),r(ut);var at=o(ut,2),Wt=i(at);U(Wt,{variant:"bordered",padding:"lg",children:(S,B)=>{var v=ge(),_=o(w(v),2);Ct(_,()=>m,n=>{var h=ce();c(n,h)},(n,h)=>{var C=k(()=>{var{default:f}=t(h);return{LineChart:f}}),$=k(()=>t(C).LineChart),y=gt(),x=w(y);yt(x,()=>t($),(f,F)=>{F(f,{get labels(){return t(ht).labels},get datasets(){return t(ht).datasets},height:300})}),c(n,y)}),c(S,v)},$$slots:{default:!0}}),r(at);var Rt=o(at,2),qt=i(Rt);U(qt,{variant:"bordered",padding:"lg",children:(S,B)=>{var v=me(),_=o(w(v),2);Ct(_,()=>m,n=>{var h=he();c(n,h)},(n,h)=>{var C=k(()=>{var{default:f}=t(h);return{LineChart:f}}),$=k(()=>t(C).LineChart),y=gt(),x=w(y);yt(x,()=>t($),(f,F)=>{F(f,{get labels(){return t(g).labels},get datasets(){return t(g).datasets},height:300})}),c(n,y)}),c(S,v)},$$slots:{default:!0}}),r(Rt);var kt=o(Rt,2),Pt=i(kt);U(Pt,{variant:"bordered",padding:"lg",children:(S,B)=>{var v=pe(),_=o(w(v),2);Ct(_,()=>s,n=>{var h=ue();c(n,h)},(n,h)=>{var C=k(()=>{var{default:f}=t(h);return{BarChart:f}}),$=k(()=>t(C).BarChart),y=gt(),x=w(y);yt(x,()=>t($),(f,F)=>{F(f,{get labels(){return t(u).labels},get datasets(){return t(u).datasets},height:350,horizontal:!0})}),c(n,y)}),c(S,v)},$$slots:{default:!0}});var Gt=o(Pt,2);U(Gt,{variant:"bordered",padding:"lg",children:(S,B)=>{var v=$e(),_=o(w(v),2);Ct(_,()=>s,n=>{var h=_e();c(n,h)},(n,h)=>{var C=k(()=>{var{default:f}=t(h);return{BarChart:f}}),$=k(()=>t(C).BarChart),y=gt(),x=w(y);yt(x,()=>t($),(f,F)=>{F(f,{get labels(){return t(q).labels},get datasets(){return t(q).datasets},height:350})}),c(n,y)}),c(S,v)},$$slots:{default:!0}}),r(kt);var Ft=o(kt,2);U(Ft,{variant:"bordered",padding:"lg",children:(S,B)=>{var v=be(),_=o(w(v),2),n=i(_),h=o(i(n));Vt(h,21,()=>t(e).topSkills.slice(0,10),Nt,(C,$,y)=>{var x=fe(),f=i(x),F=i(f);xt(F,{variant:"default",children:(ct,bt)=>{z();var At=K();At.nodeValue=y+1,c(ct,At)},$$slots:{default:!0}}),r(f);var Y=o(f),rt=i(Y),lt=i(rt,!0);r(rt);var $t=o(rt,2),ot=i($t,!0);r($t),r(Y);var it=o(Y),ft=i(it,!0);r(it);var vt=o(it),nt=i(vt);{let ct=k(()=>et(t($).successRate));xt(nt,{get variant(){return t(ct)},children:(bt,At)=>{z();var It=K();M(Qt=>R(It,Qt),[()=>N(t($).successRate)]),c(bt,It)},$$slots:{default:!0}})}r(vt);var j=o(vt),Ut=i(j,!0);r(j);var dt=o(j),Dt=i(dt,!0);r(dt),r(x),M((ct,bt)=>{R(lt,t($).skillName),R(ot,t($).skillId),R(ft,t($).count),R(Ut,ct),R(Dt,bt)},[()=>Z(t($).avgCost),()=>tt(t($).avgLatency)]),c(C,x)}),r(h),r(n),r(_),c(S,v)},$$slots:{default:!0}});var Jt=o(Ft,2);U(Jt,{variant:"bordered",padding:"lg",children:(S,B)=>{var v=Ce(),_=o(w(v),2),n=i(_),h=o(i(n));Vt(h,21,()=>t(e).modelUsage,Nt,(C,$)=>{var y=Se(),x=i(y),f=i(x),F=i(f,!0);r(f),r(x);var Y=o(x),rt=i(Y,!0);r(Y);var lt=o(Y),$t=i(lt);{let nt=k(()=>et(t($).successRate));xt($t,{get variant(){return t(nt)},children:(j,Ut)=>{z();var dt=K();M(Dt=>R(dt,Dt),[()=>N(t($).successRate)]),c(j,dt)},$$slots:{default:!0}})}r(lt);var ot=o(lt),it=i(ot,!0);r(ot);var ft=o(ot),vt=i(ft,!0);r(ft),r(y),M((nt,j)=>{R(F,t($).model),R(rt,t($).count),R(it,nt),R(vt,j)},[()=>tt(t($).avgResponseTime),()=>Z(t($).totalCost)]),c(C,y)}),r(h),r(n),r(_),c(S,v)},$$slots:{default:!0}}),c(J,mt)},Kt=J=>{U(J,{variant:"elevated",padding:"lg",children:(mt,ut)=>{var Q=xe(),pt=o(i(Q),6);wt(pt,{variant:"primary",href:"/library",children:(_t,Lt)=>{z();var at=K("Browse Skills");c(_t,at)},$$slots:{default:!0}}),r(Q),c(mt,Q)},$$slots:{default:!0}})};Mt(G,J=>{t(e)&&t(e).totalInvocations>0?J(zt):J(Kt,!1)},!0)}c(a,A)};Mt(Ht,a=>{t(L)?a(Yt):a(jt,!1)})}r(H),c(V,H),ae()}export{Fe as component};
