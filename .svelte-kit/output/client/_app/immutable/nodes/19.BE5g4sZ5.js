import{p as Wt,s as T,R as we,o as zt,f as m,i as y,w as k,h as l,j as At,e as r,m as s,c as v,v as S,g as e,q as J,r as t,H as x,x as c,k as Ke,d as Re,F as Qe,G as Ht,O as it,V as nt,Z as Mt}from"../chunks/DkYuCCRR.js";import{s as qt}from"../chunks/v9ZTRfye.js";import{f as Bt}from"../chunks/DZdTBaFY.js";import"../chunks/ZXpR-Cq1.js";import{P as Oe,B as ie}from"../chunks/NBWhFnqU.js";import{I as $e}from"../chunks/DJ6tW-_S.js";import{S as ot}from"../chunks/CzJ_pneL.js";import{T as dt}from"../chunks/CpbF74mb.js";import{B as be}from"../chunks/BZBw9RiU.js";import{A as Ft}from"../chunks/B_6VVtGD.js";var Lt=m('<div class="view-tabs svelte-6vfrt7"><!> <!></div>'),Jt=m('<div class="loading-state svelte-6vfrt7"><div class="spinner svelte-6vfrt7"></div> <p>Loading skills...</p></div>'),Gt=m('<span class="helper-text svelte-6vfrt7"> </span>'),Ut=m('<label class="checkbox-label svelte-6vfrt7"><input type="checkbox" class="svelte-6vfrt7"/> <span> </span> <!></label>'),jt=m('<div class="input-field svelte-6vfrt7"><!></div>'),Vt=m('<div class="skill-info svelte-6vfrt7"><!> <p class="skill-description svelte-6vfrt7"> </p></div> <div class="inputs-section svelte-6vfrt7"><h3 class="subsection-title svelte-6vfrt7">Test Inputs</h3> <!></div> <div class="assertion-section svelte-6vfrt7"><h3 class="subsection-title svelte-6vfrt7">Assertion</h3> <label class="checkbox-label svelte-6vfrt7"><input type="checkbox" class="svelte-6vfrt7"/> <span>Use regex pattern matching</span></label> <!></div> <div class="options-section svelte-6vfrt7"><h3 class="subsection-title svelte-6vfrt7">Execution Options</h3> <!> <!> <!></div> <!>',1),Zt=m('<div class="panel-section svelte-6vfrt7"><h2 class="section-title svelte-6vfrt7">Create Test Case</h2> <div class="form-section svelte-6vfrt7"><!> <!> <!></div></div>'),Ct=m('<div class="empty-state svelte-6vfrt7"><p class="empty-message svelte-6vfrt7">No test cases created yet.</p> <p class="empty-hint svelte-6vfrt7">Create a test case on the left to get started.</p></div>'),Kt=m('<div class="result-error svelte-6vfrt7"><span class="result-label svelte-6vfrt7">Error:</span> <span class="error-message svelte-6vfrt7"> </span></div>'),Qt=m('<div class="test-result svelte-6vfrt7"><div class="result-details svelte-6vfrt7"><span class="result-label svelte-6vfrt7">Execution Time:</span> <span class="result-value svelte-6vfrt7"> </span></div> <div class="result-details svelte-6vfrt7"><span class="result-label svelte-6vfrt7">Match:</span> <span class="result-value svelte-6vfrt7"> </span></div> <!></div>'),Xt=m('<div class="test-case-card svelte-6vfrt7"><div class="test-case-header svelte-6vfrt7"><div class="test-info svelte-6vfrt7"><h3 class="test-name svelte-6vfrt7"> </h3> <div class="test-meta svelte-6vfrt7"><!> <!></div></div> <div class="test-actions svelte-6vfrt7"><!> <!></div></div> <!></div>'),Yt=m('<div class="test-cases-list svelte-6vfrt7"></div>'),es=m('<div class="panel-section svelte-6vfrt7"><div class="section-header svelte-6vfrt7"><h2 class="section-title svelte-6vfrt7"> </h2> <!></div> <!></div>'),ts=m('<div class="builder-layout svelte-6vfrt7"><!> <!></div>'),ss=m('<div class="empty-state svelte-6vfrt7"><p class="empty-message svelte-6vfrt7">No test results yet.</p> <p class="empty-hint svelte-6vfrt7">Run some tests to see results here.</p></div>'),as=m('<div class="detail-row error svelte-6vfrt7"><span class="detail-label svelte-6vfrt7">Error:</span> <span class="detail-value svelte-6vfrt7"> </span></div>'),rs=m('<div class="history-item svelte-6vfrt7"><div class="history-header svelte-6vfrt7"><div class="history-info svelte-6vfrt7"><h3 class="history-title svelte-6vfrt7"> </h3> <div class="history-meta svelte-6vfrt7"><span class="timestamp svelte-6vfrt7"> </span> <!> <span class="execution-time svelte-6vfrt7"> </span></div></div></div> <div class="history-details svelte-6vfrt7"><div class="detail-row svelte-6vfrt7"><span class="detail-label svelte-6vfrt7">Match Details:</span> <span class="detail-value svelte-6vfrt7"> </span></div> <!> <div class="detail-row svelte-6vfrt7"><span class="detail-label svelte-6vfrt7">Output:</span> <pre class="output-preview svelte-6vfrt7"> </pre></div></div></div>'),ls=m('<div class="history-list svelte-6vfrt7"></div>'),vs=m('<div class="panel-section svelte-6vfrt7"><div class="section-header svelte-6vfrt7"><h2 class="section-title svelte-6vfrt7"> </h2> <!></div> <!></div>'),is=m('<div class="testing-container svelte-6vfrt7"><div class="page-header svelte-6vfrt7"><div class="header-content svelte-6vfrt7"><h1 class="page-title svelte-6vfrt7">Skill Testing Lab</h1> <p class="page-description svelte-6vfrt7">Create, run, and manage automated tests for your skills</p></div> <div class="stats-row svelte-6vfrt7"><div class="stat-item svelte-6vfrt7"><span class="stat-value svelte-6vfrt7"> </span> <span class="stat-label svelte-6vfrt7">Total Tests</span></div> <div class="stat-item svelte-6vfrt7"><span class="stat-value success svelte-6vfrt7"> </span> <span class="stat-label svelte-6vfrt7">Passed</span></div> <div class="stat-item svelte-6vfrt7"><span class="stat-value error svelte-6vfrt7"> </span> <span class="stat-label svelte-6vfrt7">Failed</span></div> <div class="stat-item svelte-6vfrt7"><span class="stat-value warning svelte-6vfrt7"> </span> <span class="stat-label svelte-6vfrt7">Not Run</span></div></div></div> <!> <!> <!></div>');function gs(ut,ct){Wt(ct,!0);let Se=T(we([])),f=T(we([])),W=T(we([])),De=T(!0),ne=T(null),Ie=T(""),pe=T(""),V=T(we({})),ye=T(""),Te=T(""),fe=T(!1),Ne=T("gpt-4o-mini"),Ee=T(.7),We=T(4096),ze=T(null),_e=T("builder"),te=J(()=>e(Se).find(a=>a.id===e(Ie))||null),pt=J(()=>e(Se).map(a=>({value:a.id,label:`${a.name} (${a.category})`}))),ke=J(()=>({total:e(f).length,passed:e(f).filter(a=>{var n;return((n=a.lastResult)==null?void 0:n.passed)===!0}).length,failed:e(f).filter(a=>{var n;return((n=a.lastResult)==null?void 0:n.passed)===!1}).length,notRun:e(f).filter(a=>!a.lastResult).length}));const ft=[{value:"gpt-4o",label:"GPT-4o"},{value:"gpt-4o-mini",label:"GPT-4o Mini"},{value:"claude-3-5-sonnet-20241022",label:"Claude 3.5 Sonnet"},{value:"claude-3-5-haiku-20241022",label:"Claude 3.5 Haiku"}];zt(async()=>{try{v(Se,await qt.getAllSkills(),!0),_t(),mt(),v(De,!1)}catch(a){v(ne,a instanceof Error?a.message:"Failed to load skills",!0),v(De,!1)}});function _t(){const a=localStorage.getItem("vibeforge_test_cases");a&&v(f,JSON.parse(a,(n,$)=>n==="createdAt"||n==="lastRun"||n==="timestamp"?new Date($):$),!0)}function Pe(){localStorage.setItem("vibeforge_test_cases",JSON.stringify(e(f)))}function mt(){const a=localStorage.getItem("vibeforge_test_history");a&&v(W,JSON.parse(a,(n,$)=>n==="timestamp"?new Date($):$),!0)}function Ae(){localStorage.setItem("vibeforge_test_history",JSON.stringify(e(W)))}function ht(){if(!e(te)||!e(pe).trim()){v(ne,"Please select a skill and provide a test name");return}const a={id:`test-${Date.now()}`,name:e(pe),skillId:e(te).id,skillName:e(te).name,inputs:{...e(V)},expectedOutput:e(fe)?void 0:e(ye),expectedPattern:e(fe)?e(Te):void 0,executionOptions:{model:e(Ne),temperature:e(Ee),max_tokens:e(We)},createdAt:new Date};v(f,[...e(f),a],!0),Pe(),v(pe,""),v(V,{},!0),v(ye,""),v(Te,""),v(ne,null)}function gt(a){v(f,e(f).filter(n=>n.id!==a),!0),Pe(),v(W,e(W).filter(n=>n.testCaseId!==a),!0),Ae()}async function Xe(a){v(ze,a.id,!0),v(ne,null);const n=Date.now();try{const $=await Bt.invokeSkill(a.skillId,{inputs:a.inputs,options:a.executionOptions}),z=Date.now()-n,A=$.output;let b=!1,w="";if(a.expectedPattern)b=new RegExp(a.expectedPattern,"i").test(A),w=b?`Output matched pattern: ${a.expectedPattern}`:`Output did not match pattern: ${a.expectedPattern}`;else if(a.expectedOutput){const P=a.expectedOutput.trim().toLowerCase(),C=A.trim().toLowerCase();b=C.includes(P)||P.includes(C),w=b?"Output matched expected result":"Output did not match expected result"}else b=!0,w="No assertion defined - execution successful";const Z={passed:b,actualOutput:A,executionTime:z,matchDetails:w,timestamp:new Date};v(f,e(f).map(P=>P.id===a.id?{...P,lastRun:new Date,lastResult:Z}:P),!0),Pe();const H={id:`run-${Date.now()}`,testCaseId:a.id,result:Z,timestamp:new Date};v(W,[H,...e(W)],!0),Ae()}catch($){const z={passed:!1,actualOutput:"",executionTime:Date.now()-n,error:$ instanceof Error?$.message:"Execution failed",timestamp:new Date};v(f,e(f).map(A=>A.id===a.id?{...A,lastRun:new Date,lastResult:z}:A),!0),Pe()}finally{v(ze,null)}}async function xt(){for(const a of e(f))await Xe(a)}function $t(){v(W,[],!0),Ae()}var He=is(),Me=s(He),Ye=r(s(Me),2),qe=s(Ye),et=s(qe),bt=s(et,!0);t(et),x(2),t(qe);var Be=r(qe,2),tt=s(Be),yt=s(tt,!0);t(tt),x(2),t(Be);var Fe=r(Be,2),st=s(Fe),Tt=s(st,!0);t(st),x(2),t(Fe);var at=r(Fe,2),rt=s(at),kt=s(rt,!0);t(rt),x(2),t(at),t(Ye),t(Me);var lt=r(Me,2);Oe(lt,{variant:"bordered",padding:"md",children:(a,n)=>{var $=Lt(),z=s($);{let b=J(()=>e(_e)==="builder"?"primary":"ghost");ie(z,{get variant(){return e(b)},$$events:{click:()=>v(_e,"builder")},children:(w,Z)=>{x();var H=S("Test Builder");l(w,H)},$$slots:{default:!0}})}var A=r(z,2);{let b=J(()=>e(_e)==="results"?"primary":"ghost");ie(A,{get variant(){return e(b)},$$events:{click:()=>v(_e,"results")},children:(w,Z)=>{x();var H=S("Test Results");l(w,H)},$$slots:{default:!0}})}t($),l(a,$)},$$slots:{default:!0}});var vt=r(lt,2);{var Pt=a=>{Ft(a,{variant:"error",title:"Error",children:(n,$)=>{x();var z=S();k(()=>c(z,e(ne))),l(n,z)},$$slots:{default:!0}})};y(vt,a=>{e(ne)&&a(Pt)})}var wt=r(vt,2);{var Rt=a=>{var n=Jt();l(a,n)},Ot=a=>{var n=Ke(),$=Re(n);{var z=b=>{var w=ts(),Z=s(w);Oe(Z,{variant:"bordered",padding:"lg",children:(P,C)=>{var G=Zt(),K=r(s(G),2),Q=s(K);$e(Q,{type:"text",label:"Test Name",placeholder:"e.g., Test code generation for Python",required:!0,fullWidth:!0,get value(){return e(pe)},set value(_){v(pe,_,!0)}});var oe=r(Q,2);ot(oe,{label:"Skill to Test",get options(){return e(pt)},placeholder:"Select a skill...",required:!0,fullWidth:!0,get value(){return e(Ie)},set value(_){v(Ie,_,!0)}});var me=r(oe,2);{var he=_=>{var D=Vt(),B=Re(D),o=s(B);be(o,{variant:"info",size:"sm",children:(d,N)=>{x();var q=S();k(()=>c(q,e(te).category)),l(d,q)},$$slots:{default:!0}});var I=r(o,2),F=s(I,!0);t(I),t(B);var p=r(B,2),X=r(s(p),2);Qe(X,17,()=>Object.entries(e(te).inputs),Ht,(d,N)=>{var q=J(()=>Mt(e(N),2));let i=()=>e(q)[0],u=()=>e(q)[1];var g=jt(),h=s(g);{var R=O=>{dt(O,{get label(){return i()},get helperText(){return u().description},get required(){return u().required},fullWidth:!0,get value(){return e(V)[i()]},set value(ce){e(V)[i()]=ce}})},E=O=>{var ce=Ke(),Le=Re(ce);{var Je=L=>{$e(L,{type:"number",get label(){return i()},get helperText(){return u().description},get required(){return u().required},fullWidth:!0,get value(){return e(V)[i()]},set value(ve){e(V)[i()]=ve}})},ge=L=>{var ve=Ke(),Ge=Re(ve);{var St=Ue=>{var je=Ut(),Ve=s(je);it(Ve);var Ze=r(Ve,2),Dt=s(Ze,!0);t(Ze);var It=r(Ze,2);{var Nt=xe=>{var Ce=Gt(),Et=s(Ce,!0);t(Ce),k(()=>c(Et,u().description)),l(xe,Ce)};y(It,xe=>{u().description&&xe(Nt)})}t(je),k(()=>c(Dt,i())),nt(Ve,()=>e(V)[i()],xe=>e(V)[i()]=xe),l(Ue,je)};y(Ge,Ue=>{u().type==="boolean"&&Ue(St)},!0)}l(L,ve)};y(Le,L=>{u().type==="number"?L(Je):L(ge,!1)},!0)}l(O,ce)};y(h,O=>{u().type==="string"?O(R):O(E,!1)})}t(g),l(d,g)}),t(p);var M=r(p,2),U=r(s(M),2),j=s(U);it(j),x(2),t(U);var se=r(U,2);{var de=d=>{$e(d,{type:"text",label:"Expected Pattern (Regex)",placeholder:"e.g., function.*calculate",helperText:"Regular expression to match against output",fullWidth:!0,get value(){return e(Te)},set value(N){v(Te,N,!0)}})},ae=d=>{dt(d,{label:"Expected Output",placeholder:"Enter the expected output (or leave empty for no assertion)",helperText:"Test will check if output contains this text",fullWidth:!0,get value(){return e(ye)},set value(N){v(ye,N,!0)}})};y(se,d=>{e(fe)?d(de):d(ae,!1)})}t(M);var Y=r(M,2),ue=r(s(Y),2);ot(ue,{label:"Model",get options(){return ft},fullWidth:!0,get value(){return e(Ne)},set value(d){v(Ne,d,!0)}});var re=r(ue,2);$e(re,{type:"number",label:"Temperature",min:0,max:2,step:.1,fullWidth:!0,get value(){return e(Ee)},set value(d){v(Ee,d,!0)}});var ee=r(re,2);$e(ee,{type:"number",label:"Max Tokens",min:1,max:32e3,fullWidth:!0,get value(){return e(We)},set value(d){v(We,d,!0)}}),t(Y);var le=r(Y,2);ie(le,{variant:"primary",fullWidth:!0,$$events:{click:ht},children:(d,N)=>{x();var q=S("Create Test Case");l(d,q)},$$slots:{default:!0}}),k(()=>c(F,e(te).description)),nt(j,()=>e(fe),d=>v(fe,d)),l(_,D)};y(me,_=>{e(te)&&_(he)})}t(K),t(G),l(P,G)},$$slots:{default:!0}});var H=r(Z,2);Oe(H,{variant:"bordered",padding:"lg",children:(P,C)=>{var G=es(),K=s(G),Q=s(K),oe=s(Q);t(Q);var me=r(Q,2);{var he=o=>{ie(o,{variant:"secondary",size:"sm",$$events:{click:xt},children:(I,F)=>{x();var p=S("Run All Tests");l(I,p)},$$slots:{default:!0}})};y(me,o=>{e(f).length>0&&o(he)})}t(K);var _=r(K,2);{var D=o=>{var I=Ct();l(o,I)},B=o=>{var I=Yt();Qe(I,21,()=>e(f),F=>F.id,(F,p)=>{var X=Xt(),M=s(X),U=s(M),j=s(U),se=s(j,!0);t(j);var de=r(j,2),ae=s(de);be(ae,{variant:"default",size:"sm",children:(i,u)=>{x();var g=S();k(()=>c(g,e(p).skillName)),l(i,g)},$$slots:{default:!0}});var Y=r(ae,2);{var ue=i=>{{let u=J(()=>e(p).lastResult.passed?"success":"error");be(i,{get variant(){return e(u)},size:"sm",children:(g,h)=>{x();var R=S();k(()=>c(R,e(p).lastResult.passed?"✓ Passed":"✗ Failed")),l(g,R)},$$slots:{default:!0}})}},re=i=>{be(i,{variant:"warning",size:"sm",children:(u,g)=>{x();var h=S("Not Run");l(u,h)},$$slots:{default:!0}})};y(Y,i=>{e(p).lastResult?i(ue):i(re,!1)})}t(de),t(U);var ee=r(U,2),le=s(ee);{let i=J(()=>e(ze)===e(p).id);ie(le,{variant:"primary",size:"sm",get loading(){return e(i)},$$events:{click:()=>Xe(e(p))},children:(u,g)=>{x();var h=S("Run");l(u,h)},$$slots:{default:!0}})}var d=r(le,2);ie(d,{variant:"ghost",size:"sm",$$events:{click:()=>gt(e(p).id)},children:(i,u)=>{x();var g=S("Delete");l(i,g)},$$slots:{default:!0}}),t(ee),t(M);var N=r(M,2);{var q=i=>{var u=Qt(),g=s(u),h=r(s(g),2),R=s(h);t(h),t(g);var E=r(g,2),O=r(s(E),2),ce=s(O,!0);t(O),t(E);var Le=r(E,2);{var Je=ge=>{var L=Kt(),ve=r(s(L),2),Ge=s(ve,!0);t(ve),t(L),k(()=>c(Ge,e(p).lastResult.error)),l(ge,L)};y(Le,ge=>{e(p).lastResult.error&&ge(Je)})}t(u),k(()=>{c(R,`${e(p).lastResult.executionTime??""}ms`),c(ce,e(p).lastResult.matchDetails)}),l(i,u)};y(N,i=>{e(p).lastResult&&i(q)})}t(X),k(()=>c(se,e(p).name)),l(F,X)}),t(I),l(o,I)};y(_,o=>{e(f).length===0?o(D):o(B,!1)})}t(G),k(()=>c(oe,`Test Cases (${e(f).length??""})`)),l(P,G)},$$slots:{default:!0}}),t(w),l(b,w)},A=b=>{Oe(b,{variant:"bordered",padding:"lg",children:(w,Z)=>{var H=vs(),P=s(H),C=s(P),G=s(C);t(C);var K=r(C,2);{var Q=_=>{ie(_,{variant:"danger",size:"sm",$$events:{click:$t},children:(D,B)=>{x();var o=S("Clear History");l(D,o)},$$slots:{default:!0}})};y(K,_=>{e(W).length>0&&_(Q)})}t(P);var oe=r(P,2);{var me=_=>{var D=ss();l(_,D)},he=_=>{var D=ls();Qe(D,21,()=>e(W),B=>B.id,(B,o)=>{const I=J(()=>e(f).find(h=>h.id===e(o).testCaseId));var F=rs(),p=s(F),X=s(p),M=s(X),U=s(M,!0);t(M);var j=r(M,2),se=s(j),de=s(se,!0);t(se);var ae=r(se,2);{let h=J(()=>e(o).result.passed?"success":"error");be(ae,{get variant(){return e(h)},size:"sm",children:(R,E)=>{x();var O=S();k(()=>c(O,e(o).result.passed?"✓ Passed":"✗ Failed")),l(R,O)},$$slots:{default:!0}})}var Y=r(ae,2),ue=s(Y);t(Y),t(j),t(X),t(p);var re=r(p,2),ee=s(re),le=r(s(ee),2),d=s(le,!0);t(le),t(ee);var N=r(ee,2);{var q=h=>{var R=as(),E=r(s(R),2),O=s(E,!0);t(E),t(R),k(()=>c(O,e(o).result.error)),l(h,R)};y(N,h=>{e(o).result.error&&h(q)})}var i=r(N,2),u=r(s(i),2),g=s(u);t(u),t(i),t(re),t(F),k((h,R)=>{var E;c(U,((E=e(I))==null?void 0:E.name)||"Unknown Test"),c(de,h),c(ue,`${e(o).result.executionTime??""}ms`),c(d,e(o).result.matchDetails),c(g,`${R??""}${e(o).result.actualOutput.length>200?"...":""}`)},[()=>e(o).timestamp.toLocaleString("en-US",{dateStyle:"short",timeStyle:"medium"}),()=>e(o).result.actualOutput.slice(0,200)]),l(B,F)}),t(D),l(_,D)};y(oe,_=>{e(W).length===0?_(me):_(he,!1)})}t(H),k(()=>c(G,`Test History (${e(W).length??""})`)),l(w,H)},$$slots:{default:!0}})};y($,b=>{e(_e)==="builder"?b(z):b(A,!1)},!0)}l(a,n)};y(wt,a=>{e(De)?a(Rt):a(Ot,!1)})}t(He),k(()=>{c(bt,e(ke).total),c(yt,e(ke).passed),c(Tt,e(ke).failed),c(kt,e(ke).notRun)}),l(ut,He),At()}export{gs as component};
