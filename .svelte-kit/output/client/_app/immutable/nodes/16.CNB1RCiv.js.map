{"version":3,"file":"16.CNB1RCiv.js","sources":["../../../../../../src/lib/stores/planning.svelte.ts","../../../../../../src/lib/services/planningService.ts","../../../../../../src/lib/components/panels/planning/RequestForm.svelte","../../../../../../src/lib/components/panels/planning/StageProgress.svelte","../../../../../../src/lib/components/panels/planning/SessionHistory.svelte","../../../../../../src/routes/planning/+page.svelte","../../../../../../src/lib/components/panels/planning/StageOutput.svelte","../../../../../../src/lib/components/panels/planning/DeliverableViewer.svelte"],"sourcesContent":["/**\n * Planning Store\n *\n * Manages planning agent sessions using Svelte 5 runes.\n */\n\nimport type {\n\tPlanningSession,\n\tPlanningRequest,\n\tPlanningDeliverable,\n\tPAORTStage,\n\tStageOutput\n} from '$lib/types/agents';\nimport { SessionStatus, PAORTStage as Stage } from '$lib/types/agents';\n\n// ═══════════════════════════════════════════════════════════════════════\n// Planning Store State\n// ═══════════════════════════════════════════════════════════════════════\n\ninterface PlanningState {\n\tsessions: PlanningSession[];\n\tcurrentSession: PlanningSession | null;\n\tisStreaming: boolean;\n\tstreamingOutput: string;\n\tcurrentStage: PAORTStage | null;\n}\n\nconst state = $state<PlanningState>({\n\tsessions: [],\n\tcurrentSession: null,\n\tisStreaming: false,\n\tstreamingOutput: '',\n\tcurrentStage: null\n});\n\n// ═══════════════════════════════════════════════════════════════════════\n// Planning Store\n// ═══════════════════════════════════════════════════════════════════════\n\nexport const planningStore = {\n\t// Getters\n\tget sessions() {\n\t\treturn state.sessions;\n\t},\n\n\tget currentSession() {\n\t\treturn state.currentSession;\n\t},\n\n\tget isStreaming() {\n\t\treturn state.isStreaming;\n\t},\n\n\tget streamingOutput() {\n\t\treturn state.streamingOutput;\n\t},\n\n\tget currentStage() {\n\t\treturn state.currentStage;\n\t},\n\n\tget activeSessions() {\n\t\treturn state.sessions.filter(\n\t\t\t(s) => s.status === SessionStatus.RUNNING || s.status === SessionStatus.PENDING\n\t\t);\n\t},\n\n\tget completedSessions() {\n\t\treturn state.sessions.filter((s) => s.status === SessionStatus.COMPLETED);\n\t},\n\n\tget failedSessions() {\n\t\treturn state.sessions.filter((s) => s.status === SessionStatus.FAILED);\n\t},\n\n\t// Actions\n\tcreateSession(request: PlanningRequest): PlanningSession {\n\t\tconst session: PlanningSession = {\n\t\t\tid: generateSessionId(),\n\t\t\ttype: 'planning',\n\t\t\tstatus: SessionStatus.PENDING,\n\t\t\tcreatedAt: new Date(),\n\t\t\trequest,\n\t\t\tstages: {}\n\t\t};\n\n\t\tstate.sessions = [...state.sessions, session];\n\t\tstate.currentSession = session;\n\n\t\treturn session;\n\t},\n\n\tstartSession(sessionId: string): void {\n\t\tconst session = state.sessions.find((s) => s.id === sessionId);\n\t\tif (!session) return;\n\n\t\tsession.status = SessionStatus.RUNNING;\n\t\tsession.startedAt = new Date();\n\t\tsession.currentStage = Stage.PLAN;\n\n\t\tstate.currentStage = Stage.PLAN;\n\t\tstate.isStreaming = true;\n\t\tstate.streamingOutput = '';\n\n\t\t// Trigger reactivity\n\t\tstate.sessions = [...state.sessions];\n\t},\n\n\tupdateStageOutput(sessionId: string, stage: PAORTStage, output: StageOutput): void {\n\t\tconst session = state.sessions.find((s) => s.id === sessionId);\n\t\tif (!session) return;\n\n\t\t// Update stage output\n\t\tswitch (stage) {\n\t\t\tcase Stage.PLAN:\n\t\t\t\tsession.stages.plan = output;\n\t\t\t\tbreak;\n\t\t\tcase Stage.ACT:\n\t\t\t\tsession.stages.act = output;\n\t\t\t\tbreak;\n\t\t\tcase Stage.OBSERVE:\n\t\t\t\tsession.stages.observe = output;\n\t\t\t\tbreak;\n\t\t\tcase Stage.REFLECT:\n\t\t\t\tsession.stages.reflect = output;\n\t\t\t\tbreak;\n\t\t}\n\n\t\t// Trigger reactivity\n\t\tstate.sessions = [...state.sessions];\n\t},\n\n\tappendStreamingOutput(content: string): void {\n\t\tstate.streamingOutput += content;\n\t},\n\n\tclearStreamingOutput(): void {\n\t\tstate.streamingOutput = '';\n\t},\n\n\tadvanceStage(sessionId: string, nextStage: PAORTStage | null): void {\n\t\tconst session = state.sessions.find((s) => s.id === sessionId);\n\t\tif (!session) return;\n\n\t\tif (nextStage) {\n\t\t\tsession.currentStage = nextStage;\n\t\t\tstate.currentStage = nextStage;\n\t\t\tstate.streamingOutput = '';\n\t\t} else {\n\t\t\t// No next stage means we're done\n\t\t\tsession.currentStage = undefined;\n\t\t\tstate.currentStage = null;\n\t\t\tstate.isStreaming = false;\n\t\t}\n\n\t\t// Trigger reactivity\n\t\tstate.sessions = [...state.sessions];\n\t},\n\n\tcompleteSession(sessionId: string, deliverable: PlanningDeliverable): void {\n\t\tconst session = state.sessions.find((s) => s.id === sessionId);\n\t\tif (!session) return;\n\n\t\tsession.status = SessionStatus.COMPLETED;\n\t\tsession.completedAt = new Date();\n\t\tsession.deliverable = deliverable;\n\t\tsession.currentStage = undefined;\n\n\t\tstate.currentStage = null;\n\t\tstate.isStreaming = false;\n\t\tstate.streamingOutput = '';\n\n\t\t// Trigger reactivity\n\t\tstate.sessions = [...state.sessions];\n\t},\n\n\tfailSession(sessionId: string, error: string): void {\n\t\tconst session = state.sessions.find((s) => s.id === sessionId);\n\t\tif (!session) return;\n\n\t\tsession.status = SessionStatus.FAILED;\n\t\tsession.completedAt = new Date();\n\t\tsession.error = error;\n\t\tsession.currentStage = undefined;\n\n\t\tstate.currentStage = null;\n\t\tstate.isStreaming = false;\n\t\tstate.streamingOutput = '';\n\n\t\t// Trigger reactivity\n\t\tstate.sessions = [...state.sessions];\n\t},\n\n\tcancelSession(sessionId: string): void {\n\t\tconst session = state.sessions.find((s) => s.id === sessionId);\n\t\tif (!session) return;\n\n\t\tsession.status = SessionStatus.CANCELLED;\n\t\tsession.completedAt = new Date();\n\t\tsession.currentStage = undefined;\n\n\t\tif (state.currentSession?.id === sessionId) {\n\t\t\tstate.currentStage = null;\n\t\t\tstate.isStreaming = false;\n\t\t\tstate.streamingOutput = '';\n\t\t}\n\n\t\t// Trigger reactivity\n\t\tstate.sessions = [...state.sessions];\n\t},\n\n\tsetCurrentSession(sessionId: string | null): void {\n\t\tif (sessionId === null) {\n\t\t\tstate.currentSession = null;\n\t\t\treturn;\n\t\t}\n\n\t\tconst session = state.sessions.find((s) => s.id === sessionId);\n\t\tif (session) {\n\t\t\tstate.currentSession = session;\n\t\t}\n\t},\n\n\tdeleteSession(sessionId: string): void {\n\t\tstate.sessions = state.sessions.filter((s) => s.id !== sessionId);\n\n\t\tif (state.currentSession?.id === sessionId) {\n\t\t\tstate.currentSession = null;\n\t\t\tstate.currentStage = null;\n\t\t\tstate.isStreaming = false;\n\t\t\tstate.streamingOutput = '';\n\t\t}\n\t},\n\n\tclearAll(): void {\n\t\tstate.sessions = [];\n\t\tstate.currentSession = null;\n\t\tstate.isStreaming = false;\n\t\tstate.streamingOutput = '';\n\t\tstate.currentStage = null;\n\t}\n};\n\n// ═══════════════════════════════════════════════════════════════════════\n// Helper Functions\n// ═══════════════════════════════════════════════════════════════════════\n\nfunction generateSessionId(): string {\n\treturn `planning_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n}\n","/**\n * Planning Service\n *\n * Business logic for planning agent operations.\n */\n\nimport type { PlanningRequest, PlanningDeliverable, StageOutput } from '$lib/types/agents';\nimport { PAORTStage } from '$lib/types/agents';\nimport { planningStore } from '$lib/stores/planning.svelte';\nimport { streamingService } from './streaming';\nimport { classifyError, createValidationError, type AppError } from '$lib/utils/errors';\n\n// ═══════════════════════════════════════════════════════════════════════\n// Configuration\n// ═══════════════════════════════════════════════════════════════════════\n\nconst API_BASE_URL = 'http://localhost:8787'; // ForgeAgents API\n\n// ═══════════════════════════════════════════════════════════════════════\n// Validation\n// ═══════════════════════════════════════════════════════════════════════\n\nexport function validatePlanningRequest(request: PlanningRequest): AppError | null {\n\tif (!request.title || request.title.trim().length === 0) {\n\t\treturn createValidationError('Title is required');\n\t}\n\n\tif (request.title.length > 200) {\n\t\treturn createValidationError('Title must be 200 characters or less');\n\t}\n\n\tif (!request.description || request.description.trim().length === 0) {\n\t\treturn createValidationError('Description is required');\n\t}\n\n\tif (request.description.length > 5000) {\n\t\treturn createValidationError('Description must be 5000 characters or less');\n\t}\n\n\treturn null;\n}\n\n// ═══════════════════════════════════════════════════════════════════════\n// Planning Operations\n// ═══════════════════════════════════════════════════════════════════════\n\nexport async function startPlanningSession(\n\trequest: PlanningRequest\n): Promise<{ success: boolean; sessionId?: string; error?: AppError }> {\n\t// Validate request\n\tconst validationError = validatePlanningRequest(request);\n\tif (validationError) {\n\t\treturn { success: false, error: validationError };\n\t}\n\n\ttry {\n\t\t// Start session on backend\n\t\tconst startResponse = await fetch(`${API_BASE_URL}/api/v1/bds/planning/start`, {\n\t\t\tmethod: 'POST',\n\t\t\theaders: {\n\t\t\t\t'Content-Type': 'application/json'\n\t\t\t},\n\t\t\tbody: JSON.stringify({\n\t\t\t\trequest: `${request.title}\\n\\n${request.description}`,\n\t\t\t\tcontext: request.context || ''\n\t\t\t})\n\t\t});\n\n\t\tif (!startResponse.ok) {\n\t\t\tconst error = await startResponse.json();\n\t\t\treturn { success: false, error: createValidationError(error.detail || 'Failed to start session') };\n\t\t}\n\n\t\tconst { sessionId } = await startResponse.json();\n\n\t\t// Create local session with backend session ID\n\t\tconst session = planningStore.createSession(request);\n\t\tsession.id = sessionId;\n\n\t\t// Start session\n\t\tplanningStore.startSession(session.id);\n\n\t\t// Subscribe to streaming updates\n\t\tconst streamUrl = `${API_BASE_URL}/api/v1/bds/planning/${sessionId}/stream`;\n\n\t\tstreamingService.subscribe(streamUrl, {\n\t\t\tonChunk: (content: string) => {\n\t\t\t\tplanningStore.appendStreamingOutput(content);\n\t\t\t},\n\n\t\t\tonStageStart: (stage: string) => {\n\t\t\t\tconst paortStage = stage as PAORTStage;\n\t\t\t\tplanningStore.advanceStage(session.id, paortStage);\n\t\t\t},\n\n\t\t\tonStageEnd: (stage: string, output: unknown) => {\n\t\t\t\tconst paortStage = stage as PAORTStage;\n\t\t\t\tconst stageOutput = output as StageOutput;\n\t\t\t\tplanningStore.updateStageOutput(session.id, paortStage, stageOutput);\n\t\t\t\tplanningStore.clearStreamingOutput();\n\t\t\t},\n\n\t\t\tonComplete: (result: unknown) => {\n\t\t\t\tconst deliverable = result as PlanningDeliverable;\n\t\t\t\tplanningStore.completeSession(session.id, deliverable);\n\t\t\t},\n\n\t\t\tonError: (error: AppError) => {\n\t\t\t\tplanningStore.failSession(session.id, error.message);\n\t\t\t}\n\t\t});\n\n\t\treturn { success: true, sessionId: session.id };\n\t} catch (error) {\n\t\tconst appError = classifyError(error);\n\t\treturn { success: false, error: appError };\n\t}\n}\n\nexport function cancelPlanningSession(sessionId: string): void {\n\tplanningStore.cancelSession(sessionId);\n\t// TODO: Call API to cancel server-side session\n}\n\nexport function deletePlanningSession(sessionId: string): void {\n\tplanningStore.deleteSession(sessionId);\n\t// TODO: Call API to delete session from DataForge\n}\n\n// ═══════════════════════════════════════════════════════════════════════\n// Helper Functions\n// ═══════════════════════════════════════════════════════════════════════\n\nexport function formatDuration(ms: number): string {\n\tif (ms < 1000) return `${ms}ms`;\n\tif (ms < 60000) return `${(ms / 1000).toFixed(1)}s`;\n\tif (ms < 3600000) return `${(ms / 60000).toFixed(1)}m`;\n\treturn `${(ms / 3600000).toFixed(1)}h`;\n}\n\nexport function formatCost(cost: number): string {\n\tif (cost < 0.01) return `$${cost.toFixed(4)}`;\n\treturn `$${cost.toFixed(2)}`;\n}\n\nexport function formatTokens(tokens: number): string {\n\tif (tokens < 1000) return `${tokens} tokens`;\n\tif (tokens < 1000000) return `${(tokens / 1000).toFixed(1)}K tokens`;\n\treturn `${(tokens / 1000000).toFixed(1)}M tokens`;\n}\n","<script lang=\"ts\">\n\timport Button from '$lib/components/Button.svelte';\n\timport Input from '$lib/components/Input.svelte';\n\timport Textarea from '$lib/components/Textarea.svelte';\n\timport Alert from '$lib/components/Alert.svelte';\n\timport { startPlanningSession, validatePlanningRequest } from '$lib/services/planningService';\n\timport { planningStore } from '$lib/stores/planning.svelte';\n\timport type { PlanningRequest } from '$lib/types/agents';\n\timport type { AppError } from '$lib/utils/errors';\n\n\tlet title = $state('');\n\tlet description = $state('');\n\tlet error = $state<AppError | null>(null);\n\tlet isSubmitting = $state(false);\n\n\tconst isStreaming = $derived(planningStore.isStreaming);\n\n\tasync function handleSubmit(): Promise<void> {\n\t\terror = null;\n\n\t\tconst request: PlanningRequest = {\n\t\t\ttitle: title.trim(),\n\t\t\tdescription: description.trim()\n\t\t};\n\n\t\t// Validate\n\t\tconst validationError = validatePlanningRequest(request);\n\t\tif (validationError) {\n\t\t\terror = validationError;\n\t\t\treturn;\n\t\t}\n\n\t\tisSubmitting = true;\n\n\t\ttry {\n\t\t\tconst result = await startPlanningSession(request);\n\n\t\t\tif (!result.success && result.error) {\n\t\t\t\terror = result.error;\n\t\t\t\tisSubmitting = false;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Success - clear form\n\t\t\ttitle = '';\n\t\t\tdescription = '';\n\t\t\tisSubmitting = false;\n\t\t} catch (err) {\n\t\t\tisSubmitting = false;\n\t\t}\n\t}\n\n\tfunction handleClear(): void {\n\t\ttitle = '';\n\t\tdescription = '';\n\t\terror = null;\n\t}\n</script>\n\n<form on:submit|preventDefault={handleSubmit} class=\"request-form\">\n\t{#if error}\n\t\t<Alert variant=\"error\">\n\t\t\t{error.userMessage}\n\t\t</Alert>\n\t{/if}\n\n\t<Input\n\t\tlabel=\"Task Title\"\n\t\tplaceholder=\"e.g., Add user authentication system\"\n\t\tbind:value={title}\n\t\tmaxlength={200}\n\t\trequired\n\t\tdisabled={isStreaming || isSubmitting}\n\t/>\n\n\t<Textarea\n\t\tlabel=\"Description\"\n\t\tplaceholder=\"Provide detailed requirements, constraints, and context for this task...\"\n\t\tbind:value={description}\n\t\trows={8}\n\t\tmaxlength={5000}\n\t\trequired\n\t\tdisabled={isStreaming || isSubmitting}\n\t/>\n\n\t<div class=\"form-actions\">\n\t\t<Button\n\t\t\ttype=\"submit\"\n\t\t\tvariant=\"primary\"\n\t\t\tdisabled={isStreaming || isSubmitting || !title.trim() || !description.trim()}\n\t\t\tloading={isSubmitting}\n\t\t>\n\t\t\t{isSubmitting ? 'Starting...' : 'Start Planning'}\n\t\t</Button>\n\n\t\t<Button type=\"button\" variant=\"secondary\" onclick={handleClear} disabled={isStreaming || isSubmitting}>\n\t\t\tClear\n\t\t</Button>\n\t</div>\n\n\t<div class=\"form-hint\">\n\t\t<p>\n\t\t\tThe Planning Agent will analyze your request and generate a detailed implementation plan with\n\t\t\tspecific steps, acceptance criteria, and risk assessment.\n\t\t</p>\n\t</div>\n</form>\n\n<style>\n\t.request-form {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 16px;\n\t}\n\n\t.form-actions {\n\t\tdisplay: flex;\n\t\tgap: 12px;\n\t\tmargin-top: 8px;\n\t}\n\n\t.form-hint {\n\t\tmargin-top: 8px;\n\t\tpadding: 12px;\n\t\tbackground: rgba(193, 151, 69, 0.05);\n\t\tborder-left: 3px solid var(--color-brass);\n\t\tborder-radius: 4px;\n\t}\n\n\t.form-hint p {\n\t\tcolor: var(--color-text-muted);\n\t\tfont-size: 0.875rem;\n\t\tline-height: 1.5;\n\t\tmargin: 0;\n\t}\n</style>\n","<script lang=\"ts\">\n\timport { PAORTStage } from '$lib/types/agents';\n\timport type { PAORTStage as PAORTStageType } from '$lib/types/agents';\n\n\tinterface Props {\n\t\tstage: PAORTStageType | null;\n\t}\n\n\tlet { stage }: Props = $props();\n\n\tconst stages = [\n\t\t{ key: PAORTStage.PLAN, label: 'Plan', description: 'Define strategy' },\n\t\t{ key: PAORTStage.ACT, label: 'Act', description: 'Execute steps' },\n\t\t{ key: PAORTStage.OBSERVE, label: 'Observe', description: 'Analyze results' },\n\t\t{ key: PAORTStage.REFLECT, label: 'Reflect', description: 'Evaluate success' }\n\t];\n\n\tfunction getStageIndex(stageKey: PAORTStageType | null): number {\n\t\tif (!stageKey) return -1;\n\t\treturn stages.findIndex((s) => s.key === stageKey);\n\t}\n\n\tconst currentIndex = $derived(getStageIndex(stage));\n</script>\n\n<div class=\"stage-progress\">\n\t<div class=\"stages\">\n\t\t{#each stages as stageItem, index}\n\t\t\t{@const isActive = index === currentIndex}\n\t\t\t{@const isCompleted = currentIndex > index}\n\t\t\t{@const isPending = currentIndex < index}\n\n\t\t\t<div class=\"stage\" class:active={isActive} class:completed={isCompleted} class:pending={isPending}>\n\t\t\t\t<div class=\"stage-indicator\">\n\t\t\t\t\t<div class=\"stage-number\">\n\t\t\t\t\t\t{#if isCompleted}\n\t\t\t\t\t\t\t<svg width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"none\">\n\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\td=\"M13.5 4.5L6 12L2.5 8.5\"\n\t\t\t\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\t\t\t\tstroke-width=\"2\"\n\t\t\t\t\t\t\t\t\tstroke-linecap=\"round\"\n\t\t\t\t\t\t\t\t\tstroke-linejoin=\"round\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t{:else if isActive}\n\t\t\t\t\t\t\t<div class=\"pulse\"></div>\n\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t{index + 1}\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class=\"stage-content\">\n\t\t\t\t\t<div class=\"stage-label\">{stageItem.label}</div>\n\t\t\t\t\t<div class=\"stage-description\">{stageItem.description}</div>\n\t\t\t\t</div>\n\n\t\t\t\t{#if index < stages.length - 1}\n\t\t\t\t\t<div class=\"stage-connector\" class:completed={isCompleted}></div>\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t{/each}\n\t</div>\n</div>\n\n<style>\n\t.stage-progress {\n\t\tmargin-bottom: 24px;\n\t}\n\n\t.stages {\n\t\tdisplay: flex;\n\t\tgap: 12px;\n\t\tposition: relative;\n\t}\n\n\t.stage {\n\t\tflex: 1;\n\t\tposition: relative;\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\talign-items: center;\n\t\ttext-align: center;\n\t}\n\n\t.stage-indicator {\n\t\twidth: 48px;\n\t\theight: 48px;\n\t\tborder-radius: 50%;\n\t\tborder: 2px solid var(--color-border);\n\t\tbackground: var(--color-surface);\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tmargin-bottom: 12px;\n\t\ttransition: all 0.3s ease;\n\t\tposition: relative;\n\t\tz-index: 2;\n\t}\n\n\t.stage.active .stage-indicator {\n\t\tborder-color: var(--color-brass);\n\t\tbackground: rgba(193, 151, 69, 0.1);\n\t}\n\n\t.stage.completed .stage-indicator {\n\t\tborder-color: var(--color-success);\n\t\tbackground: rgba(73, 200, 131, 0.1);\n\t}\n\n\t.stage-number {\n\t\tfont-weight: 600;\n\t\tcolor: var(--color-text-muted);\n\t}\n\n\t.stage.active .stage-number {\n\t\tcolor: var(--color-brass);\n\t}\n\n\t.stage.completed .stage-number {\n\t\tcolor: var(--color-success);\n\t}\n\n\t.pulse {\n\t\twidth: 12px;\n\t\theight: 12px;\n\t\tborder-radius: 50%;\n\t\tbackground: var(--color-brass);\n\t\tanimation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;\n\t}\n\n\t@keyframes pulse {\n\t\t0%,\n\t\t100% {\n\t\t\topacity: 1;\n\t\t}\n\t\t50% {\n\t\t\topacity: 0.5;\n\t\t}\n\t}\n\n\t.stage-content {\n\t\tmin-height: 48px;\n\t}\n\n\t.stage-label {\n\t\tfont-weight: 600;\n\t\tcolor: var(--color-text);\n\t\tmargin-bottom: 4px;\n\t\tfont-size: 0.875rem;\n\t}\n\n\t.stage.active .stage-label {\n\t\tcolor: var(--color-brass);\n\t}\n\n\t.stage-description {\n\t\tfont-size: 0.75rem;\n\t\tcolor: var(--color-text-muted);\n\t}\n\n\t.stage-connector {\n\t\tposition: absolute;\n\t\ttop: 24px;\n\t\tleft: 50%;\n\t\tright: -50%;\n\t\theight: 2px;\n\t\tbackground: var(--color-border);\n\t\ttransform: translateY(-50%);\n\t\ttransition: background 0.3s ease;\n\t\tz-index: 1;\n\t}\n\n\t.stage-connector.completed {\n\t\tbackground: var(--color-success);\n\t}\n\n\t@media (max-width: 768px) {\n\t\t.stages {\n\t\t\tflex-direction: column;\n\t\t\talign-items: flex-start;\n\t\t}\n\n\t\t.stage {\n\t\t\tflex-direction: row;\n\t\t\talign-items: flex-start;\n\t\t\ttext-align: left;\n\t\t\twidth: 100%;\n\t\t}\n\n\t\t.stage-indicator {\n\t\t\tmargin-bottom: 0;\n\t\t\tmargin-right: 16px;\n\t\t\tflex-shrink: 0;\n\t\t}\n\n\t\t.stage-connector {\n\t\t\tdisplay: none;\n\t\t}\n\t}\n</style>\n","<script lang=\"ts\">\n\timport { planningStore } from '$lib/stores/planning.svelte';\n\timport Badge from '$lib/components/Badge.svelte';\n\timport { SessionStatus } from '$lib/types/agents';\n\timport type { PlanningSession } from '$lib/types/agents';\n\n\tconst sessions = $derived(planningStore.sessions);\n\tconst currentSession = $derived(planningStore.currentSession);\n\n\tfunction formatDate(date: Date): string {\n\t\treturn new Intl.DateTimeFormat('en-US', {\n\t\t\tmonth: 'short',\n\t\t\tday: 'numeric',\n\t\t\thour: '2-digit',\n\t\t\tminute: '2-digit'\n\t\t}).format(date);\n\t}\n\n\tfunction getStatusVariant(status: SessionStatus): 'success' | 'error' | 'warning' | 'info' {\n\t\tswitch (status) {\n\t\t\tcase SessionStatus.COMPLETED:\n\t\t\t\treturn 'success';\n\t\t\tcase SessionStatus.FAILED:\n\t\t\tcase SessionStatus.CANCELLED:\n\t\t\t\treturn 'error';\n\t\t\tcase SessionStatus.RUNNING:\n\t\t\t\treturn 'warning';\n\t\t\tdefault:\n\t\t\t\treturn 'info';\n\t\t}\n\t}\n\n\tfunction getStatusLabel(status: SessionStatus): string {\n\t\tswitch (status) {\n\t\t\tcase SessionStatus.COMPLETED:\n\t\t\t\treturn 'Completed';\n\t\t\tcase SessionStatus.FAILED:\n\t\t\t\treturn 'Failed';\n\t\t\tcase SessionStatus.CANCELLED:\n\t\t\t\treturn 'Cancelled';\n\t\t\tcase SessionStatus.RUNNING:\n\t\t\t\treturn 'Running';\n\t\t\tcase SessionStatus.PENDING:\n\t\t\t\treturn 'Pending';\n\t\t\tdefault:\n\t\t\t\treturn 'Unknown';\n\t\t}\n\t}\n\n\tfunction selectSession(session: PlanningSession): void {\n\t\tplanningStore.setCurrentSession(session.id);\n\t}\n</script>\n\n<div class=\"session-history\">\n\t{#if sessions.length === 0}\n\t\t<div class=\"empty-state\">\n\t\t\t<p>No planning sessions yet</p>\n\t\t</div>\n\t{:else}\n\t\t<div class=\"session-list\">\n\t\t\t{#each sessions.slice().reverse() as session}\n\t\t\t\t<button\n\t\t\t\t\tclass=\"session-item\"\n\t\t\t\t\tclass:active={currentSession?.id === session.id}\n\t\t\t\t\tonclick={() => selectSession(session)}\n\t\t\t\t>\n\t\t\t\t\t<div class=\"session-header\">\n\t\t\t\t\t\t<span class=\"session-title\">{session.request.title}</span>\n\t\t\t\t\t\t<Badge variant={getStatusVariant(session.status)}>\n\t\t\t\t\t\t\t{getStatusLabel(session.status)}\n\t\t\t\t\t\t</Badge>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"session-meta\">\n\t\t\t\t\t\t<span class=\"session-date\">\n\t\t\t\t\t\t\t{formatDate(session.createdAt)}\n\t\t\t\t\t\t</span>\n\n\t\t\t\t\t\t{#if session.completedAt && session.startedAt}\n\t\t\t\t\t\t\t{@const duration = session.completedAt.getTime() - session.startedAt.getTime()}\n\t\t\t\t\t\t\t<span class=\"session-duration\">\n\t\t\t\t\t\t\t\t{duration < 60000 ? `${Math.round(duration / 1000)}s` : `${Math.round(duration / 60000)}m`}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</div>\n\t\t\t\t</button>\n\t\t\t{/each}\n\t\t</div>\n\t{/if}\n</div>\n\n<style>\n\t.session-history {\n\t\tmax-height: 400px;\n\t\toverflow-y: auto;\n\t}\n\n\t.empty-state {\n\t\tpadding: 24px;\n\t\ttext-align: center;\n\t\tcolor: var(--color-text-muted);\n\t}\n\n\t.session-list {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 8px;\n\t}\n\n\t.session-item {\n\t\twidth: 100%;\n\t\tpadding: 12px;\n\t\tbackground: var(--color-surface);\n\t\tborder: 1px solid var(--color-border);\n\t\tborder-radius: 4px;\n\t\tcursor: pointer;\n\t\ttransition: all 0.2s ease;\n\t\ttext-align: left;\n\t}\n\n\t.session-item:hover {\n\t\tborder-color: var(--color-brass);\n\t\tbackground: var(--color-surface-alt);\n\t}\n\n\t.session-item.active {\n\t\tborder-color: var(--color-brass);\n\t\tbackground: rgba(193, 151, 69, 0.1);\n\t}\n\n\t.session-header {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: space-between;\n\t\tgap: 12px;\n\t\tmargin-bottom: 8px;\n\t}\n\n\t.session-title {\n\t\tfont-weight: 600;\n\t\tcolor: var(--color-text);\n\t\tfont-size: 0.875rem;\n\t\tflex: 1;\n\t\toverflow: hidden;\n\t\ttext-overflow: ellipsis;\n\t\twhite-space: nowrap;\n\t}\n\n\t.session-meta {\n\t\tdisplay: flex;\n\t\tgap: 12px;\n\t\tfont-size: 0.75rem;\n\t\tcolor: var(--color-text-muted);\n\t}\n\n\t.session-date,\n\t.session-duration {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t}\n\n\t/* Custom scrollbar */\n\t.session-history::-webkit-scrollbar {\n\t\twidth: 6px;\n\t}\n\n\t.session-history::-webkit-scrollbar-track {\n\t\tbackground: var(--color-surface);\n\t\tborder-radius: 3px;\n\t}\n\n\t.session-history::-webkit-scrollbar-thumb {\n\t\tbackground: var(--color-border-dark);\n\t\tborder-radius: 3px;\n\t}\n\n\t.session-history::-webkit-scrollbar-thumb:hover {\n\t\tbackground: var(--color-brass);\n\t}\n</style>\n","<script lang=\"ts\">\n\timport { planningStore } from '$lib/stores/planning.svelte';\n\timport ErrorBoundary from '$lib/components/ErrorBoundary.svelte';\n\timport Panel from '$lib/components/Panel.svelte';\n\timport RequestForm from '$lib/components/panels/planning/RequestForm.svelte';\n\timport StageProgress from '$lib/components/panels/planning/StageProgress.svelte';\n\timport StageOutput from '$lib/components/panels/planning/StageOutput.svelte';\n\timport SessionHistory from '$lib/components/panels/planning/SessionHistory.svelte';\n\timport DeliverableViewer from '$lib/components/panels/planning/DeliverableViewer.svelte';\n\timport { SessionStatus } from '$lib/types/agents';\n\n\tconst currentSession = $derived(planningStore.currentSession);\n\tconst isStreaming = $derived(planningStore.isStreaming);\n\tconst currentStage = $derived(planningStore.currentStage);\n\tconst streamingOutput = $derived(planningStore.streamingOutput);\n</script>\n\n<ErrorBoundary>\n\t<div class=\"planning-page\">\n\t\t<header class=\"page-header\">\n\t\t\t<h1>Planning Agent</h1>\n\t\t\t<p class=\"text-muted\">Define and plan complex implementation tasks</p>\n\t\t</header>\n\n\t\t<div class=\"content-grid\">\n\t\t\t<!-- Left Column: Input & Controls -->\n\t\t\t<div class=\"left-column\">\n\t\t\t\t<Panel title=\"New Planning Request\">\n\t\t\t\t\t<RequestForm />\n\t\t\t\t</Panel>\n\n\t\t\t\t{#if currentSession}\n\t\t\t\t\t<Panel title=\"Session History\" class=\"mt-6\">\n\t\t\t\t\t\t<SessionHistory />\n\t\t\t\t\t</Panel>\n\t\t\t\t{/if}\n\t\t\t</div>\n\n\t\t\t<!-- Right Column: Output & Progress -->\n\t\t\t<div class=\"right-column\">\n\t\t\t\t{#if currentSession}\n\t\t\t\t\t{#if currentSession.status === SessionStatus.RUNNING || currentSession.status === SessionStatus.PENDING}\n\t\t\t\t\t\t<!-- Active Session -->\n\t\t\t\t\t\t<Panel title=\"Planning in Progress\">\n\t\t\t\t\t\t\t<StageProgress stage={currentStage} />\n\t\t\t\t\t\t\t<StageOutput output={streamingOutput} isStreaming={isStreaming} />\n\t\t\t\t\t\t</Panel>\n\t\t\t\t\t{:else if currentSession.status === SessionStatus.COMPLETED && currentSession.deliverable}\n\t\t\t\t\t\t<!-- Completed Session -->\n\t\t\t\t\t\t<Panel title=\"Planning Complete\">\n\t\t\t\t\t\t\t<DeliverableViewer deliverable={currentSession.deliverable} />\n\t\t\t\t\t\t</Panel>\n\t\t\t\t\t{:else if currentSession.status === SessionStatus.FAILED}\n\t\t\t\t\t\t<!-- Failed Session -->\n\t\t\t\t\t\t<Panel title=\"Planning Failed\" variant=\"error\">\n\t\t\t\t\t\t\t<div class=\"error-message\">\n\t\t\t\t\t\t\t\t<h3>Error</h3>\n\t\t\t\t\t\t\t\t<p>{currentSession.error || 'An unknown error occurred'}</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</Panel>\n\t\t\t\t\t{/if}\n\t\t\t\t{:else}\n\t\t\t\t\t<!-- No Session -->\n\t\t\t\t\t<Panel title=\"Welcome\">\n\t\t\t\t\t\t<div class=\"empty-state\">\n\t\t\t\t\t\t\t<h2>Start a Planning Session</h2>\n\t\t\t\t\t\t\t<p>Fill out the form on the left to begin planning a new task.</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</Panel>\n\t\t\t\t{/if}\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</ErrorBoundary>\n\n<style>\n\t.planning-page {\n\t\tpadding: 24px;\n\t\tmax-width: 1400px;\n\t\tmargin: 0 auto;\n\t}\n\n\t.page-header {\n\t\tmargin-bottom: 24px;\n\t}\n\n\t.page-header h1 {\n\t\tfont-family: 'Cinzel', serif;\n\t\tfont-weight: 300;\n\t\tfont-size: 2rem;\n\t\tcolor: var(--color-text);\n\t\tmargin-bottom: 8px;\n\t}\n\n\t.text-muted {\n\t\tcolor: var(--color-text-muted);\n\t\tfont-size: 0.875rem;\n\t}\n\n\t.content-grid {\n\t\tdisplay: grid;\n\t\tgrid-template-columns: 1fr 1fr;\n\t\tgap: 24px;\n\t}\n\n\t@media (max-width: 1024px) {\n\t\t.content-grid {\n\t\t\tgrid-template-columns: 1fr;\n\t\t}\n\t}\n\n\t.mt-6 {\n\t\tmargin-top: 24px;\n\t}\n\n\t.error-message {\n\t\tpadding: 16px;\n\t\tbackground: rgba(232, 166, 77, 0.1);\n\t\tborder: 1px solid #e8a64d;\n\t\tborder-radius: 4px;\n\t}\n\n\t.error-message h3 {\n\t\tcolor: #e8a64d;\n\t\tmargin-bottom: 8px;\n\t}\n\n\t.empty-state {\n\t\ttext-align: center;\n\t\tpadding: 48px 24px;\n\t\tcolor: var(--color-text-muted);\n\t}\n\n\t.empty-state h2 {\n\t\tfont-size: 1.5rem;\n\t\tcolor: var(--color-text);\n\t\tmargin-bottom: 12px;\n\t}\n</style>\n","<script lang=\"ts\">\n\timport { onMount } from 'svelte';\n\n\tinterface Props {\n\t\toutput: string;\n\t\tisStreaming: boolean;\n\t}\n\n\tlet { output, isStreaming }: Props = $props();\n\n\tlet outputContainer: HTMLDivElement;\n\tlet shouldAutoScroll = $state(true);\n\n\t// Auto-scroll to bottom when new content arrives\n\t$effect(() => {\n\t\tif (outputContainer && shouldAutoScroll && output) {\n\t\t\toutputContainer.scrollTop = outputContainer.scrollHeight;\n\t\t}\n\t});\n\n\tfunction handleScroll(): void {\n\t\tif (!outputContainer) return;\n\n\t\tconst { scrollTop, scrollHeight, clientHeight } = outputContainer;\n\t\tconst isNearBottom = scrollHeight - (scrollTop + clientHeight) < 100;\n\t\tshouldAutoScroll = isNearBottom;\n\t}\n</script>\n\n<div class=\"stage-output\">\n\t{#if isStreaming || output}\n\t\t<div\n\t\t\tbind:this={outputContainer}\n\t\t\tclass=\"output-container\"\n\t\t\tclass:streaming={isStreaming}\n\t\t\tonscroll={handleScroll}\n\t\t>\n\t\t\t{#if output}\n\t\t\t\t<pre class=\"output-text\">{output}</pre>\n\t\t\t{:else}\n\t\t\t\t<div class=\"loading-indicator\">\n\t\t\t\t\t<div class=\"spinner\"></div>\n\t\t\t\t\t<p>Waiting for output...</p>\n\t\t\t\t</div>\n\t\t\t{/if}\n\n\t\t\t{#if isStreaming}\n\t\t\t\t<div class=\"streaming-indicator\">\n\t\t\t\t\t<div class=\"dot\"></div>\n\t\t\t\t\t<div class=\"dot\"></div>\n\t\t\t\t\t<div class=\"dot\"></div>\n\t\t\t\t</div>\n\t\t\t{/if}\n\t\t</div>\n\n\t\t{#if !shouldAutoScroll && isStreaming}\n\t\t\t<button\n\t\t\t\tclass=\"scroll-to-bottom\"\n\t\t\t\tonclick={() => {\n\t\t\t\t\tshouldAutoScroll = true;\n\t\t\t\t\tif (outputContainer) {\n\t\t\t\t\t\toutputContainer.scrollTop = outputContainer.scrollHeight;\n\t\t\t\t\t}\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<svg width=\"16\" height=\"16\" viewBox=\"0 0 16 16\" fill=\"none\">\n\t\t\t\t\t<path\n\t\t\t\t\t\td=\"M8 12L4 8H12L8 12Z\"\n\t\t\t\t\t\tfill=\"currentColor\"\n\t\t\t\t\t/>\n\t\t\t\t</svg>\n\t\t\t\tScroll to bottom\n\t\t\t</button>\n\t\t{/if}\n\t{:else}\n\t\t<div class=\"empty-state\">\n\t\t\t<p>Output will appear here when the planning session starts.</p>\n\t\t</div>\n\t{/if}\n</div>\n\n<style>\n\t.stage-output {\n\t\tmargin-top: 24px;\n\t\tposition: relative;\n\t}\n\n\t.output-container {\n\t\tbackground: var(--color-bg);\n\t\tborder: 1px solid var(--color-border);\n\t\tborder-radius: 4px;\n\t\tpadding: 16px;\n\t\tmax-height: 500px;\n\t\toverflow-y: auto;\n\t\tfont-family: 'JetBrains Mono', monospace;\n\t\tfont-size: 0.875rem;\n\t\tline-height: 1.6;\n\t\tposition: relative;\n\t}\n\n\t.output-container.streaming {\n\t\tborder-color: var(--color-brass);\n\t}\n\n\t.output-text {\n\t\tmargin: 0;\n\t\twhite-space: pre-wrap;\n\t\tword-wrap: break-word;\n\t\tcolor: var(--color-text);\n\t}\n\n\t.loading-indicator {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tpadding: 48px 24px;\n\t\tcolor: var(--color-text-muted);\n\t}\n\n\t.spinner {\n\t\twidth: 32px;\n\t\theight: 32px;\n\t\tborder: 3px solid rgba(193, 151, 69, 0.1);\n\t\tborder-top-color: var(--color-brass);\n\t\tborder-radius: 50%;\n\t\tanimation: spin 1s linear infinite;\n\t\tmargin-bottom: 16px;\n\t}\n\n\t@keyframes spin {\n\t\tto {\n\t\t\ttransform: rotate(360deg);\n\t\t}\n\t}\n\n\t.streaming-indicator {\n\t\tdisplay: flex;\n\t\tgap: 6px;\n\t\talign-items: center;\n\t\tmargin-top: 16px;\n\t\tpadding-top: 16px;\n\t\tborder-top: 1px solid var(--color-border);\n\t}\n\n\t.dot {\n\t\twidth: 8px;\n\t\theight: 8px;\n\t\tbackground: var(--color-brass);\n\t\tborder-radius: 50%;\n\t\tanimation: pulse-dot 1.4s ease-in-out infinite;\n\t}\n\n\t.dot:nth-child(1) {\n\t\tanimation-delay: 0s;\n\t}\n\n\t.dot:nth-child(2) {\n\t\tanimation-delay: 0.2s;\n\t}\n\n\t.dot:nth-child(3) {\n\t\tanimation-delay: 0.4s;\n\t}\n\n\t@keyframes pulse-dot {\n\t\t0%,\n\t\t80%,\n\t\t100% {\n\t\t\topacity: 0.3;\n\t\t\ttransform: scale(1);\n\t\t}\n\t\t40% {\n\t\t\topacity: 1;\n\t\t\ttransform: scale(1.2);\n\t\t}\n\t}\n\n\t.scroll-to-bottom {\n\t\tposition: absolute;\n\t\tbottom: 16px;\n\t\tright: 16px;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 6px;\n\t\tpadding: 8px 12px;\n\t\tbackground: var(--color-brass);\n\t\tcolor: var(--color-bg);\n\t\tborder: none;\n\t\tborder-radius: 4px;\n\t\tfont-size: 0.75rem;\n\t\tfont-weight: 600;\n\t\tcursor: pointer;\n\t\ttransition: all 0.2s ease;\n\t\tbox-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);\n\t}\n\n\t.scroll-to-bottom:hover {\n\t\tbackground: #d4a957;\n\t\ttransform: translateY(-2px);\n\t\tbox-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);\n\t}\n\n\t.empty-state {\n\t\tpadding: 48px 24px;\n\t\ttext-align: center;\n\t\tcolor: var(--color-text-muted);\n\t}\n\n\t/* Custom scrollbar */\n\t.output-container::-webkit-scrollbar {\n\t\twidth: 8px;\n\t}\n\n\t.output-container::-webkit-scrollbar-track {\n\t\tbackground: var(--color-surface);\n\t\tborder-radius: 4px;\n\t}\n\n\t.output-container::-webkit-scrollbar-thumb {\n\t\tbackground: var(--color-border-dark);\n\t\tborder-radius: 4px;\n\t}\n\n\t.output-container::-webkit-scrollbar-thumb:hover {\n\t\tbackground: var(--color-brass);\n\t}\n</style>\n","<script lang=\"ts\">\n\timport type { PlanningDeliverable } from '$lib/types/agents';\n\timport Button from '$lib/components/Button.svelte';\n\timport Badge from '$lib/components/Badge.svelte';\n\timport { formatTokens, formatCost, formatDuration } from '$lib/services/planningService';\n\n\tinterface Props {\n\t\tdeliverable: PlanningDeliverable;\n\t}\n\n\tlet { deliverable }: Props = $props();\n\n\tlet activeTab = $state<'plan' | 'prompt'>('plan');\n\n\tasync function copyToClipboard(text: string): Promise<void> {\n\t\ttry {\n\t\t\tawait navigator.clipboard.writeText(text);\n\t\t\t// TODO: Show success toast\n\t\t} catch (err) {\n\t\t\tconsole.error('Failed to copy:', err);\n\t\t}\n\t}\n\n\tfunction downloadAsFile(content: string, filename: string): void {\n\t\tconst blob = new Blob([content], { type: 'text/plain' });\n\t\tconst url = URL.createObjectURL(blob);\n\t\tconst a = document.createElement('a');\n\t\ta.href = url;\n\t\ta.download = filename;\n\t\ta.click();\n\t\tURL.revokeObjectURL(url);\n\t}\n</script>\n\n<div class=\"deliverable-viewer\">\n\t<!-- Tabs -->\n\t<div class=\"tabs\">\n\t\t<button class=\"tab\" class:active={activeTab === 'plan'} onclick={() => (activeTab = 'plan')}>\n\t\t\tImplementation Plan\n\t\t</button>\n\t\t<button class=\"tab\" class:active={activeTab === 'prompt'} onclick={() => (activeTab = 'prompt')}>\n\t\t\tExecution Prompt\n\t\t</button>\n\t</div>\n\n\t<!-- Tab Content -->\n\t<div class=\"tab-content\">\n\t\t{#if activeTab === 'plan'}\n\t\t\t<div class=\"plan-view\">\n\t\t\t\t<!-- Plan Header -->\n\t\t\t\t<div class=\"plan-header\">\n\t\t\t\t\t<h2>{deliverable.plan.title}</h2>\n\t\t\t\t\t<div class=\"plan-actions\">\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\tonclick={() => copyToClipboard(JSON.stringify(deliverable.plan, null, 2))}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tCopy\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\tonclick={() => downloadAsFile(JSON.stringify(deliverable.plan, null, 2), `${deliverable.plan.title}.json`)}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tDownload\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<!-- Overview -->\n\t\t\t\t<div class=\"plan-section\">\n\t\t\t\t\t<h3>Overview</h3>\n\t\t\t\t\t<p class=\"overview-text\">{deliverable.plan.overview}</p>\n\t\t\t\t</div>\n\n\t\t\t\t<!-- Estimated Effort -->\n\t\t\t\t<div class=\"plan-section\">\n\t\t\t\t\t<h3>Estimated Effort</h3>\n\t\t\t\t\t<Badge variant=\"info\">{deliverable.plan.estimatedEffort}</Badge>\n\t\t\t\t</div>\n\n\t\t\t\t<!-- Implementation Steps -->\n\t\t\t\t<div class=\"plan-section\">\n\t\t\t\t\t<h3>Implementation Steps</h3>\n\t\t\t\t\t<div class=\"steps-list\">\n\t\t\t\t\t\t{#each deliverable.plan.steps as step, index}\n\t\t\t\t\t\t\t<div class=\"step-card\">\n\t\t\t\t\t\t\t\t<div class=\"step-header\">\n\t\t\t\t\t\t\t\t\t<span class=\"step-number\">{index + 1}</span>\n\t\t\t\t\t\t\t\t\t<h4>{step.title}</h4>\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t<p class=\"step-description\">{step.description}</p>\n\n\t\t\t\t\t\t\t\t{#if step.acceptanceCriteria.length > 0}\n\t\t\t\t\t\t\t\t\t<div class=\"acceptance-criteria\">\n\t\t\t\t\t\t\t\t\t\t<h5>Acceptance Criteria:</h5>\n\t\t\t\t\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t\t\t\t\t{#each step.acceptanceCriteria as criterion}\n\t\t\t\t\t\t\t\t\t\t\t\t<li>{criterion}</li>\n\t\t\t\t\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t{/if}\n\n\t\t\t\t\t\t\t\t{#if step.dependencies.length > 0}\n\t\t\t\t\t\t\t\t\t<div class=\"dependencies\">\n\t\t\t\t\t\t\t\t\t\t<strong>Dependencies:</strong>\n\t\t\t\t\t\t\t\t\t\t{step.dependencies.join(', ')}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t{/if}\n\n\t\t\t\t\t\t\t\t<div class=\"step-meta\">\n\t\t\t\t\t\t\t\t\t<Badge variant=\"info\">{step.estimatedEffort}</Badge>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{/each}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<!-- Risks -->\n\t\t\t\t{#if deliverable.plan.risks.length > 0}\n\t\t\t\t\t<div class=\"plan-section\">\n\t\t\t\t\t\t<h3>Risks & Considerations</h3>\n\t\t\t\t\t\t<ul class=\"risks-list\">\n\t\t\t\t\t\t\t{#each deliverable.plan.risks as risk}\n\t\t\t\t\t\t\t\t<li>{risk}</li>\n\t\t\t\t\t\t\t{/each}\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t</div>\n\t\t\t\t{/if}\n\n\t\t\t\t<!-- Metadata -->\n\t\t\t\t<div class=\"metadata\">\n\t\t\t\t\t<div class=\"metadata-item\">\n\t\t\t\t\t\t<span class=\"label\">Tokens Used:</span>\n\t\t\t\t\t\t<span class=\"value\">{formatTokens(deliverable.metadata.totalTokens)}</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"metadata-item\">\n\t\t\t\t\t\t<span class=\"label\">Cost:</span>\n\t\t\t\t\t\t<span class=\"value\">{formatCost(deliverable.metadata.totalCost)}</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"metadata-item\">\n\t\t\t\t\t\t<span class=\"label\">Duration:</span>\n\t\t\t\t\t\t<span class=\"value\">{formatDuration(deliverable.metadata.duration)}</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t{:else}\n\t\t\t<div class=\"prompt-view\">\n\t\t\t\t<div class=\"prompt-header\">\n\t\t\t\t\t<h3>Execution Prompt</h3>\n\t\t\t\t\t<div class=\"prompt-actions\">\n\t\t\t\t\t\t<Button variant=\"secondary\" size=\"sm\" onclick={() => copyToClipboard(deliverable.prompt)}>\n\t\t\t\t\t\t\tCopy\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\tonclick={() => downloadAsFile(deliverable.prompt, `${deliverable.plan.title}-prompt.txt`)}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tDownload\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<pre class=\"prompt-text\">{deliverable.prompt}</pre>\n\t\t\t</div>\n\t\t{/if}\n\t</div>\n</div>\n\n<style>\n\t.deliverable-viewer {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 16px;\n\t}\n\n\t.tabs {\n\t\tdisplay: flex;\n\t\tgap: 8px;\n\t\tborder-bottom: 1px solid var(--color-border);\n\t}\n\n\t.tab {\n\t\tpadding: 12px 24px;\n\t\tbackground: none;\n\t\tborder: none;\n\t\tborder-bottom: 2px solid transparent;\n\t\tcolor: var(--color-text-muted);\n\t\tfont-weight: 600;\n\t\tcursor: pointer;\n\t\ttransition: all 0.2s ease;\n\t}\n\n\t.tab:hover {\n\t\tcolor: var(--color-text);\n\t\tborder-bottom-color: var(--color-border-dark);\n\t}\n\n\t.tab.active {\n\t\tcolor: var(--color-brass);\n\t\tborder-bottom-color: var(--color-brass);\n\t}\n\n\t.tab-content {\n\t\tpadding: 16px 0;\n\t}\n\n\t.plan-header {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: flex-start;\n\t\tmargin-bottom: 24px;\n\t\tpadding-bottom: 16px;\n\t\tborder-bottom: 1px solid var(--color-border);\n\t}\n\n\t.plan-header h2 {\n\t\tfont-family: 'Cinzel', serif;\n\t\tfont-weight: 300;\n\t\tfont-size: 1.5rem;\n\t\tcolor: var(--color-text);\n\t\tmargin: 0;\n\t}\n\n\t.plan-actions {\n\t\tdisplay: flex;\n\t\tgap: 8px;\n\t}\n\n\t.plan-section {\n\t\tmargin-bottom: 32px;\n\t}\n\n\t.plan-section h3 {\n\t\tfont-size: 1.125rem;\n\t\tcolor: var(--color-brass);\n\t\tmargin-bottom: 12px;\n\t}\n\n\t.overview-text {\n\t\tcolor: var(--color-text);\n\t\tline-height: 1.6;\n\t}\n\n\t.steps-list {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 16px;\n\t}\n\n\t.step-card {\n\t\tpadding: 16px;\n\t\tbackground: var(--color-surface);\n\t\tborder: 1px solid var(--color-border);\n\t\tborder-radius: 4px;\n\t}\n\n\t.step-header {\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tgap: 12px;\n\t\tmargin-bottom: 12px;\n\t}\n\n\t.step-number {\n\t\twidth: 32px;\n\t\theight: 32px;\n\t\tdisplay: flex;\n\t\talign-items: center;\n\t\tjustify-content: center;\n\t\tbackground: var(--color-brass);\n\t\tcolor: var(--color-bg);\n\t\tborder-radius: 50%;\n\t\tfont-weight: 700;\n\t\tfont-size: 0.875rem;\n\t\tflex-shrink: 0;\n\t}\n\n\t.step-header h4 {\n\t\tmargin: 0;\n\t\tcolor: var(--color-text);\n\t\tfont-size: 1rem;\n\t}\n\n\t.step-description {\n\t\tcolor: var(--color-text-muted);\n\t\tline-height: 1.6;\n\t\tmargin-bottom: 12px;\n\t}\n\n\t.acceptance-criteria {\n\t\tmargin-bottom: 12px;\n\t}\n\n\t.acceptance-criteria h5 {\n\t\tfont-size: 0.875rem;\n\t\tcolor: var(--color-text);\n\t\tmargin-bottom: 8px;\n\t}\n\n\t.acceptance-criteria ul {\n\t\tmargin: 0;\n\t\tpadding-left: 20px;\n\t}\n\n\t.acceptance-criteria li {\n\t\tcolor: var(--color-text-muted);\n\t\tmargin-bottom: 4px;\n\t}\n\n\t.dependencies {\n\t\tfont-size: 0.875rem;\n\t\tcolor: var(--color-text-muted);\n\t\tmargin-bottom: 12px;\n\t}\n\n\t.dependencies strong {\n\t\tcolor: var(--color-text);\n\t}\n\n\t.step-meta {\n\t\tdisplay: flex;\n\t\tgap: 8px;\n\t\tmargin-top: 12px;\n\t}\n\n\t.risks-list {\n\t\tlist-style: none;\n\t\tpadding: 0;\n\t\tmargin: 0;\n\t}\n\n\t.risks-list li {\n\t\tpadding: 12px;\n\t\tbackground: rgba(232, 166, 77, 0.1);\n\t\tborder-left: 3px solid #e8a64d;\n\t\tmargin-bottom: 8px;\n\t\tborder-radius: 4px;\n\t\tcolor: var(--color-text);\n\t}\n\n\t.metadata {\n\t\tdisplay: flex;\n\t\tgap: 24px;\n\t\tpadding: 16px;\n\t\tbackground: var(--color-surface);\n\t\tborder-radius: 4px;\n\t}\n\n\t.metadata-item {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 4px;\n\t}\n\n\t.metadata-item .label {\n\t\tfont-size: 0.75rem;\n\t\tcolor: var(--color-text-muted);\n\t\ttext-transform: uppercase;\n\t\tletter-spacing: 0.05em;\n\t}\n\n\t.metadata-item .value {\n\t\tfont-weight: 600;\n\t\tcolor: var(--color-text);\n\t}\n\n\t.prompt-view {\n\t\tdisplay: flex;\n\t\tflex-direction: column;\n\t\tgap: 16px;\n\t}\n\n\t.prompt-header {\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t}\n\n\t.prompt-header h3 {\n\t\tmargin: 0;\n\t\tcolor: var(--color-brass);\n\t}\n\n\t.prompt-actions {\n\t\tdisplay: flex;\n\t\tgap: 8px;\n\t}\n\n\t.prompt-text {\n\t\tbackground: var(--color-bg);\n\t\tborder: 1px solid var(--color-border);\n\t\tborder-radius: 4px;\n\t\tpadding: 16px;\n\t\tfont-family: 'JetBrains Mono', monospace;\n\t\tfont-size: 0.875rem;\n\t\tline-height: 1.6;\n\t\tcolor: var(--color-text);\n\t\twhite-space: pre-wrap;\n\t\tword-wrap: break-word;\n\t\tmax-height: 600px;\n\t\toverflow-y: auto;\n\t\tmargin: 0;\n\t}\n</style>\n"],"names":["state","sessions","currentSession","isStreaming","streamingOutput","currentStage","planningStore","activeSessions","filter","s","status","SessionStatus","RUNNING","PENDING","completedSessions","COMPLETED","failedSessions","FAILED","createSession","request","session","id","Date","now","Math","random","toString","substr","type","createdAt","stages","startSession","sessionId","find","startedAt","Stage","PLAN","updateStageOutput","stage","output","plan","ACT","act","OBSERVE","observe","REFLECT","reflect","appendStreamingOutput","content","clearStreamingOutput","advanceStage","nextStage","completeSession","deliverable","completedAt","failSession","error","cancelSession","CANCELLED","setCurrentSession","deleteSession","clearAll","API_BASE_URL","validatePlanningRequest","title","trim","length","createValidationError","description","$.state","isSubmitting","$.derived","form","root","Alert","$$anchor","$.template_effect","$.set_text","text","$.get","userMessage","$$render","consequent","$0","Input","node_1","value","$$value","Textarea","node_2","div","$.sibling","Button","node_3","node_4","$.set","$.event","async","validationError","result","success","startResponse","fetch","method","headers","body","JSON","stringify","context","ok","json","detail","streamUrl","streamingService","subscribe","onChunk","onStageStart","paortStage","onStageEnd","stageOutput","onComplete","onError","message","classifyError","startPlanningSession","err","key","PAORTStage","label","currentIndex","getStageIndex","stageKey","$$props","findIndex","div_1","$.index","stageItem","index","isActive","isCompleted","isPending","div_2","root_1","div_3","div_4","svg","root_2","div_5","root_4","nodeValue","consequent_1","alternate","alternate_1","div_6","div_7","div_8","div_9","root_6","classes_1","$.set_class","consequent_2","classes","text_1","text_2","$.each","slice","reverse","button","root_3","__click","selectSession","$.child","span","getStatusVariant","Badge","getStatusLabel","span_1","duration","getTime","span_2","root_5","round","$.reset","active","formatDate","date","Intl","DateTimeFormat","month","day","hour","minute","format","$.append","ErrorBoundary","Panel","node","RequestForm","SessionHistory","StageProgress","outputContainer","shouldAutoScroll","handleScroll","scrollTop","scrollHeight","clientHeight","$.user_effect","$.first_child","fragment","pre","streaming","StageOutput","activeTab","copyToClipboard","navigator","clipboard","writeText","downloadAsFile","filename","blob","Blob","url","URL","createObjectURL","a","document","createElement","href","download","click","revokeObjectURL","button_1","h2","onclick","p","text_5","estimatedEffort","steps","step","div_10","div_11","textContent","h4","p_1","div_12","ul","acceptanceCriteria","criterion","li","root_7","div_13","root_8","text_9","dependencies","join","div_14","node_5","node_6","text_10","text_6","text_7","div_15","root_10","ul_1","risks","risk","li_1","root_11","div_16","node_7","div_17","div_18","div_19","span_3","text_4","overview","formatTokens","tokens","metadata","totalTokens","toFixed","formatCost","cost","totalCost","formatDuration","ms","div_20","root_12","div_21","div_22","node_8","prompt","node_9","consequent_3","DeliverableViewer","root_13","root_15","consequent_4","alternate_2"],"mappings":"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"}