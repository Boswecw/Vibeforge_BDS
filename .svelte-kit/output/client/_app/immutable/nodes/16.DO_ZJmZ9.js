var e=Object.defineProperty,t=(t,s,a)=>((t,s,a)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a)(t,"symbol"!=typeof s?s+"":s,a);import{T as s,p as a,e as n,q as i,i as r,g as l,s as c,j as o,a as d,x as v,I as u,y as p,z as g,A as m,k as h,r as w,R as f,a3 as S,l as b,G as y,N as k,a4 as E,m as N,h as $,H as A,d as C,v as L,S as O}from"../chunks/D_pGZFR_.js";import{E as D}from"../chunks/NGB4GAV7.js";import{P}from"../chunks/CXKGBbKr.js";import{B as T}from"../chunks/BwdTzT4T.js";import{I}from"../chunks/BEa9JwFg.js";import{T as x}from"../chunks/BSl3yoIf.js";import{A as R}from"../chunks/Dhcz_u6i.js";import{c as q,a as F,b as j}from"../chunks/6vB2_8ig.js";import{B as M}from"../chunks/6OU7_OpZ.js";var G=(e=>(e.PLAN="PLAN",e.ACT="ACT",e.OBSERVE="OBSERVE",e.REFLECT="REFLECT",e.TRANSITION="TRANSITION",e))(G||{}),U=(e=>(e.PENDING="PENDING",e.RUNNING="RUNNING",e.COMPLETED="COMPLETED",e.FAILED="FAILED",e.CANCELLED="CANCELLED",e))(U||{});const _=s({sessions:[],currentSession:null,isStreaming:!1,streamingOutput:"",currentStage:null}),B={get sessions(){return _.sessions},get currentSession(){return _.currentSession},get isStreaming(){return _.isStreaming},get streamingOutput(){return _.streamingOutput},get currentStage(){return _.currentStage},get activeSessions(){return _.sessions.filter(e=>e.status===U.RUNNING||e.status===U.PENDING)},get completedSessions(){return _.sessions.filter(e=>e.status===U.COMPLETED)},get failedSessions(){return _.sessions.filter(e=>e.status===U.FAILED)},createSession(e){const t={id:`planning_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,type:"planning",status:U.PENDING,createdAt:new Date,request:e,stages:{}};return _.sessions=[..._.sessions,t],_.currentSession=t,t},startSession(e){const t=_.sessions.find(t=>t.id===e);t&&(t.status=U.RUNNING,t.startedAt=new Date,t.currentStage=G.PLAN,_.currentStage=G.PLAN,_.isStreaming=!0,_.streamingOutput="",_.sessions=[..._.sessions])},updateStageOutput(e,t,s){const a=_.sessions.find(t=>t.id===e);if(a){switch(t){case G.PLAN:a.stages.plan=s;break;case G.ACT:a.stages.act=s;break;case G.OBSERVE:a.stages.observe=s;break;case G.REFLECT:a.stages.reflect=s}_.sessions=[..._.sessions]}},appendStreamingOutput(e){_.streamingOutput+=e},clearStreamingOutput(){_.streamingOutput=""},advanceStage(e,t){const s=_.sessions.find(t=>t.id===e);s&&(t?(s.currentStage=t,_.currentStage=t,_.streamingOutput=""):(s.currentStage=void 0,_.currentStage=null,_.isStreaming=!1),_.sessions=[..._.sessions])},completeSession(e,t){const s=_.sessions.find(t=>t.id===e);s&&(s.status=U.COMPLETED,s.completedAt=new Date,s.deliverable=t,s.currentStage=void 0,_.currentStage=null,_.isStreaming=!1,_.streamingOutput="",_.sessions=[..._.sessions])},failSession(e,t){const s=_.sessions.find(t=>t.id===e);s&&(s.status=U.FAILED,s.completedAt=new Date,s.error=t,s.currentStage=void 0,_.currentStage=null,_.isStreaming=!1,_.streamingOutput="",_.sessions=[..._.sessions])},cancelSession(e){const t=_.sessions.find(t=>t.id===e);t&&(t.status=U.CANCELLED,t.completedAt=new Date,t.currentStage=void 0,_.currentSession?.id===e&&(_.currentStage=null,_.isStreaming=!1,_.streamingOutput=""),_.sessions=[..._.sessions])},setCurrentSession(e){if(null===e)return void(_.currentSession=null);const t=_.sessions.find(t=>t.id===e);t&&(_.currentSession=t)},deleteSession(e){_.sessions=_.sessions.filter(t=>t.id!==e),_.currentSession?.id===e&&(_.currentSession=null,_.currentStage=null,_.isStreaming=!1,_.streamingOutput="")},clearAll(){_.sessions=[],_.currentSession=null,_.isStreaming=!1,_.streamingOutput="",_.currentStage=null}};const z=new class{constructor(){t(this,"activeStreams",new Map)}subscribe(e,t={}){const{onChunk:s,onStageStart:a,onStageEnd:n,onComplete:i,onError:r,reconnect:l=!0,reconnectDelay:c=3e3,maxReconnectAttempts:o=5}=t;let d=null,v=0,u=!1,p=!1,g=null;const m=()=>{if(!p)try{d=new EventSource(e),this.activeStreams.set(e,d),d.addEventListener("chunk",e=>{if(!u&&!p)try{const t=JSON.parse(e.data);if("chunk"===t.type&&"object"==typeof t.data&&null!==t.data){const e=t.data;e.content&&s&&s(e.content)}}catch(t){}}),d.addEventListener("stage_start",e=>{if(!u&&!p)try{const t=JSON.parse(e.data);if("stage_start"===t.type&&"object"==typeof t.data&&null!==t.data){const e=t.data;e.stage&&a&&a(e.stage)}}catch(t){}}),d.addEventListener("stage_end",e=>{if(!u&&!p)try{const t=JSON.parse(e.data);if("stage_end"===t.type&&"object"==typeof t.data&&null!==t.data){const e=t.data;e.stage&&n&&n(e.stage,e.output)}}catch(t){}}),d.addEventListener("complete",e=>{if(!u&&!p)try{const t=JSON.parse(e.data);if("complete"===t.type&&"object"==typeof t.data&&null!==t.data){const e=t.data;i&&i(e.result)}}catch(t){}finally{h()}}),d.addEventListener("error",()=>{if(p)return;const t=q("Stream connection error");l&&v<o?(v++,d?.close(),this.activeStreams.delete(e),g=setTimeout(()=>{m()},c)):(r&&r(t),h())}),d.addEventListener("open",()=>{v=0})}catch(t){const e=F(t);r&&r(e),h()}},h=()=>{p=!0,u=!1,g&&(clearTimeout(g),g=null),d&&(d.close(),this.activeStreams.delete(e),d=null)};return m(),{close:h,pause:()=>{u=!0},resume:()=>{u=!1},get isActive(){return!p&&null!==d},get isPaused(){return u}}}closeAll(){this.activeStreams.forEach(e=>{e.close()}),this.activeStreams.clear()}get activeStreamCount(){return this.activeStreams.size}};function H(e){return e.title&&0!==e.title.trim().length?e.title.length>200?j("Title must be 200 characters or less"):e.description&&0!==e.description.trim().length?e.description.length>5e3?j("Description must be 5000 characters or less"):null:j("Description is required"):j("Title is required")}var J=n('<form class="request-form svelte-19tf9np"><!> <!> <!> <div class="form-actions svelte-19tf9np"><!> <!></div> <div class="form-hint svelte-19tf9np"><p class="svelte-19tf9np">The Planning Agent will analyze your request and generate a detailed implementation plan with\n\t\t\tspecific steps, acceptance criteria, and risk assessment.</p></div></form>');function V(e,t){a(t,!0);let s=c(""),n=c(""),y=c(null),k=c(!1);const E=v(()=>B.isStreaming);var N=J(),$=i(N),A=e=>{R(e,{variant:"error",children:(e,t)=>{u();var s=p();g(()=>m(s,l(y).userMessage)),h(e,s)},$$slots:{default:!0}})};r($,e=>{l(y)&&e(A)});var C=o($,2);{let e=v(()=>l(E)||l(k));I(C,{label:"Task Title",placeholder:"e.g., Add user authentication system",maxlength:200,required:!0,get disabled(){return l(e)},get value(){return l(s)},set value(e){d(s,e,!0)}})}var L=o(C,2);{let e=v(()=>l(E)||l(k));x(L,{label:"Description",placeholder:"Provide detailed requirements, constraints, and context for this task...",rows:8,maxlength:5e3,required:!0,get disabled(){return l(e)},get value(){return l(n)},set value(e){d(n,e,!0)}})}var O=o(L,2),D=i(O);{let e=v(()=>l(E)||l(k)||!l(s).trim()||!l(n).trim());T(D,{type:"submit",variant:"primary",get disabled(){return l(e)},get loading(){return l(k)},children:(e,t)=>{u();var s=p();g(()=>m(s,l(k)?"Starting...":"Start Planning")),h(e,s)},$$slots:{default:!0}})}var P=o(D,2);{let e=v(()=>l(E)||l(k));T(P,{type:"button",variant:"secondary",onclick:function(){d(s,""),d(n,""),d(y,null)},get disabled(){return l(e)},children:(e,t)=>{u();var s=p("Clear");h(e,s)},$$slots:{default:!0}})}w(O),u(2),w(N),f("submit",N,S(async function(){d(y,null);const e={title:l(s).trim(),description:l(n).trim()},t=H(e);if(t)d(y,t,!0);else{d(k,!0);try{const t=await async function(e){const t=H(e);if(t)return{success:!1,error:t};try{const t=B.createSession(e);B.startSession(t.id);const s=`http://localhost:8787/api/v1/bds/planning/${t.id}/stream`;return z.subscribe(s,{onChunk:e=>{B.appendStreamingOutput(e)},onStageStart:e=>{const s=e;B.advanceStage(t.id,s)},onStageEnd:(e,s)=>{const a=e,n=s;B.updateStageOutput(t.id,a,n),B.clearStreamingOutput()},onComplete:e=>{const s=e;B.completeSession(t.id,s)},onError:e=>{B.failSession(t.id,e.message)}}),{success:!0,sessionId:t.id}}catch(y){return{success:!1,error:F(y)}}}(e);if(!t.success&&t.error)return d(y,t.error,!0),void d(k,!1);d(s,""),d(n,""),d(k,!1)}catch(a){d(k,!1)}}})),h(e,N),b()}var W=E('<svg width="16" height="16" viewBox="0 0 16 16" fill="none" class="svelte-e0qkuv"><path d="M13.5 4.5L6 12L2.5 8.5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="svelte-e0qkuv"></path></svg>'),K=n('<div class="pulse svelte-e0qkuv"></div>'),Z=n("<div></div>"),Q=n('<div><div class="stage-indicator svelte-e0qkuv"><div class="stage-number svelte-e0qkuv"><!></div></div> <div class="stage-content svelte-e0qkuv"><div class="stage-label svelte-e0qkuv"> </div> <div class="stage-description svelte-e0qkuv"> </div></div> <!></div>'),X=n('<div class="stage-progress svelte-e0qkuv"><div class="stages svelte-e0qkuv"></div></div>');function Y(e,t){a(t,!0);const s=[{key:G.PLAN,label:"Plan",description:"Define strategy"},{key:G.ACT,label:"Act",description:"Execute steps"},{key:G.OBSERVE,label:"Observe",description:"Analyze results"},{key:G.REFLECT,label:"Reflect",description:"Evaluate success"}];const n=v(()=>{return(e=t.stage)?s.findIndex(t=>t.key===e):-1;var e});var c=X(),d=i(c);y(d,21,()=>s,A,(e,t,a)=>{const c=v(()=>a===l(n)),d=v(()=>l(n)>a),u=v(()=>l(n)<a);var f=Q();let S;var b=i(f),y=i(b),E=i(y),A=e=>{var t=W();h(e,t)},C=e=>{var t=N(),s=$(t),n=e=>{var t=K();h(e,t)},i=e=>{var t=p();t.nodeValue=a+1,h(e,t)};r(s,e=>{l(c)?e(n):e(i,!1)},!0),h(e,t)};r(E,e=>{l(d)?e(A):e(C,!1)}),w(y),w(b);var L=o(b,2),O=i(L),D=i(O,!0);w(O);var P=o(O,2),T=i(P,!0);w(P),w(L);var I=o(L,2),x=e=>{var t=Z();let s;g(()=>s=k(t,1,"stage-connector svelte-e0qkuv",null,s,{completed:l(d)})),h(e,t)};r(I,e=>{a<s.length-1&&e(x)}),w(f),g(()=>{S=k(f,1,"stage svelte-e0qkuv",null,S,{active:l(c),completed:l(d),pending:l(u)}),m(D,l(t).label),m(T,l(t).description)}),h(e,f)}),w(d),w(c),h(e,c),b()}var ee=n('<pre class="output-text svelte-8glc1h"> </pre>'),te=n('<div class="loading-indicator svelte-8glc1h"><div class="spinner svelte-8glc1h"></div> <p class="svelte-8glc1h">Waiting for output...</p></div>'),se=n('<div class="streaming-indicator svelte-8glc1h"><div class="dot svelte-8glc1h"></div> <div class="dot svelte-8glc1h"></div> <div class="dot svelte-8glc1h"></div></div>'),ae=n('<button class="scroll-to-bottom svelte-8glc1h"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" class="svelte-8glc1h"><path d="M8 12L4 8H12L8 12Z" fill="currentColor" class="svelte-8glc1h"></path></svg> Scroll to bottom</button>'),ne=n("<div><!> <!></div> <!>",1),ie=n('<div class="empty-state svelte-8glc1h"><p class="svelte-8glc1h">Output will appear here when the planning session starts.</p></div>'),re=n('<div class="stage-output svelte-8glc1h"><!></div>');O(["click"]);var le=n('<div class="empty-state svelte-1dk4y4m"><p>No planning sessions yet</p></div>'),ce=n('<span class="session-duration svelte-1dk4y4m"> </span>'),oe=n('<button><div class="session-header svelte-1dk4y4m"><span class="session-title svelte-1dk4y4m"> </span> <!></div> <div class="session-meta svelte-1dk4y4m"><span class="session-date svelte-1dk4y4m"> </span> <!></div></button>'),de=n('<div class="session-list svelte-1dk4y4m"></div>'),ve=n('<div class="session-history svelte-1dk4y4m"><!></div>');function ue(e,t){a(t,!0);const s=v(()=>B.sessions),n=v(()=>B.currentSession);var c=ve(),d=i(c),f=e=>{var t=le();h(e,t)},S=e=>{var t=de();y(t,21,()=>l(s).slice().reverse(),A,(e,t)=>{var s=oe();let a;s.__click=()=>function(e){B.setCurrentSession(e.id)}(l(t));var c=i(s),d=i(c),f=i(d,!0);w(d);var S=o(d,2);{let e=v(()=>function(e){switch(e){case U.COMPLETED:return"success";case U.FAILED:case U.CANCELLED:return"error";case U.RUNNING:return"warning";default:return"info"}}(l(t).status));M(S,{get variant(){return l(e)},children:(e,s)=>{u();var a=p();g(e=>m(a,e),[()=>function(e){switch(e){case U.COMPLETED:return"Completed";case U.FAILED:return"Failed";case U.CANCELLED:return"Cancelled";case U.RUNNING:return"Running";case U.PENDING:return"Pending";default:return"Unknown"}}(l(t).status)]),h(e,a)},$$slots:{default:!0}})}w(c);var b=o(c,2),y=i(b),E=i(y,!0);w(y);var N=o(y,2),$=e=>{const s=v(()=>l(t).completedAt.getTime()-l(t).startedAt.getTime());var a=ce(),n=i(a,!0);w(a),g(e=>m(n,e),[()=>l(s)<6e4?`${Math.round(l(s)/1e3)}s`:`${Math.round(l(s)/6e4)}m`]),h(e,a)};r(N,e=>{l(t).completedAt&&l(t).startedAt&&e($)}),w(b),w(s),g(e=>{a=k(s,1,"session-item svelte-1dk4y4m",null,a,{active:l(n)?.id===l(t).id}),m(f,l(t).request.title),m(E,e)},[()=>{return e=l(t).createdAt,new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}).format(e);var e}]),h(e,s)}),w(t),h(e,t)};r(d,e=>{0===l(s).length?e(f):e(S,!1)}),w(c),h(e,c),b()}O(["click"]);var pe=n('<li class="svelte-2cw5wd"> </li>'),ge=n('<div class="acceptance-criteria svelte-2cw5wd"><h5 class="svelte-2cw5wd">Acceptance Criteria:</h5> <ul class="svelte-2cw5wd"></ul></div>'),me=n('<div class="dependencies svelte-2cw5wd"><strong class="svelte-2cw5wd">Dependencies:</strong> </div>'),he=n('<div class="step-card svelte-2cw5wd"><div class="step-header svelte-2cw5wd"><span class="step-number svelte-2cw5wd"></span> <h4 class="svelte-2cw5wd"> </h4></div> <p class="step-description svelte-2cw5wd"> </p> <!> <!> <div class="step-meta svelte-2cw5wd"><!></div></div>'),we=n('<li class="svelte-2cw5wd"> </li>'),fe=n('<div class="plan-section svelte-2cw5wd"><h3 class="svelte-2cw5wd">Risks & Considerations</h3> <ul class="risks-list svelte-2cw5wd"></ul></div>'),Se=n('<div class="plan-view"><div class="plan-header svelte-2cw5wd"><h2 class="svelte-2cw5wd"> </h2> <div class="plan-actions svelte-2cw5wd"><!> <!></div></div> <div class="plan-section svelte-2cw5wd"><h3 class="svelte-2cw5wd">Overview</h3> <p class="overview-text svelte-2cw5wd"> </p></div> <div class="plan-section svelte-2cw5wd"><h3 class="svelte-2cw5wd">Estimated Effort</h3> <!></div> <div class="plan-section svelte-2cw5wd"><h3 class="svelte-2cw5wd">Implementation Steps</h3> <div class="steps-list svelte-2cw5wd"></div></div> <!> <div class="metadata svelte-2cw5wd"><div class="metadata-item svelte-2cw5wd"><span class="label svelte-2cw5wd">Tokens Used:</span> <span class="value svelte-2cw5wd"> </span></div> <div class="metadata-item svelte-2cw5wd"><span class="label svelte-2cw5wd">Cost:</span> <span class="value svelte-2cw5wd"> </span></div> <div class="metadata-item svelte-2cw5wd"><span class="label svelte-2cw5wd">Duration:</span> <span class="value svelte-2cw5wd"> </span></div></div></div>'),be=n('<div class="prompt-view svelte-2cw5wd"><div class="prompt-header svelte-2cw5wd"><h3 class="svelte-2cw5wd">Execution Prompt</h3> <div class="prompt-actions svelte-2cw5wd"><!> <!></div></div> <pre class="prompt-text svelte-2cw5wd"> </pre></div>'),ye=n('<div class="deliverable-viewer svelte-2cw5wd"><div class="tabs svelte-2cw5wd"><button>Implementation Plan</button> <button>Execution Prompt</button></div> <div class="tab-content svelte-2cw5wd"><!></div></div>');O(["click"]);var ke=n("<!> <!>",1),Ee=n('<div class="error-message svelte-dy79yi"><h3 class="svelte-dy79yi">Error</h3> <p> </p></div>'),Ne=n('<div class="empty-state svelte-dy79yi"><h2 class="svelte-dy79yi">Start a Planning Session</h2> <p>Fill out the form on the left to begin planning a new task.</p></div>'),$e=n('<div class="planning-page svelte-dy79yi"><header class="page-header svelte-dy79yi"><h1 class="svelte-dy79yi">Planning Agent</h1> <p class="text-muted svelte-dy79yi">Define and plan complex implementation tasks</p></header> <div class="content-grid svelte-dy79yi"><div class="left-column"><!> <!></div> <div class="right-column"><!></div></div></div>');function Ae(e,t){a(t,!0);const s=v(()=>B.currentSession),n=v(()=>B.isStreaming),S=v(()=>B.currentStage),E=v(()=>B.streamingOutput);D(e,{children:(e,t)=>{var v=$e(),O=o(i(v),2),D=i(O),I=i(D);P(I,{title:"New Planning Request",children:(e,t)=>{V(e,{})},$$slots:{default:!0}});var x=o(I,2),R=e=>{P(e,{title:"Session History",class:"mt-6",children:(e,t)=>{ue(e,{})},$$slots:{default:!0}})};r(x,e=>{l(s)&&e(R)}),w(D);var q=o(D,2),F=i(q),j=e=>{var t=N(),v=$(t),O=e=>{P(e,{title:"Planning in Progress",children:(e,t)=>{var s=ke(),v=$(s);Y(v,{get stage(){return l(S)}}),function(e,t){let s;a(t,!0);let n=c(!0);function v(){if(!s)return;const{scrollTop:e,scrollHeight:t,clientHeight:a}=s;d(n,t-(e+a)<100)}C(()=>{s&&l(n)&&t.output&&(s.scrollTop=s.scrollHeight)});var u=re(),p=i(u),S=e=>{var a=ne(),c=$(a);let u;var p=i(c),S=e=>{var s=ee(),a=i(s,!0);w(s),g(()=>m(a,t.output)),h(e,s)},b=e=>{var t=te();h(e,t)};r(p,e=>{t.output?e(S):e(b,!1)});var y=o(p,2),E=e=>{var t=se();h(e,t)};r(y,e=>{t.isStreaming&&e(E)}),w(c),L(c,e=>s=e,()=>s);var N=o(c,2),A=e=>{var t=ae();t.__click=()=>{d(n,!0),s&&(s.scrollTop=s.scrollHeight)},h(e,t)};r(N,e=>{!l(n)&&t.isStreaming&&e(A)}),g(()=>u=k(c,1,"output-container svelte-8glc1h",null,u,{streaming:t.isStreaming})),f("scroll",c,v),h(e,a)},y=e=>{var t=ie();h(e,t)};r(p,e=>{t.isStreaming||t.output?e(S):e(y,!1)}),w(u),h(e,u),b()}(o(v,2),{get output(){return l(E)},get isStreaming(){return l(n)}}),h(e,s)},$$slots:{default:!0}})},D=e=>{var t=N(),n=$(t),v=e=>{P(e,{title:"Planning Complete",children:(e,t)=>{!function(e,t){a(t,!0);let s=c("plan");async function n(e){try{await navigator.clipboard.writeText(e)}catch(t){}}function v(e,t){const s=new Blob([e],{type:"text/plain"}),a=URL.createObjectURL(s),n=document.createElement("a");n.href=a,n.download=t,n.click(),URL.revokeObjectURL(a)}var f=ye(),S=i(f),E=i(S);let N;E.__click=()=>d(s,"plan");var $=o(E,2);let C;$.__click=()=>d(s,"prompt"),w(S);var L=o(S,2),O=i(L),D=e=>{var s=Se(),a=i(s),c=i(a),d=i(c,!0);w(c);var f=o(c,2),S=i(f);T(S,{variant:"secondary",size:"sm",onclick:()=>n(JSON.stringify(t.deliverable.plan,null,2)),children:(e,t)=>{u();var s=p("Copy");h(e,s)},$$slots:{default:!0}});var b=o(S,2);T(b,{variant:"secondary",size:"sm",onclick:()=>v(JSON.stringify(t.deliverable.plan,null,2),`${t.deliverable.plan.title}.json`),children:(e,t)=>{u();var s=p("Download");h(e,s)},$$slots:{default:!0}}),w(f),w(a);var k=o(a,2),E=o(i(k),2),N=i(E,!0);w(E),w(k);var $=o(k,2),C=o(i($),2);M(C,{variant:"info",children:(e,s)=>{u();var a=p();g(()=>m(a,t.deliverable.plan.estimatedEffort)),h(e,a)},$$slots:{default:!0}}),w($);var L=o($,2),O=o(i(L),2);y(O,21,()=>t.deliverable.plan.steps,A,(e,t,s)=>{var a=he(),n=i(a),c=i(n);c.textContent=s+1;var d=o(c,2),v=i(d,!0);w(d),w(n);var f=o(n,2),S=i(f,!0);w(f);var b=o(f,2),k=e=>{var s=ge(),a=o(i(s),2);y(a,21,()=>l(t).acceptanceCriteria,A,(e,t)=>{var s=pe(),a=i(s,!0);w(s),g(()=>m(a,l(t))),h(e,s)}),w(a),w(s),h(e,s)};r(b,e=>{l(t).acceptanceCriteria.length>0&&e(k)});var E=o(b,2),N=e=>{var s=me(),a=o(i(s));w(s),g(e=>m(a,` ${e??""}`),[()=>l(t).dependencies.join(", ")]),h(e,s)};r(E,e=>{l(t).dependencies.length>0&&e(N)});var $=o(E,2),C=i($);M(C,{variant:"info",children:(e,s)=>{u();var a=p();g(()=>m(a,l(t).estimatedEffort)),h(e,a)},$$slots:{default:!0}}),w($),w(a),g(()=>{m(v,l(t).title),m(S,l(t).description)}),h(e,a)}),w(O),w(L);var D=o(L,2),P=e=>{var s=fe(),a=o(i(s),2);y(a,21,()=>t.deliverable.plan.risks,A,(e,t)=>{var s=we(),a=i(s,!0);w(s),g(()=>m(a,l(t))),h(e,s)}),w(a),w(s),h(e,s)};r(D,e=>{t.deliverable.plan.risks.length>0&&e(P)});var I=o(D,2),x=i(I),R=o(i(x),2),q=i(R,!0);w(R),w(x);var F=o(x,2),j=o(i(F),2),G=i(j,!0);w(j),w(F);var U=o(F,2),_=o(i(U),2),B=i(_,!0);w(_),w(U),w(I),w(s),g((e,s,a)=>{m(d,t.deliverable.plan.title),m(N,t.deliverable.plan.overview),m(q,e),m(G,s),m(B,a)},[()=>{return(e=t.deliverable.metadata.totalTokens)<1e3?`${e} tokens`:e<1e6?`${(e/1e3).toFixed(1)}K tokens`:`${(e/1e6).toFixed(1)}M tokens`;var e},()=>{return(e=t.deliverable.metadata.totalCost)<.01?`$${e.toFixed(4)}`:`$${e.toFixed(2)}`;var e},()=>{return(e=t.deliverable.metadata.duration)<1e3?`${e}ms`:e<6e4?`${(e/1e3).toFixed(1)}s`:e<36e5?`${(e/6e4).toFixed(1)}m`:`${(e/36e5).toFixed(1)}h`;var e}]),h(e,s)},P=e=>{var s=be(),a=i(s),r=o(i(a),2),l=i(r);T(l,{variant:"secondary",size:"sm",onclick:()=>n(t.deliverable.prompt),children:(e,t)=>{u();var s=p("Copy");h(e,s)},$$slots:{default:!0}});var c=o(l,2);T(c,{variant:"secondary",size:"sm",onclick:()=>v(t.deliverable.prompt,`${t.deliverable.plan.title}-prompt.txt`),children:(e,t)=>{u();var s=p("Download");h(e,s)},$$slots:{default:!0}}),w(r),w(a);var d=o(a,2),f=i(d,!0);w(d),w(s),g(()=>m(f,t.deliverable.prompt)),h(e,s)};r(O,e=>{"plan"===l(s)?e(D):e(P,!1)}),w(L),w(f),g(()=>{N=k(E,1,"tab svelte-2cw5wd",null,N,{active:"plan"===l(s)}),C=k($,1,"tab svelte-2cw5wd",null,C,{active:"prompt"===l(s)})}),h(e,f),b()}(e,{get deliverable(){return l(s).deliverable}})},$$slots:{default:!0}})},f=e=>{var t=N(),a=$(t),n=e=>{P(e,{title:"Planning Failed",variant:"error",children:(e,t)=>{var a=Ee(),n=o(i(a),2),r=i(n,!0);w(n),w(a),g(()=>m(r,l(s).error||"An unknown error occurred")),h(e,a)},$$slots:{default:!0}})};r(a,e=>{l(s).status===U.FAILED&&e(n)},!0),h(e,t)};r(n,e=>{l(s).status===U.COMPLETED&&l(s).deliverable?e(v):e(f,!1)},!0),h(e,t)};r(v,e=>{l(s).status===U.RUNNING||l(s).status===U.PENDING?e(O):e(D,!1)}),h(e,t)},G=e=>{P(e,{title:"Welcome",children:(e,t)=>{var s=Ne();h(e,s)},$$slots:{default:!0}})};r(F,e=>{l(s)?e(j):e(G,!1)}),w(q),w(O),w(v),h(e,v)},$$slots:{default:!0}}),b()}export{Ae as component};
